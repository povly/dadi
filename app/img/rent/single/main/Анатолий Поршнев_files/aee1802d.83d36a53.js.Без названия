"use strict";(self.webpackChunkvkweb=self.webpackChunkvkweb||[]).push([[38234],{946742:(e,t,r)=>{r.d(t,{apiAudioToAudioTuple:()=>n});var i=r(664988),a=r(659397),s=r(312523),o=r(552248);const n=e=>{var t,r,n,c,d,l,u,p,_,f,v,S;return e?[e.id,e.owner_id,e.url||"",(0,i.clean)(e.title),(0,i.clean)(e.artist||e.performer||""),e.duration,e.album_id||0,0,"",e.lyrics_id||0,0,"","[]",(0,s.getAudioHashesString)({addHash:e.access_key,editHash:e.access_key,actionHash:e.access_key,deleteHash:e.access_key,replaceHash:e.access_key,urlHash:e.access_key,restoreHash:e.access_key}),(null==(r=e.album)||null==(t=r.thumb)?void 0:t.sizes)?(null==(n=(0,a.getPhotoSize)((null==(d=e.album)||null==(c=d.thumb)?void 0:c.sizes)||[],(0,o.getImageMinWidth)(200)))?void 0:n.url)||"":`${null==(u=e.album)||null==(l=u.thumb)?void 0:l.photo_300},${null==(_=e.album)||null==(p=_.thumb)?void 0:p.photo_135}`||"",e.ads||{},(0,i.clean)(e.subtitle||""),e.main_artists||"",e.featured_artists||"",!!e.album&&[null==(f=e.album)?void 0:f.owner_id,null==(v=e.album)?void 0:v.id,null==(S=e.album)?void 0:S.access_key],e.track_code||"",e.content_restricted||0,e.album_part_number||0,!0,e.access_key||"",e.audio_chart_info||!1,""]:null}},129834:(e,t,r)=>{r.d(t,{AUDIO_PLAYER_ADAPTER_HASHES_SEPARATOR:()=>i});const i="/"},312523:(e,t,r)=>{r.d(t,{getAudioHashesString:()=>a});var i=r(129834);const a=({addHash:e,editHash:t,actionHash:r,deleteHash:a,replaceHash:s,urlHash:o,restoreHash:n})=>[e||"",t||"",r||"",a||"",s||"",o||"",n||""].join(i.AUDIO_PLAYER_ADAPTER_HASHES_SEPARATOR)},22892:(e,t,r)=>{r.d(t,{createCacheService:()=>a});var i=r(778748);const a=e=>{const t=(0,i.getEffectorServiceDomain)(e),r=Object.create(null),a=t.createStore(Object.create(null)),s=t.createEvent("add"),o=t.createEvent("delete");return a.on(s,((e,{key:t,data:r})=>(e[t]=r,e))).on(o,((e,t)=>(delete e[t],e))),{$cache:a,add:s,delete:o,get:e=>a.getState()[e]||null,isWaited:e=>void 0!==r[e],getWaited:e=>r[e],setWaited:(e,t)=>{r[e]=t},deleteWaited:e=>{delete r[e]}}}},634167:(e,t,r)=>{r.d(t,{createOwnerService:()=>a.createOwnerService,createUserService:()=>i.createUserService});var i=r(300917),a=r(171158)},171158:(e,t,r)=>{r.d(t,{createOwnerService:()=>u});var i=r(434788),a=r(798116),s=r(599809),o=r(931917),n=r(22892),c=r(778748),d=r(654198);const l=(0,n.createCacheService)(),u=e=>{const t=e.fields||[],r=(0,c.getEffectorServiceDomain)(e),n=r.createStore({id:0}),u=r.createEvent("initialize"),p=r.createEvent("reload"),_=r.createEffect({name:"initializeFx"}),f=_.pending,v=_.doneData;return _.use((({ownerId:e,useCache:r})=>{if(r){const r=l.get(e);if(r){if(t.every((e=>r.hasOwnProperty(e))))return Promise.resolve(r)}}if(l.isWaited(e)){const r=l.getWaited(e).find((e=>t.every((t=>Boolean(e.fields[t])))));if(r)return r.promise.finally((()=>{l.deleteWaited(e)})),r.promise}let i=o.Ranges.isGroupId(e)?(0,s.apiWithPrefetch)("groups.getById",{group_ids:String(e),fields:t.join(",")}).then((t=>{var r;return(null==(r=t.groups)?void 0:r[0])||{id:e}})):(0,s.apiWithPrefetch)("users.get",{user_ids:String(e),fields:t.join(",")}).then((e=>e[0]));const a={fields:t.reduce(((e,t)=>(e[t]=!0,e)),{}),promise:i},n=l.isWaited(e)?[...l.getWaited(e),a]:[a];return l.setWaited(e,n),i})),(0,a.sample)({clock:u,source:n,filter:(e,t)=>e.id!==t,fn:(t,r)=>{var i;return{ownerId:r,useCache:Boolean(null==(i=e)?void 0:i.useCache)}},target:_}),(0,a.sample)({clock:p,source:n,fn:e=>({ownerId:e.id}),target:_}),(0,a.sample)({clock:_.doneData,target:n}),(0,a.sample)({clock:_.doneData,filter:()=>{var t;return Boolean(null==(t=e)?void 0:t.useCache)},fn:e=>{const t=l.get(e.id);if(t){if((0,d.isOwnerUser)(t)&&(0,d.isOwnerUser)(e))return{key:e.id,data:(0,i._)({},t,e)};if((0,d.isOwnerGroup)(t)&&(0,d.isOwnerGroup)(e))return{key:e.id,data:(0,i._)({},t,e)}}return{key:e.id,data:e}},target:l.add}),{$isInitializing:f,$owner:n,initialize:u,onInitialized:v,reload:p}}},300917:(e,t,r)=>{r.d(t,{createUserService:()=>n});var i=r(11010),a=r(434788),s=r(798116),o=r(599809);const n=({domain:e})=>{const t=(e,t)=>!(!e||e.id!==t.userId),r=e.createStore(null),n=e.createEffect((({params:e})=>(0,o.apiWithPrefetch)("users.get",e))),c=e.createEffect((0,i._)((function*(e){return{userId:e.params.owner_id,response:yield(0,o.api)("wall.subscribe",e.params)}}))),d=e.createEffect((0,i._)((function*(e){return{userId:e.params.owner_id,response:yield(0,o.api)("wall.unsubscribe",e.params)}}))),l=e.createEffect((0,i._)((function*(e){return{userId:e.params.owner_id,response:yield(0,o.api)("video.liveSubscribe",e.params)}}))),u=e.createEffect((0,i._)((function*(e){return{userId:e.params.owner_id,response:yield(0,o.api)("video.liveUnsubscribe",e.params)}}))),p=e.createEffect((0,i._)((function*(e){return{userId:e.params.user_id,response:yield(0,o.api)("fave.addUser",e.params)}}))),_=e.createEffect((0,i._)((function*(e){return{userId:e.params.user_id,response:yield(0,o.api)("fave.removeUser",e.params)}}))),f=e.createEffect((0,i._)((function*(e){return{userId:e.params.owner_id,response:yield(0,o.api)("account.ban",e.params)}}))),v=e.createEffect((0,i._)((function*(e){return{userId:e.params.owner_id,response:yield(0,o.api)("account.unban",e.params)}}))),S=e.createEffect((0,i._)((function*(e){return{userId:e.params.user_id,response:yield(0,o.api)("bestFriends.add",e.params)}}))),m=e.createEffect((0,i._)((function*(e){return{userId:e.params.user_id,response:yield(0,o.api)("bestFriends.delete",e.params)}})));return(0,s.sample)({clock:n.doneData,fn:e=>e[0]||null,target:r}),(0,s.sample)({clock:c.doneData,source:r,filter:t,fn:e=>(0,a._)({},e,{is_subscribed:1}),target:r}),(0,s.sample)({clock:d.doneData,source:r,filter:t,fn:e=>(0,a._)({},e,{is_subscribed:0}),target:r}),(0,s.sample)({clock:l.doneData,source:r,filter:t,fn:e=>(0,a._)({},e,{video_live:e.video_live?(0,a._)({},e.video_live,{is_notifications_blocked:0}):void 0}),target:r}),(0,s.sample)({clock:u.doneData,source:r,filter:t,fn:e=>(0,a._)({},e,{video_live:e.video_live?(0,a._)({},e.video_live,{is_notifications_blocked:1}):void 0}),target:r}),(0,s.sample)({clock:p.doneData,source:r,filter:t,fn:e=>(0,a._)({},e,{is_favorite:1}),target:r}),(0,s.sample)({clock:_.doneData,source:r,filter:t,fn:e=>(0,a._)({},e,{is_favorite:0}),target:r}),(0,s.sample)({clock:f.doneData,source:r,filter:t,fn:e=>(0,a._)({},e,{blacklisted_by_me:1}),target:r}),(0,s.sample)({clock:v.doneData,source:r,filter:t,fn:e=>(0,a._)({},e,{blacklisted_by_me:0}),target:r}),(0,s.sample)({clock:S.doneData,source:r,filter:t,fn:e=>(0,a._)({},e,{is_best_friend:!0}),target:r}),(0,s.sample)({clock:m.doneData,source:r,filter:t,fn:e=>(0,a._)({},e,{is_best_friend:!1}),target:r}),{fetchUserFx:n,subscribeToPostsFx:c,unsubscribeFromPostsFx:d,subscribeToVideoLiveFx:l,unsubscribeFromVideoLiveFx:u,faveAddUserFx:p,faveRemoveUserFx:_,accountBanFx:f,accountUnbanFx:v,bestFriendAddFx:S,bestFriendDeleteFx:m,$user:r,domain:e}}},172721:(e,t,r)=>{r.d(t,{apiFaveAddNarrative:()=>a,apiFaveRemoveNarrative:()=>s});var i=r(599809);function a(e){return(0,i.api)("fave.addNarrative",e)}function s(e){return(0,i.api)("fave.removeNarrative",e)}},65856:(e,t,r)=>{r.d(t,{createFaveService:()=>i.createFaveService});r(172721);var i=r(34570)},34570:(e,t,r)=>{r.d(t,{createFaveService:()=>s});var i=r(798116),a=r(172721);const s=({domain:e})=>{const t=e.createEvent("fire/faveAddNarrative"),r=e.createEvent("fire/faveRemoveNarrative"),s=e.createEffect("fx/faveAddNarrative"),o=e.createEffect("fx/faveRemoveNarrative");return s.use(a.apiFaveAddNarrative),o.use(a.apiFaveRemoveNarrative),(0,i.sample)({clock:t,target:s}),(0,i.sample)({clock:r,target:o}),{fireAddNarrative:t,fireRemoveNarrative:r,addNarrativeFx:s,removeNarrativeFx:o}}},558719:(e,t,r)=>{r.d(t,{findOwnerById:()=>s,isGroup:()=>a});var i=r(723062);function a(e){return i.Ranges.isGroupId(e.id)}const s=(e=0,t=[],r=[])=>{if(e)return i.Ranges.isUserId(e)?t.find((t=>{var r;return(null==(r=t)?void 0:r.id)===e})):r.find((t=>{var r;return(null==(r=t)?void 0:r.id)===Math.abs(e)}))}},517366:(e,t,r)=>{var i,a,s,o,n,c,d,l;r.d(t,{StickerTypes:()=>c,StoryBlockType:()=>o,StoryEntryPoint:()=>a,StoryListName:()=>n,StoryPollBackgroundType:()=>l,StorySource:()=>s,StoryStickerSubtype:()=>d,StoryType:()=>i}),function(e){e.PHOTO="photo",e.VIDEO="video",e.LIVE="live"}(i||(i={})),function(e){e.SWIPE="swipe",e.NAVIGATION_BUTTON="navigation_button",e.SIT_POSTING="sit_posting",e.LINK="link",e.STORY_REPLY="story_reply",e.STORY_REPOST="story_repost",e.CATALOG_ADD="catalog_add",e.DIALOG="dialog",e.STORY_LIVE_FINISHED="story_live_finished",e.DIALOG_VKME="dialog_vkme",e.STORY_VIEWER_FINISHED="story_viewer_finished",e.PUSH_TRY_MASK="push_try_mask",e.STORY_VIEWER_TRY_MASK="story_viewer_try_mask",e.LINK_MASK="link_mask",e.POSTING="posting",e.NEW_STORY_AVATAR="new_story_avatar",e.STORY_REPLIES_LIST="story_replies_list",e.STORIES_FEED="stories_feed",e.STORIES_SEARCH_NEWS="stories_search_news",e.QUESTION_STICKER="question_sticker",e.LIST_MIDDLE="list_middle",e.ARCHIVE_EMPTY_BUTTON="archive_empty_button",e.ARCHIVE_MENU_BUTTON="archive_menu_button",e.IM="im",e.PROFILE_BUTTON="profile_button",e.SHARE="share",e.MINI_APP="mini_app",e.SYSTEM_SHARING="system_sharing",e.SHORTCUT="shortcut",e.ARCHIVE_SHARING="archive_sharing",e.STORY_VIEWER_CAMERA_BUTTON="story_viewer_camera_button",e.STORY_VIEWER_MUSIC="story_viewer_music",e.STORY_VIEWER_MUSIC_SHEET="story_viewer_music_sheet",e.REPOST_TO_STORY_ACTIVITY="repost_to_story_activity",e.CHANGE_AVATAR="change_avatar"}(a||(a={})),function(e){e.FEED="feed",e.FEED_MIDDLE="feed_middle",e.LINK="link",e.PROFILE="profile",e.IM_DIALOGS="im_dialogs",e.IM_DIALOG_HEADER="im_dialog_header",e.SNIPPET="snippet",e.REPLY="reply",e.REPLIES_LIST="replies_list",e.REPLY_STORY="reply_story",e.DISCOVER="discover",e.STORIES_MANAGE="stories_manage",e.USER_PERSONAL_CARD="user_personal_card",e.GROUP_PERSONAL_CARD="group_personal_card",e.NARRATIVE_SNIPPET="narrative_snippet",e.NARRATIVE_STORY="narrative_story",e.NARRATIVE_LINK="narrative_link",e.NARRATIVE_RECOMMENDATIONS="narrative_recommendations",e.NARRATIVE_SECTION="narrative_section",e.FAVE="fave",e.SPAMFEED="sf",e.ADS_PREVIEW="ads_preview",e.LIST_MIDDLE="list_middle",e.PLACE_STORY_LIST="place_story_list",e.SEARCH_STORY_LIST="search_story_list",e.STORY_ARCHIVE="story_archive",e.IM_MSG_LIST="im_msg_list",e.NOSPAM="nospam",e.PROFILE_SNACKBAR="profile_snackbar",e.MY_QUESTIONS="question_story"}(s||(s={})),function(e){e.stories="stories",e.appGroupedStories="app_grouped_stories",e.discover="discover"}(o||(o={})),function(e){e.feed="feed",e.apps="apps",e.discover="discover"}(n||(n={})),function(e){e[e.hashtag=1]="hashtag",e[e.mention=2]="mention",e[e.question=3]="question",e[e.place=4]="place",e[e.music=5]="music",e[e.storyReply=6]="storyReply",e[e.owner=7]="owner",e[e.link=8]="link",e[e.marketItem=9]="marketItem",e[e.post=10]="post",e[e.poll=11]="poll",e[e.sticker=12]="sticker",e[e.app=13]="app",e[e.situationalTheme=14]="situationalTheme",e[e.playlist=15]="playlist",e[e.videoButton=16]="videoButton"}(c||(c={})),function(e){e.aliexpress="aliexpress_product",e.market="market_item"}(d||(d={})),function(e){e.photo="photo",e.gradient="gradient",e.default="default"}(l||(l={}))},389920:(e,t,r)=>{r.d(t,{apiLikesAdd:()=>a,apiLikesDelete:()=>s});var i=r(599809);function a(e){return(0,i.api)("likes.add",e)}function s(e){return(0,i.api)("likes.delete",e)}},274857:(e,t,r)=>{var i;!function(e){e.Story="story"}(i||(i={}))},655555:(e,t,r)=>{r.d(t,{createLikesService:()=>i.createLikesService});var i=r(202269);r(389920),r(274857)},202269:(e,t,r)=>{r.d(t,{createLikesService:()=>s});var i=r(798116),a=r(389920);const s=({domain:e})=>{const t=e.createEvent("fire/likesAdd"),r=e.createEvent("fire/likesDelete"),s=e.createEffect("fx/likesAdd"),o=e.createEffect("fx/likesDelete");return s.use(a.apiLikesAdd),o.use(a.apiLikesDelete),(0,i.sample)({clock:t,target:s}),(0,i.sample)({clock:r,target:o}),{fireAdd:t,fireDelete:r,addFx:s,deleteFx:o}}},543384:(e,t,r)=>{r.d(t,{apiMessagesSend:()=>a});var i=r(599809);function a(e){return(0,i.api)("messages.send",e)}},105338:(e,t,r)=>{r.d(t,{apiMessagesSend:()=>i.apiMessagesSend,createMessagesService:()=>a.createMessagesService});var i=r(543384),a=r(429128)},429128:(e,t,r)=>{r.d(t,{createMessagesService:()=>s});var i=r(798116),a=r(543384);const s=({domain:e})=>{const t=e.createEvent("fire/messageSend"),r=e.createEffect("fx/messageSend");return r.use(a.apiMessagesSend),(0,i.sample)({clock:t,target:r}),{fireMessagesSend:t,sendFx:r}}},494810:(e,t,r)=>{r.d(t,{apiNarrativesBatchEdit:()=>o,apiNarrativesCreate:()=>a,apiNarrativesDelete:()=>n,apiNarrativesEdit:()=>s,apiNarrativesGetById:()=>c,apiNarrativesGetFeedBlock:()=>d,apiNarrativesGetFromOwner:()=>l,apiNarrativesReorder:()=>p,apiNarrativesSaveCustomCover:()=>u});var i=r(599809);function a(e){return(0,i.api)("narratives.create",e)}function s(e){return(0,i.api)("narratives.edit",e)}function o(e){return(0,i.api)("narratives.batchEdit",e)}function n(e){return(0,i.api)("narratives.delete",e)}function c(e){return(0,i.api)("narratives.getById",e)}function d(e={}){return(0,i.api)("narratives.getFeedBlock",e)}function l(e){return(0,i.api)("narratives.getFromOwner",e)}function u(e){return(0,i.api)("narratives.saveCustomCover",e)}function p(e){return(0,i.api)("narratives.reorder",e)}},683313:(e,t,r)=>{r.d(t,{apiNarrativesGetById:()=>a.apiNarrativesGetById,apiNarrativesGetFeedBlock:()=>a.apiNarrativesGetFeedBlock,apiNarrativesGetFromOwner:()=>a.apiNarrativesGetFromOwner,createNarrativesService:()=>i.createNarrativesService});var i=r(382983),a=r(494810)},382983:(e,t,r)=>{r.d(t,{createNarrativesService:()=>s});var i=r(798116),a=r(494810);const s=({domain:e})=>{const t=e.createEvent("fire/narrativesGetById"),r=e.createEvent("fire/narrativesGetFromOwner"),s=e.createEvent("fire/narrativesGetFeedBlock"),o=e.createEvent("fire/narrativesCreate"),n=e.createEvent("fire/narrativesEdit"),c=e.createEvent("fire/narrativesBatchEdit"),d=e.createEvent("fire/narrativesDelete"),l=e.createEvent("fire/narrativesSaveCustomCover"),u=e.createEvent("fire/narrativesReorder"),p=e.createEffect("fx/narrativesGetById"),_=e.createEffect("fx/narrativesGetFromOwner"),f=e.createEffect("fx/narrativesGetFeedBlock"),v=e.createEffect("fx/narrativesCreate"),S=e.createEffect("fx/narrativesEdit"),m=e.createEffect("fx/narrativesBatchEdit"),g=e.createEffect("fx/narrativesDelete"),h=e.createEffect("fx/narrativesSaveCustomCover"),k=e.createEffect("fx/narrativesReorder");return p.use(a.apiNarrativesGetById),_.use(a.apiNarrativesGetFromOwner),f.use(a.apiNarrativesGetFeedBlock),v.use(a.apiNarrativesCreate),S.use(a.apiNarrativesEdit),m.use(a.apiNarrativesBatchEdit),g.use(a.apiNarrativesDelete),h.use(a.apiNarrativesSaveCustomCover),k.use(a.apiNarrativesReorder),(0,i.sample)({clock:t,target:p}),(0,i.sample)({clock:r,target:_}),(0,i.sample)({clock:s,target:f}),(0,i.sample)({clock:o,target:v}),(0,i.sample)({clock:n,target:S}),(0,i.sample)({clock:c,target:m}),(0,i.sample)({clock:d,target:g}),(0,i.sample)({clock:l,target:h}),(0,i.sample)({clock:u,target:k}),{fireGetById:t,fireGetFromOwner:r,fireGetFeedBlock:s,fireCreate:o,fireEdit:n,fireBatchEdit:c,fireDelete:d,fireSaveCustomCover:l,fireReorder:u,getByIdFx:p,getFromOwnerFx:_,getFeedBlockFx:f,createFx:v,editFx:S,batchEditFx:m,deleteFx:g,saveCustomCoverFx:h,reorderFx:k}}},888711:(e,t,r)=>{function i(e,t=","){return e&&e.length?e.reduce(((e,r)=>{const i="rawId"in r?r.rawId:`${r.owner_id}_${r.id}`;return i&&(e+=`${e.length?t:""}${i}`),e}),""):""}r.d(t,{joinNarrativeRawIds:()=>i})},654803:(e,t,r)=>{r.d(t,{PHOTO_ALBUM_COVER_MIN_WIDTH:()=>i,getPhotoSize:()=>a});const i=200;function a(e,t){var r,i,a,s;if(!(null==(i=e)||null==(r=i.sizes)?void 0:r.length))return"";const o=[...e.sizes].sort(((e,t)=>e.width-t.width));let n=o.find((e=>e.width>=t));return(null==(a=n)?void 0:a.url)?n.url:(n=o.reverse().find((e=>e.width<t)),(null==(s=n)?void 0:s.url)?n.url:"")}},630330:(e,t,r)=>{r.d(t,{apiPollsCreate:()=>s,apiPollsGetById:()=>a});var i=r(599809);function a(e){return(0,i.api)("polls.getById",e)}function s(e){return(0,i.api)("polls.create",e)}},527487:(e,t,r)=>{r.d(t,{createPollsService:()=>i.createPollsService});r(630330);var i=r(892883)},892883:(e,t,r)=>{r.d(t,{createPollsService:()=>s});var i=r(798116),a=r(630330);const s=({domain:e})=>{const t=e.createEvent("fire/pollsGetById"),r=e.createEvent("fire/pollsCreate"),s=e.createEffect("fx/pollsGetById"),o=e.createEffect("fx/pollsCreate");return s.use(a.apiPollsGetById),o.use(a.apiPollsCreate),(0,i.sample)({clock:t,target:s}),(0,i.sample)({clock:r,target:o}),{fireGetById:t,fireCreate:r,getByIdFx:s,createFx:o}}},852063:(e,t,r)=>{r.d(t,{apiStatsTrackEvents:()=>a});var i=r(599809);function a(e){return(0,i.api)("stats.trackEvents",e)}},168298:(e,t,r)=>{r.d(t,{STATS_EVENT_TYPE_STORIES_VIEWER_NAVIGATION:()=>i,STATS_EVENT_TYPE_STORIES_VIEWING_START_TIME:()=>a,STATS_EVENT_TYPE_STORY_LINK_VIEW:()=>s,STATS_EVENT_TYPE_VIDEO_ONBOARDING:()=>o});const i="stories_viewer_navigation",a="stories_viewing_start_time",s="story_link_view",o="video_onboarding"},697227:(e,t,r)=>{r.d(t,{STATS_EVENT_TYPE_STORY_LINK_VIEW:()=>i.STATS_EVENT_TYPE_STORY_LINK_VIEW,STATS_EVENT_TYPE_VIDEO_ONBOARDING:()=>i.STATS_EVENT_TYPE_VIDEO_ONBOARDING,apiStatsTrackEvents:()=>a.apiStatsTrackEvents,createStatsService:()=>s.createStatsService});var i=r(168298),a=r(852063),s=r(513234)},513234:(e,t,r)=>{r.d(t,{createStatsService:()=>s});var i=r(798116),a=r(852063);const s=({domain:e})=>{const t=e.createEvent("fire/statsTrackEvents"),r=e.createEffect("fx/statsTrackEvents");return r.use(a.apiStatsTrackEvents),(0,i.sample)({clock:t,target:r}),{fireTrackEvents:t,trackEventsFx:r}}},911622:(e,t,r)=>{r.d(t,{apiStoriesAskQuestion:()=>k,apiStoriesBanOwner:()=>N,apiStoriesBanQuestionAuthor:()=>E,apiStoriesDelete:()=>h,apiStoriesDeleteQuestion:()=>y,apiStoriesGet:()=>a,apiStoriesGetArchive:()=>c,apiStoriesGetById:()=>o,apiStoriesGetDetailedStats:()=>_,apiStoriesGetDiscover:()=>n,apiStoriesGetPhotoUploadServer:()=>b,apiStoriesGetQuestions:()=>u,apiStoriesGetReplies:()=>l,apiStoriesGetStats:()=>p,apiStoriesGetVideoUploadServer:()=>A,apiStoriesGetViewers:()=>d,apiStoriesGetWithPrefetch:()=>s,apiStoriesHideAllReplies:()=>G,apiStoriesHidePrivacyBlock:()=>g,apiStoriesHideReply:()=>x,apiStoriesMarkAppNotificationsSeen:()=>T,apiStoriesMarkNotInterested:()=>v,apiStoriesMarkSeen:()=>m,apiStoriesMarkSkipped:()=>f,apiStoriesSave:()=>F,apiStoriesSearch:()=>S,apiStoriesSetDiscoverVisible:()=>R,apiStoriesSubscribeUserToApp:()=>I,apiStoriesUnbanOwner:()=>O,apiStoriesUnbanQuestionAuthor:()=>w});var i=r(599809);function a(e){return(0,i.api)("stories.get",e)}function s(e){return(0,i.apiWithPrefetch)("stories.get",e)}function o(e){return(0,i.api)("stories.getById",e)}function n(e){return(0,i.api)("stories.getDiscover",e)}function c(e){return(0,i.api)("stories.getArchive",e)}function d(e){return(0,i.api)("stories.getViewers",e)}function l(e){return(0,i.api)("stories.getReplies",e)}function u(e){return(0,i.api)("stories.getQuestions",e)}function p(e){return(0,i.api)("stories.getStats",e)}function _(e){return(0,i.api)("stories.getDetailedStats",e)}function f(e){return(0,i.api)("stories.markSkipped",e)}function v(e){return(0,i.api)("stories.markNotInterested",e)}function S(e){return(0,i.api)("stories.search",e)}function m(e){return(0,i.api)("stories.markSeen",e)}function g(e){return(0,i.api)("stories.hidePrivacyBlock",e)}function h(e){return(0,i.api)("stories.delete",e)}function k(e){return(0,i.api)("stories.askQuestion",e)}function y(e){return(0,i.api)("stories.deleteQuestion",e)}function E(e){return(0,i.api)("stories.banQuestionAuthor",e)}function w(e){return(0,i.api)("stories.unbanQuestionAuthor",e)}function T(e){return(0,i.api)("stories.markAppNotificationsSeen",e)}function I(e){return(0,i.api)("stories.subscribeUserToApp",e)}function b(e){return(0,i.api)("stories.getPhotoUploadServer",e)}function A(e){return(0,i.api)("stories.getVideoUploadServer",e)}function F(e){return(0,i.api)("stories.save",e)}function N(e){return(0,i.api)("stories.banOwner",e)}function O(e){return(0,i.api)("stories.unbanOwner",e)}function R(e){return(0,i.api)("stories.setDiscoverVisible",e)}function x(e){return(0,i.api)("stories.hideReply",e)}function G(e){return(0,i.api)("stories.hideAllReplies",e)}},446731:(e,t,r)=>{r.d(t,{STORIES_ARCHIVE_START_TIME:()=>a,STORIES_MAX_COUNT_REPLIES:()=>i});const i=250,a=1559032200},713574:(e,t,r)=>{r.d(t,{StoryFeedbackLoadMethods:()=>i,fetchFeedbackFx:()=>n,getStoryFeedbackLoadParams:()=>o});var i,a=r(735369),s=r(677662);!function(e){e[e.getViewers=0]="getViewers",e[e.getReplies=1]="getReplies",e[e.getQuestions=2]="getQuestions",e[e.getDetailedStats=3]="getDetailedStats",e[e.getStats=4]="getStats"}(i||(i={}));const o=(e,t)=>({0:{owner_id:e,story_id:t,extended:1,count:100,fields:(0,s.makeOwnerFields)(["is_nft","photo_100","photo_50"])},1:{owner_id:e,story_id:t,extended:1,fields:(0,s.getStoryOwnerFields)()},2:{owner_id:e,story_id:t,extended:1,fields:(0,s.makeOwnerFields)(["domain","first_name_dat","first_name_ins","last_name_ins","last_name_dat","first_name_gen","last_name_gen"]),count:30},3:{owner_id:e,story_id:t},4:{owner_id:e,story_id:t}}),n=a.storiesDomain.createEffect({name:"fire/storiesGetFeedback",handler:({ownerId:e,storyId:t,pollId:r})=>{const i=o(e,t);return Promise.allSettled([a.storiesService.getViewersFx(i[0]),a.storiesService.getRepliesFx(i[1]),a.storiesService.getQuestionsFx(i[2]),r?a.pollsService.getByIdFx({owner_id:e,poll_id:r}):Promise.resolve(null),a.storiesService.getDetailedStatsFx(i[3]),a.storiesService.getStatsFx(i[4])]).then((e=>e.map((e=>{var t;return"fulfilled"===e.status?null==(t=e)?void 0:t.value:null}))))}})},332268:(e,t,r)=>{r.d(t,{STORIES_ARCHIVE_START_TIME:()=>n.STORIES_ARCHIVE_START_TIME,STORIES_MAX_COUNT_REPLIES:()=>n.STORIES_MAX_COUNT_REPLIES,StoryFeedbackLoadMethods:()=>d.StoryFeedbackLoadMethods,apiStoriesGet:()=>o.apiStoriesGet,apiStoriesGetArchive:()=>o.apiStoriesGetArchive,apiStoriesGetById:()=>o.apiStoriesGetById,apiStoriesGetDiscover:()=>o.apiStoriesGetDiscover,apiStoriesGetReplies:()=>o.apiStoriesGetReplies,apiStoriesGetWithPrefetch:()=>o.apiStoriesGetWithPrefetch,apiStoriesSearch:()=>o.apiStoriesSearch,clearStoriesLoadingStats:()=>s.clearStoriesLoadingStats,clearStoriesNavigationStats:()=>s.clearStoriesNavigationStats,createStoriesService:()=>i.createStoriesService,decodeBase64:()=>a.decodeBase64,faveService:()=>c.faveService,fetchFeedbackFx:()=>d.fetchFeedbackFx,getConnectionType:()=>s.getConnectionType,getStoriesLoadingStats:()=>s.getStoriesLoadingStats,getStoriesNavigationStats:()=>s.getStoriesNavigationStats,getStoryFeedbackLoadParams:()=>d.getStoryFeedbackLoadParams,narrativesService:()=>c.narrativesService,saveNavigationStatEvent:()=>s.saveNavigationStatEvent,saveViewerStartTime:()=>s.saveViewerStartTime,serializeLoadingStats:()=>s.serializeLoadingStats,serializeNavigationStats:()=>s.serializeNavigationStats,splitStoryRawId:()=>a.splitStoryRawId,statsService:()=>c.statsService,storiesService:()=>c.storiesService,userService:()=>c.userService});var i=r(558231),a=r(477932),s=r(386694),o=r(911622),n=r(446731),c=r(735369),d=r(713574)},542313:(e,t,r)=>{r.d(t,{fetchList:()=>E,parseExtra:()=>T});var i=r(30321),a=r(332268),s=r(683313),o=r(677662),n=r(404145),c=r(888711),d=r(839470);const l=/^feed$/,u=/^discover$/,p=/(-?\d+)_(\d+)/,_=/^owner_feed(-?\d+)/,f=/^replies(-?\d+)_(\d+)/,v=/^narrative(-?\d+)_(\d+)$/,S=/^narratives(-?\d+)$/,m=/^recommended_narratives$/,g=/^archive(?:(-?\d+)_)?([0-9]+)/,h=/^search_([\w|-]+)/,k=/^place(\d+)/,y=(0,d.partConfigEnabled)("mvk_feed_stories_block_async_with_prefetch");function E(e,t){let r=e.match(l);if(r)return(y?a.apiStoriesGetWithPrefetch:a.apiStoriesGet)({fields:(0,o.getStoryOwnerFields)(),extended:1}).then((t=>{var r;return{list:(0,i.transformStoryGetApiResponseToLegacyFormat)(t,e,(0,n.isMvk)()),nextFrom:(null==(r=t)?void 0:r.next_from)||"",response:t}}));var d,E,T;if(r=e.match(u),r)return(0,a.apiStoriesGetDiscover)({count:null==(d=t)?void 0:d.count,track_code:null==(E=t)?void 0:E.trackCode,start_from:null==(T=t)?void 0:T.startFrom,fields:(0,o.getStoryOwnerFields)(),extended:1}).then((t=>{var r;return{list:(0,i.transformStoryGetApiResponseToLegacyFormat)(t,e,(0,n.isMvk)()),nextFrom:(null==(r=t)?void 0:r.next_from)||""}}));if(r=e.match(_),r){const t=Number(r[1]);return t?(0,a.apiStoriesGet)({owner_id:t,fields:(0,o.getStoryOwnerFields)(),extended:1}).then((t=>{var r;return{list:(0,i.transformStoryGetApiResponseToLegacyFormat)(t,e,(0,n.isMvk)()),nextFrom:(null==(r=t)?void 0:r.next_from)||""}})):Promise.reject("empty ownerId")}if(r=e.match(f),r){const t=Number(r[1]),s=Number(r[2]);return t&&s?(0,a.apiStoriesGetReplies)({owner_id:t,story_id:s,fields:(0,o.getStoryOwnerFields)(),extended:1}).then((t=>{var r;return{list:(0,i.transformStoryGetApiResponseToLegacyFormat)(t,e,(0,n.isMvk)()),nextFrom:(null==(r=t)?void 0:r.next_from)||""}})):Promise.reject("ownerId or storyId is empty")}if(r=e.match(v),r){const t=Number(r[1]),i=Number(r[2]);if(!t||!i)return Promise.reject("ownerId or narrativeId is empty");return w(e,`${t}_${i}`)}if(r=e.match(S),r){var I,b;const i=Number(r[1]);if(!i)return Promise.reject("ownerId is empty");let a=null==(I=t)?void 0:I.narrativeRawIds;return(null==(b=a)?void 0:b.length)?w(e,a):(0,s.apiNarrativesGetFromOwner)({owner_id:i,with_empty:0,limit:15}).then((t=>{var r,i;return a=(0,c.joinNarrativeRawIds)(null==(r=t)?void 0:r.items),(null==(i=a)?void 0:i.length)?w(e,a):Promise.reject("narrativeRawIds is empty")}))}if(r=e.match(m),r){var A,F;let r=null==(A=t)?void 0:A.narrativeRawIds;return(null==(F=r)?void 0:F.length)?w(e,r):(0,s.apiNarrativesGetFeedBlock)().then((t=>{var i,a,s;return r=(0,c.joinNarrativeRawIds)(null==(a=t)||null==(i=a.block)?void 0:i.narratives),(null==(s=r)?void 0:s.length)?w(e,r):Promise.reject("narrativeRawIds is empty")}))}if(r=e.match(g),r){const t=r[1],s=Number(r[2]);return t?(0,a.apiStoriesGetArchive)({date:s,fields:(0,o.getStoryOwnerFields)(),extended:1}).then((t=>({list:(0,i.transformStoriesToLegacy)(t,e,(0,n.isMvk)())}))):Promise.reject("ownerId is empty")}if(r=e.match(p),r){var N;const s=Number(r[1]),c=Number(r[2]);if(!s||!c)return Promise.reject("ownerId or storyId is empty");const d=null==(N=t)?void 0:N.context;return"all"===d||"new"===d?(0,a.apiStoriesGet)({fields:(0,o.getStoryOwnerFields)(),extended:1}).then((t=>({list:(0,i.transformStoryGetApiResponseToLegacyFormat)(t,e,(0,n.isMvk)())}))):(0,a.apiStoriesGetById)({stories:`${s}_${c}`,with_context:"owner"===d?1:0,fields:(0,o.getStoryOwnerFields)(),extended:1}).then((t=>({list:(0,i.transformStoriesToLegacy)(t,e,(0,n.isMvk)())})))}if(r=e.match(h),r){var O;const s=r[1],c=null==(O=t)?void 0:O.situationalSuggestId;if(!s&&void 0===c)return Promise.reject("rawQuery or suggest id is empty");let d="";if(s){const e=s.replaceAll("-","+").replaceAll("_","/");d=(0,a.decodeBase64)(e)}return(0,a.apiStoriesSearch)({q:d,count:100,situational_suggest_id:c,fields:(0,o.getStoryOwnerFields)(),extended:1}).then((t=>({list:(0,i.transformStoryGetApiResponseToLegacyFormat)(t,e,(0,n.isMvk)())})))}if(r=e.match(k),r){const t=Number(r[1]);return t?(0,a.apiStoriesSearch)({place_id:t,count:100,fields:(0,o.getStoryOwnerFields)(),extended:1}).then((t=>({list:(0,i.transformStoryGetApiResponseToLegacyFormat)(t,e,(0,n.isMvk)())}))):Promise.reject("place id is empty")}return Promise.reject("unknown list")}function w(e="",t=""){return(0,s.apiNarrativesGetById)({narratives:t,fields:(0,o.getStoryOwnerFields)(),extended:1}).then((t=>({list:(0,i.transformNarrativeGetApiResponseToLegacyFormat)(t,e,(0,n.isMvk)())})))}function T(e){const t={},r=String(e).split(";");for(let e of r){const[r,i]=e.split(":");r&&i&&(t[r]=i)}return t}},677662:(e,t,r)=>{function i(){return a(["first_name","last_name","first_name_gen","last_name_gen","first_name_ins","last_name_ins","screen_name","name","is_member","is_closed","is_nft","is_nft_photo","photo_50","photo_100","friend_status","verified","sex"])}function a(e){return e.join(",")}r.d(t,{getStoryOwnerFields:()=>i,makeOwnerFields:()=>a})},502400:(e,t,r)=>{r.d(t,{transformClickableStickers:()=>S});var i=r(659397),a=r(654198),s=r(120718),o=r(946742),n=r(29271),c=r(654803),d=r(558719),l=r(571039),u=r(517366);const p={hashtag:u.StickerTypes.hashtag,mention:u.StickerTypes.mention,question:u.StickerTypes.question,place:u.StickerTypes.place,music:u.StickerTypes.music,story_reply:u.StickerTypes.storyReply,owner:u.StickerTypes.owner,link:u.StickerTypes.link,market_item:u.StickerTypes.marketItem,post:u.StickerTypes.post,poll:u.StickerTypes.poll,sticker:u.StickerTypes.sticker,app:u.StickerTypes.app,situational_theme:u.StickerTypes.situationalTheme,playlist:u.StickerTypes.playlist,clip:u.StickerTypes.videoButton},_={transparent:1,blue_gradient:2,red_gradient:3,underline:4,blue:5,green:6,white:7,question_reply:8,light:9,impressive:10,dark:11,accent_background:12,accent_text:13,dark_unique:14,light_unique:15,light_text:18,dark_text:19,black:20,dark_without_bg:21,light_without_bg:22},f=(e,t=6)=>isNaN(e)?NaN:Number(e.toFixed(t)),v=/^\[(id|club)(\d+)\|(.*)]$/;function S(e,t=[],r=[],S){var m,g,h;const k=null==(m=e)?void 0:m.clickable_stickers;if(!(k&&Object.values(k).length&&k.original_width&&k.original_height))return{original_width:0,original_height:0,stickers:[]};let y=k.original_width,E=k.original_height;Number((E/y).toFixed(2))>1.78&&(E=1.78*y);const w=(k.original_height-E)/2,T=y/100,I=E/100;return{original_width:y,original_height:E,stickers:(null==(h=k)||null==(g=h.clickable_stickers)?void 0:g.length)?k.clickable_stickers.reduce(((m,g)=>{if(!g)return m;const{clickable_area:h=[]}=g;if(h.length<4)return m;const k=Math.sqrt(Math.pow(h[1].x-h[0].x,2)+Math.pow(h[1].y-h[0].y,2)),y=Math.sqrt(Math.pow(h[1].x-h[2].x,2)+Math.pow(h[1].y-h[2].y,2));if(!k||!y)return m;const E=h[1].x-h[0].x;let b=180*Math.acos(E/k)/Math.PI;isNaN(b)&&(b=0),h[1].y<h[0].y&&(b=-b);const A=p[g.type],F={id:g.id,type:A,top:f((h[0].y-w)/I/100),left:f(h[0].x/T/100),width:f(k/T/100),height:f(y/I/100),rotate:f(b)};g.style&&(F.style=_[g.style]);let N=!1;switch(A){case u.StickerTypes.hashtag:g.hashtag?F.hashtag=g.hashtag:N=!0;break;case u.StickerTypes.mention:{var O,R,x;const e=null==(O=g.mention)?void 0:O.match(v),i=null==(R=e)?void 0:R[1],s=Number(null==(x=e)?void 0:x[2]);if(!s||isNaN(s)){N=!0;break}const o="id"===i&&t.find((({id:e})=>e===s)),n=!o&&"club"===i&&r.find((({id:e})=>e===s));o?(F.mentionedPhotoUrl=o.photo_100||o.photo_50||"",F.mentionedOwnerHref=(0,a.getOwnerHref)(o),F.mentionedText=(0,a.getOwnerFullName)(o)):n?(F.mentionedText=n.name||"",F.mentionedPhotoUrl=n.photo_100||n.photo_50||"",F.mentionedOwnerHref=(0,a.getOwnerHref)(n)):N=!0;break}case u.StickerTypes.question:F.question=g.question||"";break;case u.StickerTypes.place:g.place_id?F.placeId=g.place_id:N=!0;break;case u.StickerTypes.music:if(!g.audio){N=!0;break}var G,P,D;if(F.audioId=`${g.audio.owner_id}_${g.audio.id}`,F.audioData=JSON.stringify((0,o.apiAudioToAudioTuple)(g.audio)),g.audio_restrictions)F.audioRestriction={code:g.audio_restrictions.id,title:g.audio_restrictions.title,buttonText:(null==(G=g.audio_restrictions.button)?void 0:G.title)||"",buttonUrl:(null==(D=g.audio_restrictions.button)||null==(P=D.action)?void 0:P.url)||""};break;case u.StickerTypes.playlist:if(!g.playlist){N=!0;break}F.playlistOwnerId=g.playlist.owner_id,F.playlistId=g.playlist.id,F.playlistFollowed=Boolean(g.playlist.followed);break;case u.StickerTypes.storyReply:g.owner_id&&(F.ownerId=g.owner_id),F.link=(0,a.getOwnerHref)((0,d.findOwnerById)(g.owner_id,t,r)),g.story_id?F.storyId=g.story_id:F.isExpired=!0;break;case u.StickerTypes.owner:g.owner_id&&(F.ownerId=g.owner_id),F.link=(0,a.getOwnerHref)((0,d.findOwnerById)(g.owner_id,t,r));break;case u.StickerTypes.link:g.link_object?(F.link=g.link_object.url?(0,l.wrapAwayIfExternal)(g.link_object.url):"",F.tooltipText=g.tooltip_text||""):N=!0;break;case u.StickerTypes.marketItem:var B;if(g.subtype===u.StoryStickerSubtype.aliexpress)F.link=(null==(B=g.link_object)?void 0:B.url)?(0,l.wrapAwayIfExternal)(g.link_object.url):"",F.photoUrl=g.link_object&&(0,c.getPhotoSize)(g.link_object.photo,50*devicePixelRatio)||"";else if(g.subtype===u.StoryStickerSubtype.market&&g.market_item){var L;if(F.photoUrl=g.market_item.thumb&&(null==(L=(0,i.getPhotoSize)(g.market_item.thumb,50*devicePixelRatio))?void 0:L.url)||"",F.isRestricted=!1,S)F.link=`/product${g.market_item.owner_id}_${g.market_item.id}`;else{const e=(0,a.getOwnerHref)((0,d.findOwnerById)(g.market_item.owner_id,t,r));F.link=`${e}?w=product${g.market_item.owner_id}_${g.market_item.id}`}}else N=!0;break;case u.StickerTypes.post:g.post_owner_id&&(F.postOwnerId=g.post_owner_id),g.post_id?F.postId=g.post_id:N=!0;break;case u.StickerTypes.poll:g.poll?(F.pollId=g.poll.id,F.pollOwnerId=g.poll.owner_id):N=!0;break;case u.StickerTypes.app:if(g.app){F.appId=g.app.id,F.hasNewInteractions=Boolean(g.has_new_interactions);const t=[e.owner_id,e.id,"story",g.id];g.app_context&&t.push(btoa(g.app_context)),F.appRef=`story${t.join("_")}`}else N=!0;break;case u.StickerTypes.sticker:g.sticker_pack_id?(F.stickerPackId=g.sticker_pack_id,g.sticker_id&&(F.stickerId=g.sticker_id),F.tooltipText=n.getLang("stories_view_sticker_pack")):N=!0;break;case u.StickerTypes.situationalTheme:g.situational_theme_id?(F.situationalAppId=s.SITPOSTING_APP_ID,F.situationalThemeId=g.situational_theme_id):N=!0;break;case u.StickerTypes.videoButton:g.clip_id?(g.owner_id&&(F.videoOwnerId=g.owner_id),F.videoId=g.clip_id,F.videoType=g.type,F.tooltipText=n.getLang("stories_link_attach_clip")):N=!0;break;default:N=!0}return N||m.push(F),m}),[]):[]}}},705394:(e,t,r)=>{r.d(t,{transformDetailedStatsData:()=>u,transformPoll:()=>l,transformStoryQuestions:()=>d});var i=r(29271),a=r(659397),s=r(654198),o=r(517366);const n=(e="",t="")=>e&&t?`${e} ${t}`:e||t,c=(e,t=32)=>(0,a.getPhotoSize)(null!=e?e:[],t*window.devicePixelRatio),d=(e,t,r=0,i=0)=>(0,a.isArray)(e)&&(0,a.isArray)(t)?e.map((({id:e,is_anonymous:a,question:o,is_owner_blocked:c,is_published:d,owner_id:l})=>{var u,p,_,f,v,S,m;const g=!a&&window.vk.id!=l,h=!a&&window.vk.id!=l,k=null==(u=t)?void 0:u.find((e=>{var t;return(null==(t=e)?void 0:t.id)===l}));return{author:k?{link:(0,s.getOwnerHref)(k),name:(0,s.getOwnerFullName)(k),nameDat:n(null==(p=k)?void 0:p.first_name_dat,null==(_=k)?void 0:_.last_name_dat),nameGen:n(null==(f=k)?void 0:f.first_name_gen,null==(v=k)?void 0:v.last_name_gen),nameIns:n(null==(S=k)?void 0:S.first_name_ins,null==(m=k)?void 0:m.last_name_ins)}:{},canAnswer:g,canBlocked:h,id:e,isAnonymous:a,isOwnerBlocked:c,isPublished:d,ownerId:l,storyId:i,storyOwnerId:r,text:o}})):[],l=e=>{if(!e)return null;const{votes:t,id:r,owner_id:a,question:s,photo:n,background:d,can_vote:l}=e;return{ownerId:a,pollId:r,question:s,votersCountText:t?i.getLang("voting_N_voted",t):i.getLang("voting_nobody_voted"),background:n?{type:o.StoryPollBackgroundType.photo,photoUrl:(null==(p=c(null==(_=n)?void 0:_.images))?void 0:p.url)||"",backgroundColor:(null==(f=n)?void 0:f.color)||""}:"gradient"===(null==(u=d)?void 0:u.type)?{type:o.StoryPollBackgroundType.gradient,angle:d.angle||0,color:d.color||"",points:d.points||[]}:{type:o.StoryPollBackgroundType.default},needShowResults:!l};var u,p,_,f},u=e=>{var t,r;return e?{preview:e.preview||"",achievement:e.achievement||"",achievementSubtitle:e.achievement_subtitle||"",categories:(null==(t=e.categories)?void 0:t.map((e=>({title:e.header,lines:e.lines.map((e=>({name:e.name||"",counter:e.is_unavailable?i.getLang("stories_stat_off"):String(null!=(r=e.counter)?r:""),unavailable:e.is_unavailable})))}))))||[]}:null}},30321:(e,t,r)=>{r.d(t,{transformDetailedStatsData:()=>a.transformDetailedStatsData,transformNarrativeGetApiResponseToLegacyFormat:()=>i.transformNarrativeGetApiResponseToLegacyFormat,transformPoll:()=>a.transformPoll,transformStoriesToLegacy:()=>i.transformStoriesToLegacy,transformStoryGetApiResponseToLegacyFormat:()=>i.transformStoryGetApiResponseToLegacyFormat,transformStoryQuestions:()=>a.transformStoryQuestions});r(502400),r(752155),r(990311);var i=r(533424),a=r(705394)},533424:(e,t,r)=>{r.d(t,{getVideoSize:()=>I,transformNarrativeGetApiResponseToLegacyFormat:()=>v,transformStoriesToLegacy:()=>h,transformStoryGetApiResponseToLegacyFormat:()=>f});var i=r(492269),a=r(172045),s=r(654198),o=r(29260),n=r(517366),c=r(29271),d=r(659397),l=r(664988),u=r(558719),p=r(502400),_=r(752155);function f(e,t,r){const{items:i,profiles:s=[],groups:o=[]}=e,c=i.map((e=>{var i,c,d,l,p;const _=e.owner_id||(null==(c=e.stories)||null==(i=c[0])?void 0:i.owner_id)||0,v=(0,u.findOwnerById)(_,s,o)||{id:_},h=(null==(d=e.stories)?void 0:d.filter(Boolean))||[],k=t===n.StoryListName.feed||t===n.StoryListName.discover||t===n.StoryListName.apps,y={id:e.id||(0,a.default)(),author:m(v,s,null==(l=h[0])?void 0:l.also_subscribed),has_unseen:e.has_unseen,items:h.map((e=>g(e,v,s,o,r,t))),track_code:e.track_code,can_blacklist:k,app:e.app&&S(e.app),type:e.type,send_mask_hash:"",remove_from_blacklist_hash:"",is_narrative:!1,is_apps:e.type===n.StoryBlockType.appGroupedStories,next_from:""};if((null==(p=e.grouped)?void 0:p.length)&&(y.grouped=f({items:e.grouped,profiles:s,groups:o},t,r)),r){const i=function(e,t,r,i,a,s){var o;const n=null==(o=e.stories)?void 0:o[0],c=e.app;if("app_grouped_stories"!==e.type||!n)return;const d=g(n,t,r,i,a,s);d.raw_id=d.raw_id+"&meta",d.is_apps_meta_story=!0,c&&(d.app=S(c));return d}(e,v,s,o,r,t);i&&y.items.push(i)}return y}));return c}function v(e,t,r){const{items:i,profiles:s=[],groups:o=[]}=e;return i.map((e=>{var i,c,d,l;const p=e.owner_id||(null==(c=e.stories)||null==(i=c[0])?void 0:i.owner_id)||0,f=(0,u.findOwnerById)(p,s,o)||{id:p},v=(null==(d=e.stories)?void 0:d.filter(Boolean))||[];return{id:(0,a.default)(),author:m(f,s,null==(l=v[0])?void 0:l.also_subscribed),items:v.map((e=>g(e,f,s,o,r,t))),can_blacklist:!1,type:n.StoryBlockType.stories,send_mask_hash:"",remove_from_blacklist_hash:"",is_apps:!1,next_from:"",is_narrative:!0,narrative:(0,_.transformNarrative)(e,f)}}))}function S(e){return{url:`/app${e.id}`,name:e.title,photoUrl:e.icon_139||e.icon_150||e.icon_75||""}}function m(e,t=[],r){const i=e.verified?'<div class="page_verified"></div>':"",a=function(e,t=[]){if(!e)return;const r=[],i=e.user_ids||[];return i.forEach((e=>{const i=t.find((t=>t.id===e));i&&r.push({photo_url:i.photo_50||i.photo_100||"",href:(0,s.getOwnerHref)(i),name:i.first_name||"",sex:i.sex||0})})),{total_count:e.count||0,owners:r}}(r,t);if((0,s.isOwnerUser)(e)){const t=e.id,r=e.first_name||"",o=e.last_name||"",n=e.first_name_gen||"",c=e.last_name_gen||"",l=e.first_name_ins||"",u=(0,s.getOwnerFullName)(e),p=o?`${n} ${c}`:n;return{id:t,name:(0,d.escape)(u),name_get:(0,d.escape)(p),firstName:(0,d.escape)(r),first_name_gen:(0,d.escape)(n),first_name_ins:(0,d.escape)(l),photo:e.photo_100||e.photo_50||"",href:(0,s.getOwnerHref)(e),verify:i,gender:e.sex||0,can_follow:y(e),nft:Boolean(e.is_nft),also_subscribed:a}}const o=-e.id,n=(0,d.escape)(e.name||"");return{id:o,name:n,name_get:n,firstName:n,first_name_gen:n,first_name_ins:n,photo:e.photo_100||e.photo_50||"",href:(0,s.getOwnerHref)(e),verify:i,gender:0,can_follow:y(e),nft:Boolean(e.is_nft_photo),also_subscribed:a}}function g(e,t,r,i,a,_){var f,v,S,m,g,h,y,A,F,N,O;let R,x;if(null==(f=e.mask)?void 0:f.owner_id){var G;const t=(0,u.findOwnerById)(null==(G=e.mask)?void 0:G.owner_id,r,i);t&&(R=t.screen_name,(0,s.isOwnerUser)(t)&&(x=t.sex))}const P=E(t,e),D=!P&&(_===n.StoryListName.feed||_===n.StoryListName.apps||_===n.StoryListName.discover);return{owner_id:e.owner_id,raw_id:`${e.owner_id}_${e.id}`,date:(0,c.getSmDate)(e.date||0),time:e.date||0,type:b(e),unread:!e.seen,canLike:Boolean(e.can_like),can_comment:Boolean(e.can_comment),can_share:Boolean(e.can_share),can_remove:w(e,t),can_manage:P,can_ask:Boolean(e.can_ask),can_ask_anonymous:Boolean(e.can_ask_anonymous),canAddToNarrative:e.can_use_in_narrative,stats:{follow:{event_type:"subscribe",rhash:""},url_view:{event_type:"url_view",rhash:""}},isLiked:Boolean(e.is_liked),likeHash:"",reaction_set_id:e.reaction_set_id||"",user_reaction_id:e.user_reaction_id||0,preview_url:"",needMute:Boolean(e.need_mute),muteReply:Boolean(e.mute_reply),isPromo:Boolean(e.is_promo),isProfileQuestion:Boolean(e.is_profile_question),promoCaption:e.is_promo&&e.caption||"",track_code:e.track_code||"",video:{owner_id:e.owner_id,video_id:(null==(v=e.video)?void 0:v.id)||0},link:e.link?{text:e.link.text||"",url:e.link.url||""}:void 0,isPartOfNarrative:Boolean(e.narratives_count),report_hash:"",maskOwnerDomain:R,maskOwnerSex:x,can_hide_reply:T(e,r,i),noSound:Boolean(e.no_sound),isNewQuestions:P&&Boolean(null==(S=e.questions)?void 0:S.new),views:Boolean(e.views)?(0,o.formatCount)(e.views||0):"",needShowEmptyStats:Boolean(e.need_show_empty_stats),is_expired:Boolean(e.is_expired),is_deleted:Boolean(e.is_deleted),is_private:!Boolean(e.can_see),isAds:Boolean(e.is_ads),isOneTime:Boolean(e.is_one_time),isOneTimeSeen:Boolean(e.is_one_time)&&!Boolean(e.can_see),seenProgress:0,replies:(null==(m=e.replies)?void 0:m.count)?(0,o.formatCount)(e.replies.count):"",replies_new_counter:(null==(g=e.replies)?void 0:g.new)||0,clickable_stickers:(0,p.transformClickableStickers)(e,r,i,a),askQuestionHash:"",canMarkNotInterested:D,photo_url:(null==(h=e.photo)?void 0:h.sizes)&&(null==(y=(0,d.getPhotoSize)(e.photo.sizes,(0,l.isRetina)()?1200:600))?void 0:y.url)||"",small_preview:k(e,a),video_url:(null==(A=e.video)?void 0:A.files)?I(e.video.files):"",first_frame:(null==(F=e.video)?void 0:F.first_frame)&&(null==(N=(0,d.getPhotoSize)(null==(O=e.video)?void 0:O.first_frame,800))?void 0:N.url)||"",is_apps_meta_story:!1,repliesCountText:"",authorId:0,isMusicCover:!1,is_authors_ads:e.is_authors_ads,advertiser_info_url:e.advertiser_info_url,ad_marker:e.ad_marker,caption:e.caption,is_best_friends_privacy:e.is_best_friends_privacy}}function h(e,t,r){var i,s;const{items:o,profiles:c,groups:d}=e,l=(null==(i=o[0])?void 0:i.owner_id)||0,p=(0,u.findOwnerById)(l,c,d)||{id:l},_=t===n.StoryListName.feed||t===n.StoryListName.discover||t===n.StoryListName.apps,f=o.some((e=>!e.seen));return[{id:(0,a.default)(),author:m(p,c,null==(s=o[0])?void 0:s.also_subscribed),has_unseen:f,items:o.map((e=>g(e,p,c,d,r,t))),track_code:"",can_blacklist:_,type:n.StoryBlockType.stories,send_mask_hash:"",remove_from_blacklist_hash:"",is_narrative:!1,is_apps:!1,next_from:""}]}function k(e,t=!1){var r,i;const a=null==(r=e.photo)?void 0:r.sizes;var s;if(a)return(null==(s=(0,d.getPhotoSize)(a,t?10:(0,l.isRetina)()?600:300))?void 0:s.url)||"";const o=null==(i=e.video)?void 0:i.first_frame;var n;return o&&(null==(n=(0,d.getPhotoSize)(o,t?10:320))?void 0:n.url)||""}function y(e){return(0,s.isOwnerUser)(e)?window.vk.id!==e.id&&(e.friend_status===i.FriendsFriendStatusStatusEnumNames.NOT_A_FRIEND||e.friend_status===i.FriendsFriendStatusStatusEnumNames.INCOMING_REQUEST):!e.is_member&&!e.is_closed}function E(e,t){return(0,s.isOwnerUser)(e)?t.owner_id===e.id&&window.vk.id===e.id:t.owner_id===-e.id&&(t.is_ads?Boolean(e.is_advertiser):Boolean(e.is_admin))}function w(e,t){return E(t,e)&&("photo"===e.type||"video"===e.type)&&!e.is_deleted}function T(e,t,r){if(!e.parent_story_owner_id||!e.parent_story_id)return!1;const i=window.vk.id,a=e.parent_story_owner_id;if(a===i)return!0;const o=(0,u.findOwnerById)(a,t,r);return!!(o&&(0,s.isOwnerGroup)(o)&&o.is_admin)}function I(e){const t=["mp4_2160","mp4_1440","mp4_1080","mp4_720","mp4_480","mp4_360","mp4_240","mp4_144"].find((t=>Boolean(e[t])));return t&&e[t]?String(e[t]):""}function b(e){return"photo"===e.type?n.StoryType.PHOTO:"video"===e.type?n.StoryType.VIDEO:"live_active"===e.type||"live_finished"===e.type?n.StoryType.LIVE:n.StoryType.PHOTO}},752155:(e,t,r)=>{r.d(t,{transformNarrative:()=>o});var i=r(659397),a=r(654198),s=(r(558719),r(990311));function o(e,t){var r,o;const n=`${e.owner_id}_${e.id}`,c=(0,a.isOwnerGroup)(t),d=c&&Boolean(t.is_closed),l={id:e.id,rawId:n,ownerId:e.owner_id,ownerName:(0,i.escape)((c?t.name:(0,a.getOwnerFullName)(t))||""),ownerShortName:(0,i.escape)((c?t.name:(0,a.getOwnerShortName)(t))||""),ownerUrl:(0,a.getOwnerHref)(t),ownerPath:`${c?"club":"id"}${e.owner_id}`,ownerAvatarUrl:t.photo_100||t.photo_50||"",title:(0,i.escape)(e.title),isBookmarked:e.is_favorite,bookmarkHash:"",reportHash:"",canEdit:Boolean(e.can_delete),editHash:"",canView:e.can_see,storiesCount:(null==(r=e.story_ids)?void 0:r.length)||0,isOwnerClosedGroup:d,isGroupEditor:d&&Boolean(t.is_admin),url:`${window.location.origin}/narrative${n}`,stories:(null==(o=e.stories)?void 0:o.map(s.transformStoryArchive))||[],isDeleted:e.is_delete,date:"",coverUrl:""};if(e.cover){var u;Object.assign(l,{coverUrl:e.cover.cropped_sizes&&(null==(u=(0,i.getPhotoSize)(e.cover.cropped_sizes,300))?void 0:u.url)||"",coverCrop:{x:e.cover.crop_x||0,y:e.cover.crop_y||0,width:e.cover.crop_width||0,height:e.cover.crop_height||0}}),e.cover.custom_photo&&(l.customCover=function(e,t=[]){var r,a,s,o;if(!e)return;return{photoId:e.id,originalPhotoUrl:(null==(r=e.orig_photo)?void 0:r.url)||e.sizes&&(null==(a=(0,i.getPhotoSize)(e.sizes,600))?void 0:a.url)||"",previewUrl:t&&(null==(s=(0,i.getPhotoSize)(t,300))?void 0:s.url)||e.sizes&&(null==(o=(0,i.getPhotoSize)(e.sizes,300))?void 0:o.url)||""}}(e.cover.custom_photo,e.cover.cropped_sizes));const t=e.cover.cover_story_id;if(t){var p;Object.assign(l,{coverStoryId:t,coverStoryRawId:`${e.owner_id}_${t}`});const r=null==(p=e.stories)?void 0:p.find((e=>{var r;return(null==(r=e)?void 0:r.id)===t}));r&&(l.coverStory=(0,s.transformStoryArchive)(r))}}return l}},990311:(e,t,r)=>{r.d(t,{transformStoryArchive:()=>n});var i=r(659397),a=r(332268),s=r(533424),o=r(571039);function n(e){var t,r,n,c;const d=Math.max(e.date?Math.ceil(new Date(1e3*e.date).setUTCHours(0,0,0,0)/1e3):0,a.STORIES_ARCHIVE_START_TIME),l=(null==(t=e.photo)?void 0:t.sizes)||(null==(r=e.video)?void 0:r.image),u={id:e.id,rawId:`${e.owner_id}_${e.id}`,listId:`archive${e.owner_id}_${d}`,time:Number(e.date),preview:l&&(null==(n=(0,i.getPhotoSize)(l,350))?void 0:n.url)||"",originalPreviewUrl:l&&(null==(c=(0,i.getPhotoSize)(l,600))?void 0:c.url)||""};return"video"===e.type&&e.video&&Object.assign(u,{videoUrl:e.video.files&&(0,s.getVideoSize)(e.video.files)||"",duration:e.video.duration}),e.link&&Object.assign(u,{linkUrl:(0,o.wrapAwayIfExternal)(e.link.url)||"",linkText:e.link.text||"",linkType:""}),u}},558231:(e,t,r)=>{r.d(t,{createStoriesService:()=>n});var i=r(798116),a=r(911622),s=r(771611),o=r(924292);const n=({domain:e})=>{const t=e.createEvent("fire/storiesGet"),r=e.createEvent("fire/storiesGetById"),n=e.createEvent("fire/storiesGetArchive"),c=e.createEvent("fire/storiesGetViewers"),d=e.createEvent("fire/storiesGetReplies"),l=e.createEvent("fire/storiesGetQuestions"),u=e.createEvent("fire/storiesGetStats"),p=e.createEvent("fire/storiesGetDetailedStats"),_=e.createEvent("fire/storiesMarkSkipped"),f=e.createEvent("fire/storiesMarkNotInterested"),v=e.createEvent("fire/storiesMarkSeen"),S=e.createEvent("fire/storiesHidePrivacyBlock"),m=e.createEvent("fire/storiesDelete"),g=e.createEvent("fire/storiesAskQuestion"),h=e.createEvent("fire/storiesDeleteQuestion"),k=e.createEvent("fire/storiesBanQuestionAuthor"),y=e.createEvent("fire/storiesUnbanQuestionAuthor"),E=e.createEvent("fire/storiesMarkAppNotificationsSeen"),w=e.createEvent("fire/storiesSubscribeUserToApp"),T=e.createEvent("fire/storiesGetPhotoUploadServer"),I=e.createEvent("fire/storiesGetVideoUploadServer"),b=e.createEvent("fire/storiesSave"),A=e.createEvent("fire/storiesSearch"),F=e.createEvent("fire/storiesUnbanOwner"),N=e.createEvent("fire/storiesBanOwner"),O=e.createEvent("fire/storiesSetDiscoverVisible"),R=e.createEvent("fire/storiesHideReply"),x=e.createEvent("fire/storieHideAllReplies"),G=e.createEffect("fx/storiesGet"),P=e.createEffect("fx/storiesGetById"),D=e.createEffect("fx/storiesGetArchive"),B=e.createEffect("fx/storiesGetViewers"),L=e.createEffect("fx/storiesGetReplies"),M=e.createEffect("fx/storiesGetQuestions"),C=e.createEffect("fx/storiesGetStats"),U=e.createEffect("fx/storiesGetDetailedStats"),V=e.createEffect("fx/storiesMarkSkipped"),H=e.createEffect("fx/storiesMarkNotInterested"),$=e.createEffect("fx/storiesMarkSeen"),Q=e.createEffect("fx/storiesHidePrivacyBlock"),Y=e.createEffect("fx/storiesDelete"),z=e.createEffect("fx/storiesAskQuestion"),j=e.createEffect("fx/storiesDeleteQuestion"),W=e.createEffect("fx/storiesBanQuestionAuthor"),q=e.createEffect("fx/storiesUnbanQuestionAuthor"),K=e.createEffect("fx/storiesMarkAppNotificationsSeen"),X=e.createEffect("fx/storiesSubscribeUserToApp"),J=e.createEffect("fx/storiesGetPhotoUploadServer"),Z=e.createEffect("fx/storiesGetVideoUploadServer"),ee=e.createEffect("fx/storiesSave"),te=e.createEffect("fx/storiesSearch"),re=e.createEffect("fx/storiesUnbanOwner"),ie=e.createEffect("fx/storiesBanOwner"),ae=e.createEffect("fx/storiesSetDiscoverVisible"),se=e.createEffect("fx/storiesHideReply"),oe=e.createEffect("fx/storiesHideAllReplies"),ne=(0,s.createFriendsAddFx)({domain:e}),ce=(0,s.createFriendsDeleteFx)({domain:e}),de=(0,o.createGroupsJoinFx)({domain:e}),le=(0,o.createGroupsLeaveFx)({domain:e});return G.use(a.apiStoriesGet),P.use(a.apiStoriesGetById),D.use(a.apiStoriesGetArchive),B.use(a.apiStoriesGetViewers),L.use(a.apiStoriesGetReplies),M.use(a.apiStoriesGetQuestions),C.use(a.apiStoriesGetStats),U.use(a.apiStoriesGetDetailedStats),V.use(a.apiStoriesMarkSkipped),H.use(a.apiStoriesMarkNotInterested),$.use(a.apiStoriesMarkSeen),Q.use(a.apiStoriesHidePrivacyBlock),Y.use(a.apiStoriesDelete),z.use(a.apiStoriesAskQuestion),j.use(a.apiStoriesDeleteQuestion),W.use(a.apiStoriesBanQuestionAuthor),q.use(a.apiStoriesUnbanQuestionAuthor),K.use(a.apiStoriesMarkAppNotificationsSeen),X.use(a.apiStoriesSubscribeUserToApp),J.use(a.apiStoriesGetPhotoUploadServer),Z.use(a.apiStoriesGetVideoUploadServer),ee.use(a.apiStoriesSave),te.use(a.apiStoriesSearch),ie.use(a.apiStoriesBanOwner),re.use(a.apiStoriesUnbanOwner),ae.use(a.apiStoriesSetDiscoverVisible),se.use(a.apiStoriesHideReply),oe.use(a.apiStoriesHideAllReplies),(0,i.sample)({clock:t,target:G}),(0,i.sample)({clock:r,target:P}),(0,i.sample)({clock:n,target:D}),(0,i.sample)({clock:c,target:B}),(0,i.sample)({clock:d,target:L}),(0,i.sample)({clock:l,target:M}),(0,i.sample)({clock:u,target:C}),(0,i.sample)({clock:p,target:U}),(0,i.sample)({clock:_,target:V}),(0,i.sample)({clock:f,target:H}),(0,i.sample)({clock:v,target:$}),(0,i.sample)({clock:S,target:Q}),(0,i.sample)({clock:m,target:Y}),(0,i.sample)({clock:g,target:z}),(0,i.sample)({clock:h,target:j}),(0,i.sample)({clock:k,target:W}),(0,i.sample)({clock:y,target:q}),(0,i.sample)({clock:E,target:K}),(0,i.sample)({clock:w,target:X}),(0,i.sample)({clock:T,target:J}),(0,i.sample)({clock:I,target:Z}),(0,i.sample)({clock:b,target:ee}),(0,i.sample)({clock:A,target:te}),(0,i.sample)({clock:F,target:re}),(0,i.sample)({clock:N,target:ie}),(0,i.sample)({clock:O,target:ae}),(0,i.sample)({clock:R,target:se}),(0,i.sample)({clock:x,target:oe}),{fireGet:t,fireGetById:r,fireGetArchive:n,fireGetViewers:c,fireGetReplies:d,fireGetQuestions:l,fireGetStats:u,fireGetDetailedStats:p,fireMarkSkipped:_,fireMarkNotInterested:f,fireMarkSeen:v,fireHidePrivacyBlock:S,fireDelete:m,fireAskQuestion:g,fireDeleteQuestion:h,fireBanQuestionAuthor:k,fireUnbanQuestionAuthor:y,fireMarkAppNotificationsSeen:E,fireSubscribeUserToApp:w,fireGetPhotoUploadServer:T,fireGetVideoUploadServer:I,fireSave:b,fireSearch:A,fireUnbanOwner:F,fireBanOwner:N,fireSetDiscoverVisible:O,fireHideReply:R,fireHideAllReplies:x,getFx:G,getByIdFx:P,getArchiveFx:D,getViewersFx:B,getRepliesFx:L,getQuestionsFx:M,getStatsFx:C,getDetailedStatsFx:U,markSkippedFx:V,markNotInterestedFx:H,markSeenFx:$,hidePrivacyBlockFx:Q,deleteFx:Y,askQuestionFx:z,deleteQuestionFx:j,banQuestionAuthorFx:W,unbanQuestionAuthorFx:q,markAppNotificationsSeenFx:K,subscribeUserToAppFx:X,getPhotoUploadServerFx:J,getVideoUploadServerFx:Z,saveFx:ee,searchFx:te,unbanOwnerFx:re,banOwnerFx:ie,setDiscoverVisibleFx:ae,hideReplyFx:se,hideAllRepliesFx:oe,friendsAddFx:ne,friendsDeleteFx:ce,groupsJoinFx:de,groupsLeaveFx:le}}},735369:(e,t,r)=>{r.d(t,{faveService:()=>S,narrativesService:()=>v,pollsService:()=>m,statsService:()=>f,storiesDomain:()=>p,storiesService:()=>_,userService:()=>g});var i=r(798116),a=r(332268),s=r(697227),o=r(683313),n=r(655555),c=r(105338),d=r(65856),l=r(527487),u=r(634167);const p=(0,i.createDomain)("stories"),_=(0,a.createStoriesService)({domain:p}),f=(0,s.createStatsService)({domain:p}),v=(0,o.createNarrativesService)({domain:p}),S=((0,n.createLikesService)({domain:p}),(0,c.createMessagesService)({domain:p}),(0,d.createFaveService)({domain:p})),m=(0,l.createPollsService)({domain:p}),g=(0,u.createUserService)({domain:p})},477932:(e,t,r)=>{function i(e){var t,r;return(null!=(r=null==(t=e)?void 0:t.split("_"))?r:[]).map(Number)}function a(e,t="windows-1251"){return new TextDecoder(t).decode(function(e){const t=atob(e);return Uint8Array.from(t,(e=>e.codePointAt(0)||0))}(e))}r.d(t,{decodeBase64:()=>a,splitStoryRawId:()=>i})},365035:(e,t,r)=>{r.d(t,{ADMIN_STORY_VIEW_MODULE:()=>s,BOX_ITEM_DRAGGABLE_CLASS:()=>p,EMOJI_REACTIONS_ARR:()=>o,INIT_MAX_FEEDBACK_STORIES_COUNT:()=>d,LONG_PRESS_DELAY_MS:()=>a,MAX_FEEDBACK_STORIES_SLICE_COUNT:()=>c,MAX_NARRATIVE_STORIES:()=>l,NARRATIVE_MAX_TITLE_LENGTH:()=>u,QUESTION_SELECT_MODE:()=>n,SCROLL_LOADING_MORE_GAP:()=>f,SCROLL_THROTTLE_DELAY:()=>_,STORIES_MANAGE_MODULE:()=>i});const i="stories_manage",a=200,s="admin_story_view",o=[{code:"f09f9882",name:"face_with_tears_of_happiness"},{code:"f09f988d",name:"smiling_face_with_heart_eyes"},{code:"f09f918df09f8fbf",name:"thumbs_up"},{code:"f09f98ad",name:"loud_crying_face"},{code:"f09f98b1",name:"face_screaming_in_fear"},{code:"e298ba",name:"smiling_face"}],n={PUBLIC:0,AUTHOR_ONLY:1,ANONYMOUS:3},c=50,d=10,l=100,u=23,p="NarrativeBox__draggable",_=34,f=400},964262:(e,t,r)=>{r.d(t,{createUserStackMaskIfNeeded:()=>k,fetchDiscover:()=>m,getGroupStoryManageRemoveData:()=>E,getStoryBlockKey:()=>h,getStoryList:()=>f,getVolume:()=>p,isDiscoverLoading:()=>g,isNewDesignEnabled:()=>y,preloadDiscoverList:()=>S,removeStoryList:()=>v,setVolume:()=>_});var i=r(517366),a=r(795558),s=r(839470),o=r(321850),n=r(69574),c=r(542313),d=r(584356),l=r(365035),u=r(29271);function p(){const e=window.ls.get("video_volume");return"number"==typeof e?Math.min(1,Math.max(0,e)):1}function _(e){window.ls.set("video_volume",e)}function f(e){return window.cur[`stories_list_${e}`]}function v(e){delete window.cur[`stories_list_${e}`]}function S(e=!1){if(window.cur.storiesDiscoverFetchingPromise)return window.cur.storiesDiscoverFetchingPromise;let t,r;const a=f(i.StoryListName.feed);return a&&(r=a.find((e=>e.type===i.StoryBlockType.discover)),r&&(t=r.track_code)),window.cur.storiesDiscoverFetchingPromise=m("",t,e).then((([e,t])=>(r&&(r.grouped=e,r.next_from=t),e))).finally((()=>{delete window.cur.storiesDiscoverFetchingPromise})),window.cur.storiesDiscoverFetchingPromise}function m(e="",t="",r=!1,a=15){if((0,n.isApiForVKCOMViewerEnabled)()){const s={count:a,startFrom:e,trackCode:t};return r&&(0,d.showBoxLoader)(),(0,c.fetchList)(i.StoryListName.discover,s).then((({list:e,nextFrom:t})=>[e,t])).finally((()=>{r&&(0,d.hideBoxLoader)()}))}return new Promise(((i,s)=>{window.ajax.post("al_stories.php",{act:"get_discover",start_from:e,count:a,track_code:t},{loader:r,onDone:(e,t)=>{i([e,t])},onFail:e=>(s(e),!0)})}))}function g(){return Boolean(window.cur.storiesDiscoverFetchingPromise)}function h(e){var t,r,i,a,s;return(null==(r=e)||null==(t=r.author)?void 0:t.id)&&(null==(a=e)||null==(i=a.narrative)?void 0:i.id)?`${e.author.id}narrative${null==(s=e.narrative)?void 0:s.id}`:`${e.id}`}function k(){const e="users_stack_stories_mask";let t=document.getElementById(e);t||(t=(0,a.se)(`\n        <svg width="0" height="0">\n          <defs>\n            <clipPath id="${e}">\n              <path transform="translate(1.5 0)" d="M1.20772 8C1.20772 6.32671 0.768742 4.75626 0 3.39821C1.44342 1.34278 3.8277 0 6.52463 0C10.9293 0 14.5 3.58172 14.5 8C14.5 12.4183 10.9293 16 6.52463 16C3.8277 16 1.44342 14.6572 0 12.6018C0.768742 11.2437 1.20772 9.6733 1.20772 8Z"></path>\n            </clipPath>\n          </defs>  \n        </svg>  \n      `),t&&(document.body.appendChild(t),(0,o.pushNavDestroy)((()=>{var e;null==(e=t)||e.remove()}))))}function y(){return(0,s.partConfigEnabled)("story_reactions_sending_feature_web")}function E(e){if(e&&e.can_manage&&window.cur.module===l.STORIES_MANAGE_MODULE){const t=Math.floor(Date.now()/1e3);return{rawId:e.raw_id,deleter:window.vk.id,deletionDate:t,deletionDateString:(0,u.getSmDate)(t)}}}},69574:(e,t,r)=>{r.d(t,{isActsToApi2ForVKCOMViewerEnabled:()=>o,isActsToApiFirstForVKCOMViewerEnabled:()=>s,isApiForVKCOMViewerEnabled:()=>a});var i=r(839470);function a(){return(0,i.partConfigEnabled)("stories_web_api")}function s(){return(0,i.partConfigEnabled)("stories_web_acts_to_api_1")}function o(){return(0,i.partConfigEnabled)("stories_web_acts_to_api_2")}},492269:(e,t,r)=>{r.d(t,{FriendsFriendStatusStatusEnumNames:()=>i});const i={NOT_A_FRIEND:0,OUTCOMING_REQUEST:1,INCOMING_REQUEST:2,IS_FRIEND:3}},386694:(e,t,r)=>{r.d(t,{clearStoriesLoadingStats:()=>v,clearStoriesNavigationStats:()=>l,getConnectionType:()=>o,getStoriesLoadingStats:()=>f,getStoriesNavigationStats:()=>d,saveNavigationStatEvent:()=>c,saveViewerStartTime:()=>_,serializeLoadingStats:()=>S,serializeNavigationStats:()=>u});var i=r(659397),a=r(168298),s=r(477932);function o(){const{connection:e}=navigator;if(!e)return"";const{effectiveType:t,downlink:r}=e;switch(t){case"slow-2g":return"GPRS";case"2g":return"EDGE";case"3g":return"3G";case"4g":return r>8?"wi-fi":"LTE"}return""}let n=[];function c({storyRawId:e,source:t,action:r}){let i=0,o=0;e&&([i,o]=(0,s.splitStoryRawId)(e)),"reply"===t&&(t="replies_list");const c={e:a.STATS_EVENT_TYPE_STORIES_VIEWER_NAVIGATION,owner_id:i,story_id:o,source:t,action:r};n.push(c)}function d(){return(0,i.isArray)(n)?n:[]}function l(){n=[]}function u(){const e=n.map((({owner_id:e,story_id:t,source:r,action:i})=>[e,t,r,i].join(","))).join(";");return n=[],e}let p=[];function _({storyRawId:e,source:t,time:r}){const[i,n]=(0,s.splitStoryRawId)(e),c={e:a.STATS_EVENT_TYPE_STORIES_VIEWING_START_TIME,owner_id:i,story_id:n,source:t,time:r,internet_type:o()};p.push(c)}function f(){return(0,i.isArray)(p)?p:[]}function v(){p=[]}function S(){const e=p.map((({owner_id:e,story_id:t,source:r,time:i})=>[e,t,r,i].join(","))).join(";");return p=[],e}},771611:(e,t,r)=>{r.d(t,{createFriendsAddFx:()=>c,createFriendsAddListFx:()=>_,createFriendsDeleteBulkFx:()=>l,createFriendsDeleteFx:()=>d,createFriendsDeleteListFx:()=>f,createFriendsDeleteSubscriberFx:()=>m,createFriendsEditListFx:()=>v,createFriendsGetCountersFx:()=>k,createFriendsGetFollowersFx:()=>g,createFriendsGetFriendsDeletionSuggestionsFx:()=>o,createFriendsGetFx:()=>s,createFriendsGetListsFx:()=>a,createFriendsGetOnlineFx:()=>p,createFriendsGetRecommendationsFx:()=>n,createFriendsGetRequestsFx:()=>u,createFriendsRequestsToSubscribersFx:()=>h,createFriendsSearchFx:()=>S});var i=r(972051);const a=e=>(0,i.createApiEffect)("friends.getLists",e),s=e=>(0,i.createApiEffect)("friends.get",e),o=e=>(0,i.createApiEffect)("friends.getFriendsDeletionSuggestions",e),n=e=>(0,i.createApiEffect)("friends.getRecommendations",e),c=e=>(0,i.createApiEffect)("friends.add",e),d=e=>(0,i.createApiEffect)("friends.delete",e),l=e=>(0,i.createApiEffect)("friends.deleteBulk",e),u=e=>(0,i.createApiEffect)("friends.getRequests",e),p=e=>(0,i.createApiEffect)("friends.getOnline",e),_=e=>(0,i.createApiEffect)("friends.addList",e),f=e=>(0,i.createApiEffect)("friends.deleteList",e),v=e=>(0,i.createApiEffect)("friends.editList",e),S=e=>(0,i.createApiEffect)("friends.search",e),m=e=>(0,i.createApiEffect)("friends.deleteSubscriber",e),g=e=>(0,i.createApiEffect)("friends.getFollowers",e),h=e=>(0,i.createApiEffect)("friends.requestsToSubscribers",e),k=e=>(0,i.createApiEffect)("friends.getCounters",e)},29260:(e,t,r)=>{r.d(t,{formatCount:()=>i});const i=(e,t)=>{var r,i,a,s,o,n,c;const d=(null==(r=t)?void 0:r.separator)||".";var l;const u=null!=(l=null==(i=t)?void 0:i.maximumFractionDigits)?l:1,p=(null==(a=t)?void 0:a.roundingMode)||void 0,_=(null==(s=t)?void 0:s.kLimit)||1e3,f=(null==(o=t)?void 0:o.mLimit)||1e6,v=(null==(n=t)?void 0:n.bLimit)||1e9,S=(null==(c=window.langConfig)?void 0:c.locale)||"ru",m=(e,t)=>{"floor"===p&&(e=Math.floor(e*Math.pow(10,u))/Math.pow(10,u));let r=e.toFixed(u);return Number(r).toLocaleString(S).replace(/\./,d)+t};if(e>-_&&e<_)return e.toLocaleString(S);const g=e/v;if(g>=1||g<=-1)return m(e/1e9,"B");const h=e/f;if(h>=1||h<=-1)return m(e/1e6,"M");const k=e/_;return k>=1||k<=-1?m(e/1e3,"K"):String(e)}}}]);try{stManager.done("dist/web/chunks/aee1802d.83d36a53.js")}catch(e){}