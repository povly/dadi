/*! For license information please see de31987e.5a7c0ba1.js.LICENSE.txt */
"use strict";(self.webpackChunkvkweb=self.webpackChunkvkweb||[]).push([[51587],{29157:(e,t,n)=>{n.d(t,{Icon20CheckCircleOff:()=>o});var o=(0,n(28178).makeIcon)("Icon20CheckCircleOff","check_circle_off_20","0 0 20 20",'<symbol xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="none" viewBox="0 0 20 20" id="check_circle_off_20"><defs><path id="check_circle_off_20_a" fill="currentColor" fill-rule="evenodd" d="M10 20c5.523 0 10-4.477 10-10S15.523 0 10 0 0 4.477 0 10s4.477 10 10 10m0-1a9 9 0 1 0 0-18 9 9 0 0 0 0 18" clip-rule="evenodd" /></defs><use xlink:href="#check_circle_off_20_a" fill-rule="evenodd" clip-rule="evenodd" /><use xlink:href="#check_circle_off_20_a" fill-rule="evenodd" clip-rule="evenodd" /></symbol>',20,20,!1,void 0)},385228:(e,t,n)=>{n.d(t,{Icon20More:()=>o});var o=(0,n(28178).makeIcon)("Icon20More","more_20","0 0 20 20",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20" id="more_20"><path fill="currentColor" d="M15 8.5a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3m-5 0a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3m-5 0a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3" /></symbol>',20,20,!1,void 0)},540246:(e,t,n)=>{n.d(t,{Icon56CommentsOutline:()=>o});var o=(0,n(28178).makeIcon)("Icon56CommentsOutline","comments_outline_56","0 0 56 56",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 56 56" id="comments_outline_56"><path fill="currentColor" d="m27.234 42.143.965 1.149zm-10.09 8.477-.966-1.149zM8.5 15a1.5 1.5 0 0 0 0-3zm20.895 20.672-.965 1.148zm9.462 7.948.965-1.149zM5 36.5v-18H2v18zm9.5 3.5h-6v3h6zm2.5 9.854V42.5h-3v7.354zm9.27-8.86-10.092 8.477 1.93 2.297 10.091-8.476zm1.93 2.298c.223-.189.507-.292.8-.292v-3c-.999 0-1.966.352-2.73.995zM14 49.854c0 2.124 2.482 3.28 4.108 1.914l-1.93-2.297a.5.5 0 0 1 .822.383zM14.5 43a.5.5 0 0 1-.5-.5h3a2.5 2.5 0 0 0-2.5-2.5zM2 36.5A6.5 6.5 0 0 0 8.5 43v-3A3.5 3.5 0 0 1 5 36.5zm3-18A3.5 3.5 0 0 1 8.5 15v-3A6.5 6.5 0 0 0 2 18.5zM46.5 5h-28v3h28zM12 11.5v18h3v-18zm41 18v-18h-3v18zM41.5 36h5v-3h-5zm.5 6.854V35.5h-3v7.354zM18.5 36h7.679v-3H18.5zm9.93.82 9.462 7.948 1.93-2.297-9.463-7.948zM26.179 36a3.5 3.5 0 0 1 2.25.82l1.93-2.297A6.5 6.5 0 0 0 26.18 33zM39 42.854a.5.5 0 0 1 .822-.383l-1.93 2.297c1.626 1.366 4.108.21 4.108-1.914zM41.5 33a2.5 2.5 0 0 0-2.5 2.5h3a.5.5 0 0 1-.5.5zm8.5-3.5a3.5 3.5 0 0 1-3.5 3.5v3a6.5 6.5 0 0 0 6.5-6.5zm-38 0a6.5 6.5 0 0 0 6.5 6.5v-3a3.5 3.5 0 0 1-3.5-3.5zM18.5 5a6.5 6.5 0 0 0-6.5 6.5h3A3.5 3.5 0 0 1 18.5 8zm28 3a3.5 3.5 0 0 1 3.5 3.5h3A6.5 6.5 0 0 0 46.5 5z" /></symbol>',56,56,!1,void 0)},952464:(e,t,n)=>{n.d(t,{default:()=>o});const o={scroll:"VideoChat-module__scroll--1zGsq",in:"VideoChat-module__in--qeyRv"}},878371:(e,t,n)=>{n.d(t,{default:()=>o});const o={button:"VideoChatHideButton-module__button--URjJQ"}},137363:(e,t,n)=>{n.d(t,{ANALYTICS_SCREEN_OTHER:()=>s,ANALYTICS_SCREEN_SETTINGS:()=>i,GroupAdminLevel:()=>o});const o={USER:0,MODERATOR:1,EDITOR:2,ADMINISTRATOR:3,HOST:4,EVENT_CREATOR:5,CREATOR:6,PSEUDO_LEVEL_ADVERTISER:100},i="settings",s="other"},789222:(e,t,n)=>{n.d(t,{StickerManager:()=>r});var o=n(664988),i=n(211314),s=n(653870);class r{add(e,t=!1){if(this.stickers.length>8)return;const n=new Image;n.onload=()=>{this.stickers.push({img:n,id:e,x:t?this.likeStartX:this.stickerStartX,y:t?this.startY-60:this.startY,isLike:t,startTime:Date.now()+(0,o.irand)(0,600),speed:(0,o.irand)(2,3),size:t?20:64,scale:t?2:1,opacity:t?.8:0,rotateDegree:(0,o.irand)(0,4),rotateDirection:Math.random()<.5?-1:1}),this.drawNextFrame()},n.src=t?"data:image/svg+xml; charset=utf8, "+encodeURIComponent((0,s.getIcon20LikeCircleFillRed)().icon):i.Stickers.getStickerUrl(e,((0,o.isRetina)()?128:64)+"b")}drawSticker(e){if(e.startTime>Date.now()||!this.ctx)return;if(e.isLike&&(e.scale=2),e.y<=this.startY&&e.y>=this.startY-25){const t=e.opacity+.15;if(e.opacity=Math.min(t,1),!e.isLike){const t=e.scale+.04;e.scale=Math.min(t,1)}}else if(e.y>=this.endY&&e.y<=this.endY+25){const t=e.opacity-.15;e.opacity=Math.max(t,0)}const t=e.size*e.scale,n=1===e.scale?e.x:e.x+(e.size-t)/2;e.rotateDegree+=.1*e.rotateDirection,e.rotateDegree<0?(e.rotateDegree=0,e.rotateDirection*=-1):e.rotateDegree>4&&(e.rotateDegree=4,e.rotateDirection*=-1),e.y-=e.speed,this.ctx&&(this.ctx.globalAlpha=e.opacity),this.ctx.setTransform(e.scale,0,0,e.scale,n,e.y),this.ctx.rotate(e.rotateDegree*Math.PI/180),this.ctx.drawImage(e.img,n,e.y),this.ctx&&(this.ctx.globalAlpha=1)}drawNextFrame(){this.isRendering||(this.isRendering=!0,this.rAF=requestAnimationFrame(this.animate))}destroy(){this.rAF&&(cancelAnimationFrame(this.rAF),this.rAF=null)}constructor(e){this.stickers=[],this.endY=32,this.isRendering=!1,this.scaleRatio=1,this.animate=()=>{this.ctx&&(this.ctx.resetTransform(),this.ctx.clearRect(0,0,this.canvasWidth*this.scaleRatio,this.canvasHeight*this.scaleRatio),this.stickers=this.stickers.filter((e=>e.y>this.endY)),this.stickers.forEach((e=>{this.drawSticker(e)})),this.isRendering=!1,this.stickers.some((e=>e.y>this.endY))?this.drawNextFrame():(this.ctx.resetTransform(),this.ctx.clearRect(0,0,this.canvasWidth*this.scaleRatio,this.canvasHeight*this.scaleRatio)))},this.ctx=e.getContext("2d"),this.canvasWidth=e.width,this.canvasHeight=e.height,this.stickerStartX=(this.canvasWidth-64)/2,this.likeStartX=this.canvasWidth-20-20,this.startY=this.canvasHeight-64,this.ctx&&(0,o.isRetina)()&&(this.scaleRatio=window.devicePixelRatio||1,this.ctx.canvas.width=this.canvasWidth*this.scaleRatio,this.ctx.canvas.height=this.canvasHeight*this.scaleRatio,this.ctx.canvas.style.width=`${this.canvasWidth}px`,this.ctx.canvas.style.height=`${this.canvasHeight}px`,this.ctx.scale(this.scaleRatio,this.scaleRatio))}}},918956:(e,t,n)=>{n.d(t,{VideoChat:()=>_});var o=n(785893),i=n(667294),s=n(906811),r=n(540246),a=n(354768),l=n(869048),c=n(331533),d=n(659397),u=n(86894),h=n(952464),m=n(29271),p=n(66450),g=n(338448),f=n(968986);const _=({messages:e})=>{const[t,n]=(0,i.useState)((0,d.decodeHTMLEntitiesDeep)(e)),[_,v]=(0,i.useState)(!1),[w,y]=(0,i.useState)(!1),S=(0,i.useRef)(null),E=e=>{e.scrollToIndex(1e3,{align:"end",behavior:"auto"}),y(!1),v(!1)},k=(0,s.useVirtualizer)({count:t.length,estimateSize:()=>36,getScrollElement:()=>S.current,onChange:e=>{const{isScrolling:t,scrollDirection:n,getTotalSize:o,scrollElement:i}=e;if(!i)return;const s=o(),r=i.clientHeight+i.scrollTop+30<s;w&&r&&window.VideoChat.toggleScrollBottomBtn(!0),t&&"backward"===n&&i.clientHeight+i.scrollTop!==s?v(!0):(i.clientHeight+i.scrollTop===s&&(v(!1),y(!1),window.VideoChat.toggleScrollBottomBtn(!1)),_||E(k))}});if((0,i.useEffect)((()=>{const e=e=>{const{eventType:o}=e.detail;switch(o){case p.CustomEventType.NEW_MESSAGES:const o=(0,d.decodeHTMLEntitiesDeep)(e.detail.data);n((e=>{let t=[...e,...o];t=(0,f.removeDuplicateById)(t);const n=Math.max(t.length-50,0);return n>0&&(t=t.slice(n)),t})),y(!0);break;case p.CustomEventType.DELETE_MESSAGE:const i=e.detail.data,s=t.findIndex((e=>e.id===i));if(-1!==s){let e=t;e.splice(s,1),n(e),_||E(k)}break;case p.CustomEventType.SCROLL_BOTTOM:E(k)}};return window.addEventListener(p.CustomEventName,e),()=>{window.removeEventListener(p.CustomEventName,e)}}),[t,_]),(0,i.useEffect)((()=>{t.length&&E(k)}),[]),!t.length)return(0,o.jsxs)("div",{className:"mv_chat_first_message_intro",children:[(0,o.jsx)(r.Icon56CommentsOutline,{}),m.getLang("video_first_message_intro")]});const b=k.getVirtualItems();return(0,o.jsx)(l.AppRootProvider,{children:(0,o.jsx)(u.CustomScrollView,{boxRef:S,className:h.default.scroll,children:(0,o.jsx)("div",{className:h.default.in,style:{height:k.getTotalSize()},children:(0,o.jsx)("div",{style:{position:"absolute",top:0,left:0,width:"100%",transform:`translateY(${b[0].start}px)`},children:b.map((({key:e,index:n})=>{const{owner_href:i,owner_name:s,photo_url:r,is_verified:l,text:d,can_delete:u,can_report:h,can_pin:m}=t[n];return(0,o.jsxs)("div",{"data-index":n,ref:k.measureElement,className:"mv_chat_message",children:[(0,o.jsx)("a",{className:"mv_chat_message_author_thumb",href:i,target:"_blank",children:(0,o.jsx)("img",{loading:"lazy",className:"mv_chat_message_author_thumb_img",src:r})}),(0,o.jsxs)("div",{className:"mv_chat_message_content",children:[(0,o.jsxs)("a",{className:"mv_chat_message_author_name",href:i,target:"_blank",children:[s,l&&(0,o.jsx)("div",{className:"mv_page_verified",children:(0,o.jsx)(a.Icon12Verified,{})})]}),(0,o.jsx)(c.InnerHTML,{className:"mv_chat_message_text",Component:"div",children:d})]}),(u||m||h)&&(0,o.jsx)(g.VideoChatMessageActions,{message:t[n]})]},e)}))})})})})}},338448:(e,t,n)=>{n.d(t,{VideoChatMessageActions:()=>a});var o=n(785893),i=n(385228),s=n(29271),r=n(384627);const a=({message:e})=>{const{id:t,owner_id:n,author_id:a,owner_href:l,owner_name:c,is_verified:d,text:u,can_delete:h,can_report:m,can_pin:p,action_hash:g}=e;return(0,o.jsx)("div",{className:"mv_chat_message_actions",children:(0,o.jsx)(r.DropdownActionSheet,{placement:"bottom-start",content:(0,o.jsxs)(o.Fragment,{children:[p&&(0,o.jsx)(r.DropdownActionSheet.Item,{onClick:()=>{window.VideoChat.pinMessage(n,a,c,l,d,t,h,m,u)},children:s.getLang("video_pin_message")}),h&&(0,o.jsx)(r.DropdownActionSheet.Item,{onClick:()=>{window.VideoChat.deleteMessage(`${n}_${t}`,g)},children:s.getLang("global_delete")}),m&&(0,o.jsx)(r.DropdownActionSheet.Item,{onClick:()=>{window.VideoChat.showReportVideoChatCommentForm(n,t)},children:s.getLang("global_report_spam")})]}),children:(0,o.jsx)("div",{className:"mv_chat_message_action",children:(0,o.jsx)(i.Icon20More,{})})})})}},66450:(e,t,n)=>{n.d(t,{CustomEventName:()=>o,CustomEventType:()=>i});const o="VideoCustomEvent/CHAT_UPDATE";var i;!function(e){e.NEW_MESSAGES="NEW_MESSAGES",e.DELETE_MESSAGE="DELETE_MESSAGE",e.SCROLL_BOTTOM="SCROLL_BOTTOM"}(i||(i={}))},669844:(e,t,n)=>{n.d(t,{VideoChatHideButton:()=>d});var o=n(785893),i=n(667294),s=n(29271),r=n(659397),a=n(86894),l=n(869048),c=n(878371);const d=()=>{const e=(0,i.useCallback)((0,r.debounce)((e=>{var t,n;return null==(n=window.Videoview)||null==(t=n.toggleSideBlock)?void 0:t.call(n,e)}),100),[]);return(0,o.jsx)(l.AppRootProvider,{children:(0,o.jsx)(a.AppearanceProvider,{appearance:"dark",children:(0,o.jsx)("button",{className:c.default.button,onClick:e,id:"video_chat_hide_button",children:s.getLang("video_action_button_hide_chat")})})})}},631840:(e,t,n)=>{n.d(t,{VideoChatHideButtonComponent:()=>l});var o=n(293579),i=n(669844),s=n(243859);const r="VideoChatHideButton";let a;const l={init:function(){(0,o.getReactRootEl)(r)&&(a=(0,s.createReactInitiator)(i.VideoChatHideButton,(0,o.getReactRootEl)(r)),a.render({}))},destroy:function(){var e,t;null==(t=a)||null==(e=t.unmount)||e.call(t)}}},872207:(e,t,n)=>{n.d(t,{VideoChatComponent:()=>a});var o=n(293579),i=n(918956),s=n(243859);let r;const a={init:function(e){r=(0,s.createReactInitiator)(i.VideoChat,(0,o.getReactRootEl)("VideoChat")),r.render(e)},destroy:function(){var e;null==(e=r)||e.unmount()}}},640445:(e,t,n)=>{n.d(t,{APP_NAME:()=>o,PinnedMessageComponent:()=>i});const o="PinnedMessage";const i={init:function(e){window.initReactApplication(o,e||{})}}},821103:(e,t,n)=>{n.d(t,{getMsgElement:()=>o});const o=(e,t)=>document.querySelector(`#mv_chat_msg${e}_${t}`)},618337:(e,t,n)=>{function o(){return{icon:'<svg fill="none" height="16" viewBox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"><path d="M4.5 9.59 2.96 8.04a1 1 0 0 0-1.42 1.42L3.8 11.7a1 1 0 0 0 1.42 0l5.25-5.25a1 1 0 0 0-1.42-1.42z" fill="currentColor"/></svg>',name:"verified_12"}}n.d(t,{getIcon12Verified:()=>o})},653870:(e,t,n)=>{function o(){return{icon:'<svg fill="none" height="20" viewBox="0 0 20 20" width="20" xmlns="http://www.w3.org/2000/svg"><linearGradient id="like_circle_fill_red_20__a" gradientUnits="userSpaceOnUse" x1="-10" x2="10" y1="10" y2="30"><stop offset="0" stop-color="#ff5263"/><stop offset="1" stop-color="#ff3347"/></linearGradient><path d="M0 10a10 10 0 1 1 20 0 10 10 0 0 1-20 0z" fill="url(#like_circle_fill_red_20__a)"/><path d="M12.2 6.5c1.55 0 2.8 1.2 2.8 2.7 0 1.5-.63 2.24-3.28 4.23l-1.2.9a.86.86 0 0 1-1.03 0l-1.21-.9C5.63 11.44 5 10.69 5 9.19 5 7.7 6.25 6.5 7.8 6.5c.83 0 1.55.4 2.2 1.15.65-.75 1.37-1.15 2.2-1.15z" fill="#fff"/></svg>',name:"like_circle_fill_red_20"}}n.d(t,{getIcon20LikeCircleFillRed:()=>o})},211314:(e,t,n)=>{n.d(t,{Stickers:()=>s});var o=n(68003),i=n(404145);const s={getStickerUrl:function(e,t){let n=String(t);if(o.colorScheme.isDarkScheme()&&(n=n.replace(/b$/,"")+"b"),window.Emoji){var s,r,a;const t=null==(a=Emoji.stickersById)||null==(r=a[e])||null==(s=r.sticker[Emoji.STICKER_FIELD_IMAGES])?void 0:s[n];if(t)return t}const l={id:e,size:n};if((0,i.isMvk)()){if(window.stickers_cache){const t=window.stickers_cache.getStickerImage(e,n);if(t)return t}return window.store.stickers&&window.rs(window.store.stickers.url_template,{id:e,size:n})}return window.getTemplate("stickers_sticker_url",l)}}},809915:(e,t,n)=>{n.r(t),n.d(t,{VideoChat:()=>C});var o=n(795558),i=n(664988),s=n(96756),r=n(953908),a=n(82161),l=n(320422),c=n(821311),d=n(965109),u=n(29271),h=n(137363),m=n(618337),p=n(599809),g=n(839470),f=n(640445),_=n(821103),v=n(931917),w=n(789222),y=n(872207),S=n(66450),E=n(75272),k=n(631840),b=n(659397);const C={SCROLL_EDGE_BELOW_THRESHOLD:20,MAX_COMMENTS_NUM:50,MAX_LIKES_PER_BATCH:5,MAX_STICKERS_PER_BATCH:5,init(e,t){if(C.block&&C.destroy(),e){if(C.block=e,C.options=(0,a.extend)({},t),C.messagesWrap=(0,o.domByClass)(e,"mv_chat_messages_wrap"),C.stickersWrap=(0,o.domByClass)(e,"mv_chat_stickers_wrap"),t.chatRefactoring?(y.VideoChatComponent.init({messages:t.messageData}),this.prefersReducedMotion=window.matchMedia("(prefers-reduced-motion: reduce)").matches):C.scroll=new uiScroll((0,o.domFC)(C.messagesWrap),{global:!0,hidden:t.scrollHidden,reversed:!0,preserveEdgeBelow:!0,preserveEdgeBelowThreshold:C.SCROLL_EDGE_BELOW_THRESHOLD,theme:"videoview",onupdate:C.onScrollUpdate}),this.scrollBottomBtnWrap=(0,o.domByClass)(e,"mv_chat_new_messages_btn_wrap"),C.replyForm=(0,o.domByClass)(e,"mv_chat_reply_form"),C.replyForm&&(C.replyInput=(0,o.domByClass)(e,"mv_chat_reply_input"),C.initReplyInput()),C.firstMsgIntro=(0,o.domByClass)(e,"mv_chat_first_message_intro"),(0,g.partConfigEnabled)("video_live_chat_hide_button_enabled")){const t="chat_hide_button_enabled";[C.messagesWrap,C.replyForm].forEach((e=>{var n;return null==(n=e)?void 0:n.classList.add(t)})),k.VideoChatHideButtonComponent.init(),C.chatHideButton=e.querySelector("#video_chat_hide_button")}var n;if(t.stickerRefactoring)null==(n=C.stickerManager)||n.destroy(),C.stickerManager=null,C.stickersCanvasWrap=null}},initReplyInput(){(0,s.placeholderInit)(C.replyInput,{editable:!0,global:!0}),window.stManager.add([window.jsc("web/emoji.js"),"notifier.css"],(function(){const e=Emoji.init(C.replyInput,{forceStickerPack:C.options.forceStickerPack,controlsCont:C.replyForm,noLineBreaks:1,noCtrlSend:1,noStickers:!!C.options.noStickers,ref:"video_chat",onSend:function(){C.sendMessage()},checkEditable:function(){C.checkFormHeight(),C.checkTextLen()},onStickerSend:function(e){C.sendSticker(e)}});(0,o.data)(C.replyForm,"optId",e)}))},checkFormHeight(){const e=C.replyForm;let t=e.offsetHeight;if((0,g.partConfigEnabled)("video_live_chat_hide_button_enabled")&&C.chatHideButton){t+=C.chatHideButton.offsetHeight}if(e.lastHeight===t)return;if(e.lastHeight=t,(0,o.setStyle)(C.messagesWrap,{bottom:t+"px"}),C.options.chatRefactoring)return;!C.scroll.data.scrollBottom&&C.scroll.scrollBottom()},checkTextLen(e=C.replyInput){const t=(0,a.trim)(Emoji.editableVal(e));if(e.lastLen===t.length)return;if((e.lastLen=t.length)>mvcur.maxChatReplyLength){const t=cur.storyLayer?u.getLang("stories_live_chat_msg_too_long"):u.getLang("video_live_chat_msg_too_long");(0,l.showTooltip)(e,{black:1,text:t,shift:!!cur.storyLayer&&[-30,10]})}else window.tooltips&&tooltips.destroy(e)},stickerClick:(e,t,n)=>(window.stManager.add([window.jsc("web/emoji.js"),"notifier.css"],(function(){Emoji.clickSticker(e,t,n)})),!1),onScrollUpdate(e){C.options.chatRefactoring||e.data.scrollBottom<C.SCROLL_EDGE_BELOW_THRESHOLD&&C.toggleScrollBottomBtn(!1)},getMessageAccessFlags(e,t){const{adminLevel:n,canDeleteComments:o,canPinComments:i}=Videoview.getMvData(),s=n>h.GroupAdminLevel.USER;let r=!1;window.replyAsList&&window.replyAsList.length&&(r=window.replyAsList.some((e=>e[0]===t)));return{canDeleteComment:s||!!o||e==vk.id||t==vk.id||r,canReportComment:e!=t&&t!=vk.id&&!r,canPinComment:!!i}},receiveMessage(e,t,n,o,i,s,r,l,c,d,u){if((0,a.intval)(c))return void C.appendSticker(c,n);const{canDeleteComment:h,canReportComment:p,canPinComment:f}=C.getMessageAccessFlags(e,n);if(C.options.chatRefactoring)return void C.appendMessageRefactoring({id:t,owner_id:Number(e),text:l,owner_href:s,photo_url:i,is_verified:u,owner_name:o,can_delete:!!h,can_report:!!p,can_pin:!!f,action_hash:C.options.chatActionHash});let _="";(0,g.partConfigEnabled)("video_live_pinned_message")&&f?_+=(0,a.getTemplate)("video_chat_message_actions_menu",{owner_id:e,author_id:n,author_name:o,author_href:s,author_verified:!!u,comment_id:t,show_delete:!!h,show_report:!!p}):(p&&(_+=(0,a.getTemplate)("video_chat_message_action_report",{video_owner_id:e,msg_id:t})),h&&(_+=(0,a.getTemplate)("video_chat_message_action_del",{video_owner_id:e,msg_id:t})));let v=o;u&&(v+='<div class="mv_page_verified">'+(0,m.getIcon12Verified)().icon+"</div>");const w=(0,a.getTemplate)("video_chat_message",{author_href:s,author_photo:i,author_name:v,message:l,video_owner_id:e,msg_id:t,actions:_,classes:n==e?"mv_chat_admin_message":""});C.appendMessage(w,t)},receiveDelete(e,t){if(C.options.chatRefactoring)return void C.sendCustomEvent(S.CustomEventType.DELETE_MESSAGE,t);const n="#mv_chat_msg"+mvcur.mvData.oid+"_"+t;let i=C._messagesBatch&&C._messagesBatch.querySelector(n);i?i.remove():(i=C.messagesWrap.querySelector(n),i&&!(0,o.hasClass)(i,"_deleted")&&C.scroll.updateBelow((function(){i.remove()})))},checkStickerFlood(e,t){const n=mvcur.queueBatchId;C._stickersLimits&&C._stickersLimits.batch==n||(C._stickersLimits={batch:n,like:0,sticker:0},C._stickersDelay=0);const o="like"==e?"like":"sticker",i="like"==o?C.MAX_LIKES_PER_BATCH:C.MAX_STICKERS_PER_BATCH;return!(++C._stickersLimits[o]>i&&t!=vk.id)},appendSticker(e,t,n=!0){if(!C.isHidden()&&!Videoview.isFS&&"hidden"!=document.visibilityState&&"animation"in document.body.style&&"onanimationend"in window&&!this.prefersReducedMotion){if(t==vk.id){const t=C.recentlySentSticker;if(t&&t.stickerId==e&&t.fromQueue!=n&&Date.now()-t.time<3e3)return;C.recentlySentSticker={stickerId:e,fromQueue:n,time:Date.now()}}else if(!C.checkStickerFlood(e,t))return;if(C.options.stickerRefactoring){if(!C.stickersCanvasWrap){const e=document.createElement("canvas");e.width=100,e.height=320,e.classList.add("mv_chat_stickers_wrap");const t=document.querySelector(".videoplayer")||document.querySelector(".LiveWebPlayer__content");t&&(t.append(e),C.stickersCanvasWrap=e)}return C.stickerManager=C.stickerManager||new w.StickerManager(C.stickersCanvasWrap),void C.stickerManager.add(e,"like"==e)}if("like"==e){const e=(0,o.ce)("div",{className:"mv_chat_like"});s(e),(0,r.addEvent)(e,"animationend",c),l(e)}else{const t=(0,o.ce)("img",{className:"mv_chat_sticker",src:Stickers.getStickerUrl(e,((0,i.isRetina)()?128:64)+"b")});s(t),(0,r.addEvent)(t,"error animationend",c),(0,r.addEvent)(t,"load",l)}}function s(e){let n="",s=0,r=0,l=0,c=(0,a.intval)((C.getHeight()-80)/6);for(let e=0;e<=100;e+=20){e>0&&(s+=(0,i.irand)(-4,4),r-=c,l+=(0,i.irand)(-4,4),c=(0,a.intval)(.9*c));n+=`\n          ${e}% {\n            transform: translate(${s}px, ${r}px) rotate(${l}deg) scale(${e?1:.7});\n            opacity: ${0==e||100==e?0:1};\n          }\n        `}const d="mv_chat_sticker_animation_"+Date.now()+"_"+(0,i.irand)(0,1e9);n=`@keyframes ${d} {${n}}`,e.appendChild((0,o.ce)("style",{innerHTML:n}));const u=(0,i.irand)(1500,2500)+"ms",h=(t==vk.id?0:C._stickersDelay+=100)+"ms";(0,o.setStyle)(e,{animation:[d,u,h,"linear"].join(" ")})}function l(e){const t=e.currentTarget||e;(C._stickersBatch||(C._stickersBatch=document.createDocumentFragment())).appendChild(t),C._appendStickerTimeout||(C._appendStickerTimeout=setTimeout((function(){C.appendStickersBatch(),C._appendStickerTimeout=null}),0))}function c(e){const t=e.currentTarget||e;(0,r.removeEvent)(t),t.remove()}},appendStickersBatch(){var e;const t=C._stickersBatch;if(t&&(C._stickersBatch=null,!C.isHidden())){if(!C.stickersWrap){const e=document.createElement("div");e.classList.add("mv_chat_stickers_wrap");const t=document.querySelector(".videoplayer");t&&(t.append(e),C.stickersWrap=e)}null==(e=C.stickersWrap)||e.appendChild(t)}},removeStickers(){if(C.stickersWrap)for(let e;e=(0,o.domFC)(C.stickersWrap);)(0,r.removeEvent)(e),e.remove()},appendMessageRefactoring(e){C.isHidden()||window.Videoview.isFS||"hidden"===document.visibilityState||(C._messagesBatchData=C._messagesBatchData||[],C._messagesBatchData.push(e),C._messagesBatchData.length>C.MAX_COMMENTS_NUM&&(C._messagesBatchData=C._messagesBatchData.slice(Math.max(C._messagesBatchData.length-C.MAX_COMMENTS_NUM,0))),C._appendMessageTimeout||(C._appendMessageTimeout=setTimeout((()=>{C.sendCustomEvent(S.CustomEventType.NEW_MESSAGES,C._messagesBatchData),C._messagesBatchData=[],C._appendMessageTimeout=null}),0)))},sendCustomEvent(e,t={}){window.dispatchEvent(new CustomEvent(S.CustomEventName,{detail:{eventType:e,data:t}}))},appendMessage(e,t){const n=C._messagesBatch||(C._messagesBatch=document.createDocumentFragment()),o="#mv_chat_msg"+mvcur.mvData.oid+"_"+t;if(C.messagesWrap.querySelector(o)||n.querySelector(o))return;const i=(0,E.createElementFromHTML)(e);[...i.querySelectorAll(".mv_chat_message_show_action_false")].forEach((e=>{e.parentNode.removeChild(e)})),n.appendChild(i);const s=n.childNodes;for(;n.childNodes.length>C.MAX_COMMENTS_NUM;)s[0].remove();C.isHidden()||C._appendMessageTimeout||(C._appendMessageTimeout=setTimeout((function(){C.appendMessagesBatch(),C._appendMessageTimeout=null}),0))},appendMessagesBatch(){if(C.isHidden()||window.Videoview.isFS||"hidden"===document.visibilityState)return;const e=C._messagesBatch;if(!e)return;if(C._messagesBatch=null,C.firstMsgIntro&&(C.firstMsgIntro.remove(),C.firstMsgIntro=null),C.options.chatRefactoring)return;const t=C.scroll.content,n=t.childNodes;let o=t.childNodes.length+e.children.length-C.MAX_COMMENTS_NUM;if(n.length&&o>0)for(;o>0;)n[0].remove(),o--;C.scroll.updateBelow((function(){t.appendChild(e)})),C.scroll.data.scrollBottom>100&&C.toggleScrollBottomBtn(!0)},toggleScrollBottomBtn(e){(0,o.toggleClass)(this.scrollBottomBtnWrap,"hidden",!e)},scrollBottom(){if(C.options.chatRefactoring)return window.VideoChat.sendCustomEvent(S.CustomEventType.SCROLL_BOTTOM),void window.VideoChat.toggleScrollBottomBtn(!1);C.scroll.scrollBottom(0)},replyAsAnimate(e,t,n){const i=e&&(0,o.geByClass1)("mv_chat_reply_author_photo",e),s=i&&(0,o.geByClass)("mv_chat_reply_author_photo_img",i),r=(0,o.hasClass)(e,"mv_chat_author_secondary")?0:1;s&&s[r]&&(s[r].src=n),(0,o.toggleClass)(e,"mv_chat_author_secondary")},replyAsGroup(e,t){window.replyAsList?C.replyAsGroupTT(e,t):(window.replyAsList=[],window.replyAsData={},(0,o.domData)(e,"can_reply_as_any_group")?ajax.post("/al_groups.php?act=get_editor_clubs",{},{cache:1,onDone:function(n){window.replyAsList=n,(0,a.each)(n,(function(e,[t,n,o,i]){window.replyAsData[t]=this})),C.replyAsGroupTT(e,t)}}):C.replyAsGroupTT(e,t))},replyAsGroupList(e,t,n){const i=[n];let s=(0,o.domByClass)(e,"mv_chat_reply_group_data");if(s){let e=[(0,o.domData)(s,"group_id"),(0,o.domData)(s,"group_photo"),(0,o.domData)(s,"group_href"),(0,o.domData)(s,"group_name")];i.push(e),window.replyAsData[e[0]]=e}return(0,a.each)(window.replyAsList,(function(e,[n,o,s,r]){n!=t&&i.push(this)})),i},replyAsGroupOver(e){const t=(0,o.gpeByClass)("mv_chat_reply_form",e);(0,l.showTooltip)(e,{text:function(){return(0,o.domData)(t,"from-oid")<0?u.getLang("global_on_behalf_group"):u.getLang("global_on_behalf_me")},black:1,shift:[9,8,8]})},replyAsGroupTT(e,t){const n=C.replyAsProfileData(),i=(0,o.gpeByClass)("mv_chat_reply_form",e),s=i&&(0,o.domData)(i,"from-oid");let l=(0,o.data)(e,"tt");if(!n)return!1;if(!l){const i=C.replyAsGroupList(e,t,n);let c="";(0,a.each)(i,(function(e,[t,n,o,i]){c+=(0,a.getTemplate)("video_chat_message_author_select_row",{author_id:t,author_href:o,author_photo:n,author_name:(0,b.decodeHTMLEntities)((0,b.encodeHTMLEntities)((0,b.escape)(i))),classes:s==t?" active":""})})),l=new ElementTooltip(e,{content:'<div class="post_from_tt_choose _post_scroll_wrap">'+c+"</div>",appendToParent:!0,autoHide:!0,customShow:!0,defaultSide:"top",offset:function(){return[0,-5]},onFirstTimeShow:function(t){const n=(0,o.geByClass)("post_from_tt_row",t);(0,a.each)(n,(function(t,n){(0,r.addEvent)(n,"click",C.setReplyAsGroup.pbind(e,{from:(0,o.domData)(this,"from-oid")}))})),this.rows=n,this.scroll=new uiScroll((0,o.geByClass1)("_post_scroll_wrap",t)),setTimeout((function(){l.scroll.update(),l.updatePosition()}),0)},onShow:function(e){setTimeout((function(){if(!l.scroll)return;const t=(0,o.geByClass1)("active",e),n=t?t.offsetTop-(l.scroll.data.viewportHeight-(0,o.getSize)(t)[1])/2:0;l.scroll.scrollTop(n)}),0)},onHide:function(e){}}),(0,o.data)(e,"tt",l)}t&&l.isShown()&&C.setReplyAsGroup(e,{from:s==vk.id?t:vk.id}),e.tt&&e.tt.hide&&e.tt.hide(),l.isShown()||l.show()},replyAsProfileData:()=>window.mvcur&&mvcur.wallTpl&&mvcur.wallTpl.profileData,setReplyAsGroup(e,t){if(!e)return!1;const n=(0,o.domClosest)("mv_chat_reply_form",e),i=(0,o.data)(e,"tt"),s=t.from||(t.fromGroup?cur.oid:vk.id),r=s==vk.id?C.replyAsProfileData():window.replyAsData&&window.replyAsData[s];return!((0,o.domData)(n,"from-oid")==s||!r||r[0]!=s)&&((0,o.domData)(n,"from-oid",s),C.replyAsAnimate(n,r[2],r[1]),i&&i.rows&&(0,a.each)(i.rows,(function(){(0,o.toggleClass)(this,"active",(0,o.domData)(this,"from-oid")==s)})),e.setAttribute("aria-label",v.Ranges.isGroupId(s)?u.getLang("wall_reply_as_group"):u.getLang("wall_reply_as_user")),!1)},sendMessage(){if(C.messageSending)return;const e={Message:(0,a.trim)(Emoji.val(C.replyInput))};if(!e.Message)return void(0,o.elfocus)(C.replyInput);if(Date.now()-C.lastMsgSent<1e3)return window.tooltips&&tooltips.destroy(C.replyInput),void(0,l.showTooltip)(C.replyInput,{text:u.getLang("video_live_chat_too_fast"),black:1});const t=Videoview.getMvData(),n=(0,o.geByClass1)("mv_chat_reply_form",this.block);n&&(0,o.domData)(n,"from-oid")&&(e.from_oid=(0,o.domData)(n,"from-oid")),ajax.post("al_video.php?act=post_comment",(0,a.extend)(e,{video:t.videoRaw,hash:t.hash,videoviewer_chat:1,item_access_hash:mvcur.mvData.itemAccessHash}),{onDone:function(e,t,n){var o;C.messageSending=!1,C.options.chatRefactoring&&(null==(o=n)?void 0:o[0])?C.appendMessageRefactoring(n[0]):e&&t&&C.appendMessage(e,t),Emoji.val(C.replyInput,""),C.checkFormHeight(),C.options.chatRefactoring||C.scroll.data.scrollBottom&&C.scrollBottom(),C.lastMsgSent=Date.now(),mvcur.player&&mvcur.player.vars.stats_tmr&&(0,c.tmrTrackCustomGoal)("comment_in_sport_broadcast")},onFail:function(e){if(C.messageSending=!1,C.replyInput)return window.tooltips&&tooltips.destroy(C.replyInput),(0,l.showTooltip)(C.replyInput,{text:e,showdt:200,forcetodown:0,slide:15,black:1}),(0,o.elfocus)(C.replyInput),!0}}),C.messageSending=!0},sendSticker(e){const t=Videoview.getMvData();ajax.post("al_video.php?act=live_send_sticker",{sticker_id:e,owner_id:t.oid,video_id:t.vid,hash:t.hash,item_access_hash:mvcur.mvData.itemAccessHash},{onDone(){C.appendSticker(e,vk.id,!1)},onFail:t=>("action_disabled"===t&&C.appendSticker(e,vk.id,!1),!0)})},showActionsMenu(e,t){var n;(null==(n=(0,_.getMsgElement)(e,t))?void 0:n.querySelector(".mv_chat_message_actions")).style.visibility="visible"},hideActionsMenu(e,t){var n;(null==(n=(0,_.getMsgElement)(e,t))?void 0:n.querySelector(".mv_chat_message_actions")).style.visibility=""},hidePinnedMessage(){f.PinnedMessageComponent.init()},showPinnedMessage(e,t,n,o,i,s,r=!1,a=!1,l=!1,c=""){if(!c){var d,u;c=null==(u=null==(d=(0,_.getMsgElement)(e,s))?void 0:d.querySelector(".mv_chat_message_text"))?void 0:u.innerHTML}f.PinnedMessageComponent.init({ownerId:e,commentId:s,text:c||"",authorId:t,authorName:n,authorHref:o,authorVerified:i,canUnpin:r,canDelete:a,canReport:l})},deleteMessage(e,t){let n;if(!C.options.chatRefactoring){if(n=document.querySelector(`#mv_chat_msg${e}`),!n)return;n.classList.add("_deleted")}ajax.post("al_video.php?act=delete_comment",{comment:e,hash:t,videoview_chat:1},{onDone(t){if(C.options.chatRefactoring){const[,t]=e.split("_");t&&C.sendCustomEvent(S.CustomEventType.DELETE_MESSAGE,t)}else if(n){n.classList.add("_show_deleted_stub");const e=n.querySelector(".mv_chat_message_content");e&&(e.innerHTML=t)}document.querySelector(`#pinned_message${e}`)&&C.hidePinnedMessage()}})},showReportVideoChatCommentForm(e,t){(0,d.showReportForm)("video_comment",e,t,(()=>{const n=(0,_.getMsgElement)(e,t);n&&(n.classList.add("_deleted"),n.classList.add("_show_deleted_stub"),(0,o.val)((0,o.domByClass)(n,"mv_chat_message_content"),u.getLang("global_report_sent")))}))},pinMessage(e,t,n,o,i,s,r,a,l){(0,p.api)("video.pinComment",{owner_id:e,comment_id:s}).then((()=>{C.showPinnedMessage(e,t,n,o,i,s,!0,r,a,l)}))},unpinMessage(e,t){(0,p.api)("video.unpinComment",{owner_id:e,comment_id:t}).then((()=>{C.hidePinnedMessage()}))},isHidden(){return!!this.hidden||Videoview.isMinimized()},setHidden(e){this.hidden=e},toggle(){const e=C.isHidden();this.setHidden(!e),C.toggleStateClasses(),e&&C.scroll&&(C.appendMessagesBatch(),C.updateScroll()),e||C.removeStickers(),e&&window.Videoview.queueReconnect()},onFullscreenChange(e){window.VideoChat.onResize(),window.VideoChat.updateScroll(),e||window.Videoview.queueReconnect()},toggleStateClasses(){const e=!!this.block,t=C.isHidden(),n=Videoview.isMinimized();(0,o.toggleClass)("mv_box","_has_chat",e&&!n),(0,o.toggleClass)("mv_box","_hide_chat",e&&!n&&t);let i="";e&&(C.appendMessagesBatch(),i=t?u.getLang("video_aria_expand_chat"):u.getLang("video_aria_minimize_chat"));(0,o.ge)("mv_top_pl_toggle")&&(0,o.attr)("mv_top_pl_toggle","aria-label",i)},updateScroll(){C.options.chatRefactoring||(C.scroll.update(),C.scroll.scrollBottom(),C.toggleScrollBottomBtn(!1))},onResize(){C.block&&(C._chatHeight=C.block.offsetHeight)},getHeight:()=>C.block?C._chatHeight||(C._chatHeight=C.block.offsetHeight):0,destroy(){if(C.block){if(C.scroll&&(C.scroll.destroy(),C.scroll=null),C.replyForm){const e=(0,o.data)(C.replyForm,"optId");void 0!==e&&Emoji.destroy(e),(0,o.removeData)(C.replyForm),(0,o.removeData)(C.replyInput),C.replyForm=C.replyInput=null}var e;if(C.removeStickers(),(0,o.removeData)(C.block),C.block.remove(),C.block=null,C.messagesWrap=null,C.stickersWrap=null,C.options.chatRefactoring&&y.VideoChatComponent.destroy(),C.options.stickerRefactoring)C.stickersCanvasWrap=null,null==(e=C.stickerManager)||e.destroy();C.options=null,clearTimeout(C._appendMessageTimeout),clearTimeout(C._appendStickerTimeout),C._appendMessageTimeout=null,C._appendStickerTimeout=null,C._messagesBatch=null,C.firstMsgIntro=null,C.messageSending=!1,C.toggleStateClasses()}}}},535727:(e,t,n)=>{n.d(t,{usePatchChildrenRef:()=>r});var o=n(667294),i=n(488543);const s=e=>"string"==typeof e.type,r=e=>{var t;const n=(0,o.isValidElement)(e)&&(s(e)?e.ref:e.props.getRootRef),r=(0,i.useExternRef)(n);return(0,o.useEffect)((()=>{r.current||console.error("Кажется, в children передан компонент, который не поддерживает свойство getRootRef. Мы не можем получить ссылку на корневой dom-элемент этого компонента")}),[null==(t=e)?void 0:t.type,r]),[r,(0,o.isValidElement)(e)?(0,o.cloneElement)(e,{[s(e)?"ref":"getRootRef"]:r}):e]}},968986:(e,t,n)=>{n.d(t,{removeDuplicateById:()=>o});const o=e=>{const t=new Set;return e.reduce(((e,n)=>{const o=n.id;return t.has(o)||e.push(n),t.add(o),e}),[])}},834347:(e,t,n)=>{function o(){return o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},o.apply(this,arguments)}n.d(t,{extends:()=>o})},906811:(e,t,n)=>{n.d(t,{useVirtualizer:()=>l,useWindowVirtualizer:()=>c});var o=n(834347),i=n(667294),s=n(945032),r="undefined"!=typeof document?i.useLayoutEffect:i.useEffect;function a(e){var t=i.useReducer((function(){return{}}),{})[1],n=(0,o.extends)({},e,{onChange:function(n){t(),null==e.onChange||e.onChange(n)}}),a=i.useState((function(){return new s.Virtualizer(n)}))[0];return a.setOptions(n),i.useEffect((function(){return a._didMount()}),[]),r((function(){return a._willUpdate()})),a}function l(e){return a((0,o.extends)({observeElementRect:s.observeElementRect,observeElementOffset:s.observeElementOffset,scrollToFn:s.elementScroll},e))}function c(e){return a((0,o.extends)({getScrollElement:function(){return"undefined"!=typeof document?window:null},observeElementRect:s.observeWindowRect,observeElementOffset:s.observeWindowOffset,scrollToFn:s.windowScroll},e))}},148849:(e,t,n)=>{function o(){return o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},o.apply(this,arguments)}n.d(t,{extends:()=>o})},945032:(e,t,n)=>{n.d(t,{Virtualizer:()=>p,defaultRangeExtractor:()=>r,elementScroll:()=>m,observeElementOffset:()=>c,observeElementRect:()=>a,observeWindowOffset:()=>d,observeWindowRect:()=>l,windowScroll:()=>h});var o=n(148849),i=n(301257),s=function(e){return e},r=function(e){for(var t=Math.max(e.startIndex-e.overscan,0),n=Math.min(e.endIndex+e.overscan,e.count-1),o=[],i=t;i<=n;i++)o.push(i);return o},a=function(e,t){var n=e.scrollElement;if(n){var o=function(e){var n=e.width,o=e.height;t({width:Math.round(n),height:Math.round(o)})};o(n.getBoundingClientRect());var i=new ResizeObserver((function(e){var t=e[0];if(null!=t&&t.borderBoxSize){var i=t.borderBoxSize[0];if(i)return void o({width:i.inlineSize,height:i.blockSize})}o(n.getBoundingClientRect())}));return i.observe(n,{box:"border-box"}),function(){i.unobserve(n)}}},l=function(e,t){var n=e.scrollElement;if(n){var o=function(){t({width:n.innerWidth,height:n.innerHeight})};return o(),n.addEventListener("resize",o,{passive:!0}),function(){n.removeEventListener("resize",o)}}},c=function(e,t){var n=e.scrollElement;if(n){var o=function(){t(n[e.options.horizontal?"scrollLeft":"scrollTop"])};return o(),n.addEventListener("scroll",o,{passive:!0}),function(){n.removeEventListener("scroll",o)}}},d=function(e,t){var n=e.scrollElement;if(n){var o=function(){t(n[e.options.horizontal?"scrollX":"scrollY"])};return o(),n.addEventListener("scroll",o,{passive:!0}),function(){n.removeEventListener("scroll",o)}}},u=function(e,t,n){if(null!=t&&t.borderBoxSize){var o=t.borderBoxSize[0];if(o)return Math.round(o[n.options.horizontal?"inlineSize":"blockSize"])}return Math.round(e.getBoundingClientRect()[n.options.horizontal?"width":"height"])},h=function(e,t,n){var o,i,s=t.adjustments,r=void 0===s?0:s,a=t.behavior,l=e+r;null==(o=n.scrollElement)||null==o.scrollTo||o.scrollTo(((i={})[n.options.horizontal?"left":"top"]=l,i.behavior=a,i))},m=function(e,t,n){var o,i,s=t.adjustments,r=void 0===s?0:s,a=t.behavior,l=e+r;null==(o=n.scrollElement)||null==o.scrollTo||o.scrollTo(((i={})[n.options.horizontal?"left":"top"]=l,i.behavior=a,i))},p=function(e){var t,n,a=this;this.unsubs=[],this.scrollElement=null,this.isScrolling=!1,this.isScrollingTimeoutId=null,this.scrollToIndexTimeoutId=null,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollDirection=null,this.scrollAdjustments=0,this.measureElementCache=new Map,this.observer=(t=null,n=function(){return t||("undefined"!=typeof ResizeObserver?t=new ResizeObserver((function(e){e.forEach((function(e){a._measureElement(e.target,e)}))})):null)},{disconnect:function(){var e;return null==(e=n())?void 0:e.disconnect()},observe:function(e){var t;return null==(t=n())?void 0:t.observe(e,{box:"border-box"})},unobserve:function(e){var t;return null==(t=n())?void 0:t.unobserve(e)}}),this.range={startIndex:0,endIndex:0},this.setOptions=function(e){Object.entries(e).forEach((function(t){var n=t[0];void 0===t[1]&&delete e[n]})),a.options=(0,o.extends)({debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:s,rangeExtractor:r,onChange:function(){},measureElement:u,initialRect:{width:0,height:0},scrollMargin:0,scrollingDelay:150,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1},e)},this.notify=function(){null==a.options.onChange||a.options.onChange(a)},this.cleanup=function(){a.unsubs.filter(Boolean).forEach((function(e){return e()})),a.unsubs=[],a.scrollElement=null},this._didMount=function(){return a.measureElementCache.forEach(a.observer.observe),function(){a.observer.disconnect(),a.cleanup()}},this._willUpdate=function(){var e=a.options.getScrollElement();a.scrollElement!==e&&(a.cleanup(),a.scrollElement=e,a._scrollToOffset(a.scrollOffset,{adjustments:void 0,behavior:void 0}),a.unsubs.push(a.options.observeElementRect(a,(function(e){var t=a.scrollRect;a.scrollRect=e,(a.options.horizontal?e.width!==t.width:e.height!==t.height)&&a.maybeNotify()}))),a.unsubs.push(a.options.observeElementOffset(a,(function(e){a.scrollAdjustments=0,a.scrollOffset!==e&&(null!==a.isScrollingTimeoutId&&(clearTimeout(a.isScrollingTimeoutId),a.isScrollingTimeoutId=null),a.isScrolling=!0,a.scrollDirection=a.scrollOffset<e?"forward":"backward",a.scrollOffset=e,a.maybeNotify(),a.isScrollingTimeoutId=setTimeout((function(){a.isScrollingTimeoutId=null,a.isScrolling=!1,a.scrollDirection=null,a.maybeNotify()}),a.options.scrollingDelay))}))))},this.getSize=function(){return a.scrollRect[a.options.horizontal?"width":"height"]},this.memoOptions=(0,i.memo)((function(){return[a.options.count,a.options.paddingStart,a.options.scrollMargin,a.options.getItemKey]}),(function(e,t,n,o){return a.pendingMeasuredCacheIndexes=[],{count:e,paddingStart:t,scrollMargin:n,getItemKey:o}}),{key:!1}),this.getFurthestMeasurement=function(e,t){for(var n=new Map,o=new Map,i=t-1;i>=0;i--){var s=e[i];if(!n.has(s.lane)){var r=o.get(s.lane);if(null==r||s.end>r.end?o.set(s.lane,s):s.end<r.end&&n.set(s.lane,!0),n.size===a.options.lanes)break}}return o.size===a.options.lanes?Array.from(o.values()).sort((function(e,t){return e.end-t.end}))[0]:void 0},this.getMeasurements=(0,i.memo)((function(){return[a.memoOptions(),a.itemSizeCache]}),(function(e,t){var n=e.count,o=e.paddingStart,i=e.scrollMargin,s=e.getItemKey,r=a.pendingMeasuredCacheIndexes.length>0?Math.min.apply(Math,a.pendingMeasuredCacheIndexes):0;a.pendingMeasuredCacheIndexes=[];for(var l=a.measurementsCache.slice(0,r),c=r;c<n;c++){var d=s(c),u=1===a.options.lanes?l[c-1]:a.getFurthestMeasurement(l,c),h=u?u.end:o+i,m=t.get(d),p="number"==typeof m?m:a.options.estimateSize(c),g=h+p,f=u?u.lane:c%a.options.lanes;l[c]={index:c,start:h,size:p,end:g,key:d,lane:f}}return a.measurementsCache=l,l}),{key:!1,debug:function(){return a.options.debug}}),this.calculateRange=(0,i.memo)((function(){return[a.getMeasurements(),a.getSize(),a.scrollOffset]}),(function(e,t,n){return a.range=function(e){var t=e.measurements,n=e.outerSize,o=e.scrollOffset,i=t.length-1,s=function(e){return t[e].start},r=g(0,i,s,o),a=r;for(;a<i&&t[a].end<o+n;)a++;return{startIndex:r,endIndex:a}}({measurements:e,outerSize:t,scrollOffset:n})}),{key:!1,debug:function(){return a.options.debug}}),this.maybeNotify=(0,i.memo)((function(){var e=a.calculateRange();return[e.startIndex,e.endIndex,a.isScrolling]}),(function(){a.notify()}),{key:!1,debug:function(){return a.options.debug},initialDeps:[this.range.startIndex,this.range.endIndex,this.isScrolling]}),this.getIndexes=(0,i.memo)((function(){return[a.options.rangeExtractor,a.calculateRange(),a.options.overscan,a.options.count]}),(function(e,t,n,i){return e((0,o.extends)({},t,{overscan:n,count:i}))}),{key:!1,debug:function(){return a.options.debug}}),this.indexFromElement=function(e){var t=a.options.indexAttribute,n=e.getAttribute(t);return n?parseInt(n,10):(console.warn("Missing attribute name '"+t+"={index}' on measured element."),-1)},this._measureElement=function(e,t){var n,o=a.indexFromElement(e),i=a.measurementsCache[o];if(i){var s=a.measureElementCache.get(i.key);if(!e.isConnected)return a.observer.unobserve(e),void(e===s&&a.measureElementCache.delete(i.key));s!==e&&(s&&a.observer.unobserve(s),a.observer.observe(e),a.measureElementCache.set(i.key,e));var r=a.options.measureElement(e,t,a),l=r-(null!=(n=a.itemSizeCache.get(i.key))?n:i.size);0!==l&&(i.start<a.scrollOffset&&a._scrollToOffset(a.scrollOffset,{adjustments:a.scrollAdjustments+=l,behavior:void 0}),a.pendingMeasuredCacheIndexes.push(o),a.itemSizeCache=new Map(a.itemSizeCache.set(i.key,r)),a.notify())}},this.measureElement=function(e){e&&a._measureElement(e,void 0)},this.getVirtualItems=(0,i.memo)((function(){return[a.getIndexes(),a.getMeasurements()]}),(function(e,t){for(var n=[],o=0,i=e.length;o<i;o++){var s=t[e[o]];n.push(s)}return n}),{key:!1,debug:function(){return a.options.debug}}),this.getVirtualItemForOffset=function(e){var t=a.getMeasurements();return(0,i.notUndefined)(t[g(0,t.length-1,(function(e){return(0,i.notUndefined)(t[e]).start}),e)])},this.getOffsetForAlignment=function(e,t){var n=a.getSize();"auto"===t&&(t=e<=a.scrollOffset?"start":e>=a.scrollOffset+n?"end":"start"),"start"===t||("end"===t?e-=n:"center"===t&&(e-=n/2));var o=a.options.horizontal?"scrollWidth":"scrollHeight",i=(a.scrollElement?"document"in a.scrollElement?a.scrollElement.document.documentElement[o]:a.scrollElement[o]:0)-a.getSize();return Math.max(Math.min(i,e),0)},this.getOffsetForIndex=function(e,t){void 0===t&&(t="auto"),e=Math.max(0,Math.min(e,a.options.count-1));var n=(0,i.notUndefined)(a.getMeasurements()[e]);if("auto"===t)if(n.end>=a.scrollOffset+a.getSize()-a.options.scrollPaddingEnd)t="end";else{if(!(n.start<=a.scrollOffset+a.options.scrollPaddingStart))return[a.scrollOffset,t];t="start"}var o="end"===t?n.end+a.options.scrollPaddingEnd:n.start-a.options.scrollPaddingStart;return[a.getOffsetForAlignment(o,t),t]},this.isDynamicMode=function(){return a.measureElementCache.size>0},this.cancelScrollToIndex=function(){null!==a.scrollToIndexTimeoutId&&(clearTimeout(a.scrollToIndexTimeoutId),a.scrollToIndexTimeoutId=null)},this.scrollToOffset=function(e,t){var n=void 0===t?{}:t,o=n.align,i=void 0===o?"start":o,s=n.behavior;a.cancelScrollToIndex(),"smooth"===s&&a.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),a._scrollToOffset(a.getOffsetForAlignment(e,i),{adjustments:void 0,behavior:s})},this.scrollToIndex=function(e,t){var n=void 0===t?{}:t,o=n.align,s=void 0===o?"auto":o,r=n.behavior;e=Math.max(0,Math.min(e,a.options.count-1)),a.cancelScrollToIndex(),"smooth"===r&&a.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size.");var l=a.getOffsetForIndex(e,s),c=l[0],d=l[1];a._scrollToOffset(c,{adjustments:void 0,behavior:r}),"smooth"!==r&&a.isDynamicMode()&&(a.scrollToIndexTimeoutId=setTimeout((function(){if(a.scrollToIndexTimeoutId=null,a.measureElementCache.has(a.options.getItemKey(e))){var t=a.getOffsetForIndex(e,d)[0];(0,i.approxEqual)(t,a.scrollOffset)||a.scrollToIndex(e,{align:d,behavior:r})}else a.scrollToIndex(e,{align:d,behavior:r})})))},this.scrollBy=function(e,t){var n=(void 0===t?{}:t).behavior;a.cancelScrollToIndex(),"smooth"===n&&a.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),a._scrollToOffset(a.scrollOffset+e,{adjustments:void 0,behavior:n})},this.getTotalSize=function(){var e;return((null==(e=a.getMeasurements()[a.options.count-1])?void 0:e.end)||a.options.paddingStart)-a.options.scrollMargin+a.options.paddingEnd},this._scrollToOffset=function(e,t){var n=t.adjustments,o=t.behavior;a.options.scrollToFn(e,{behavior:o,adjustments:n},a)},this.measure=function(){a.itemSizeCache=new Map,a.notify()},this.setOptions(e),this.scrollRect=this.options.initialRect,this.scrollOffset=this.options.initialOffset,this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach((function(e){a.itemSizeCache.set(e.key,e.size)})),this.maybeNotify()},g=function(e,t,n,o){for(;e<=t;){var i=(e+t)/2|0,s=n(i);if(s<o)e=i+1;else{if(!(s>o))return i;t=i-1}}return e>0?e-1:0}},301257:(e,t,n)=>{function o(e,t,n){var o,i,s=null!=(o=n.initialDeps)?o:[];return function(){var o;n.key&&null!=n.debug&&n.debug()&&(o=Date.now());var r,a=e();if(!(a.length!==s.length||a.some((function(e,t){return s[t]!==e}))))return i;if(s=a,n.key&&null!=n.debug&&n.debug()&&(r=Date.now()),i=t.apply(void 0,a),n.key&&null!=n.debug&&n.debug()){var l=Math.round(100*(Date.now()-o))/100,c=Math.round(100*(Date.now()-r))/100,d=c/16,u=function(e,t){for(e=String(e);e.length<t;)e=" "+e;return e};console.info("%c⏱ "+u(c,5)+" /"+u(l,5)+" ms","\n            font-size: .6rem;\n            font-weight: bold;\n            color: hsl("+Math.max(0,Math.min(120-120*d,120))+"deg 100% 31%);",null==n?void 0:n.key)}return null==n||null==n.onChange||n.onChange(i),i}}function i(e,t){if(void 0===e)throw new Error("Unexpected undefined"+(t?": "+t:""));return e}n.d(t,{approxEqual:()=>s,memo:()=>o,notUndefined:()=>i});var s=function(e,t){return Math.abs(e-t)<1}}}]);try{stManager.done("dist/web/chunks/de31987e.5a7c0ba1.js")}catch(e){}