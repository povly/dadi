/*! For license information please see fe894d6c.937dff90.js.LICENSE.txt */
"use strict";(self.webpackChunkvkweb=self.webpackChunkvkweb||[]).push([[58357],{774351:(e,t,n)=>{function r(e,t){return new Promise((function(n){setTimeout(n.bind(null,t),1e3*e)}))}n.d(t,{pause:()=>r})},271831:(e,t,n)=>{function r(e){return e>0&&e<2e9}function a(e){return e>2e9}n.d(t,{isChatPeer:()=>a,isUserPeer:()=>r})},108679:(e,t,n)=>{var r=n(659864),a={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},o={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},i={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},s={};function l(e){return r.isMemo(e)?i:s[e.$$typeof]||a}s[r.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},s[r.Memo]=i;var c=Object.defineProperty,d=Object.getOwnPropertyNames,u=Object.getOwnPropertySymbols,p=Object.getOwnPropertyDescriptor,m=Object.getPrototypeOf,g=Object.prototype;e.exports=function e(t,n,r){if("string"!=typeof n){if(g){var a=m(n);a&&a!==g&&e(t,a,r)}var i=d(n);u&&(i=i.concat(u(n)));for(var s=l(t),_=l(n),f=0;f<i.length;++f){var h=i[f];if(!(o[h]||r&&r[h]||_&&_[h]||s&&s[h])){var S=p(n,h);try{c(t,h,S)}catch(e){}}}}return t}},441143:e=>{e.exports=function(e,t,n,r,a,o,i,s){if(!e){var l;if(void 0===t)l=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[n,r,a,o,i,s],d=0;(l=new Error(t.replace(/%s/g,(function(){return c[d++]})))).name="Invariant Violation"}throw l.framesToPop=1,l}}},869921:(e,t)=>{var n="function"==typeof Symbol&&Symbol.for,r=n?Symbol.for("react.element"):60103,a=n?Symbol.for("react.portal"):60106,o=n?Symbol.for("react.fragment"):60107,i=n?Symbol.for("react.strict_mode"):60108,s=n?Symbol.for("react.profiler"):60114,l=n?Symbol.for("react.provider"):60109,c=n?Symbol.for("react.context"):60110,d=n?Symbol.for("react.async_mode"):60111,u=n?Symbol.for("react.concurrent_mode"):60111,p=n?Symbol.for("react.forward_ref"):60112,m=n?Symbol.for("react.suspense"):60113,g=n?Symbol.for("react.suspense_list"):60120,_=n?Symbol.for("react.memo"):60115,f=n?Symbol.for("react.lazy"):60116,h=n?Symbol.for("react.block"):60121,S=n?Symbol.for("react.fundamental"):60117,I=n?Symbol.for("react.responder"):60118,v=n?Symbol.for("react.scope"):60119;function E(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case r:switch(e=e.type){case d:case u:case o:case s:case i:case m:return e;default:switch(e=e&&e.$$typeof){case c:case p:case f:case _:case l:return e;default:return t}}case a:return t}}}function y(e){return E(e)===u}t.AsyncMode=d,t.ConcurrentMode=u,t.ContextConsumer=c,t.ContextProvider=l,t.Element=r,t.ForwardRef=p,t.Fragment=o,t.Lazy=f,t.Memo=_,t.Portal=a,t.Profiler=s,t.StrictMode=i,t.Suspense=m,t.isAsyncMode=function(e){return y(e)||E(e)===d},t.isConcurrentMode=y,t.isContextConsumer=function(e){return E(e)===c},t.isContextProvider=function(e){return E(e)===l},t.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===r},t.isForwardRef=function(e){return E(e)===p},t.isFragment=function(e){return E(e)===o},t.isLazy=function(e){return E(e)===f},t.isMemo=function(e){return E(e)===_},t.isPortal=function(e){return E(e)===a},t.isProfiler=function(e){return E(e)===s},t.isStrictMode=function(e){return E(e)===i},t.isSuspense=function(e){return E(e)===m},t.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===o||e===u||e===s||e===i||e===m||e===g||"object"==typeof e&&null!==e&&(e.$$typeof===f||e.$$typeof===_||e.$$typeof===l||e.$$typeof===c||e.$$typeof===p||e.$$typeof===S||e.$$typeof===I||e.$$typeof===v||e.$$typeof===h)},t.typeOf=E},659864:(e,t,n)=>{e.exports=n(869921)},495457:(e,t,n)=>{n.d(t,{getCallsCount:()=>S,getDefaultConversation:()=>g,getMediaModifiers:()=>v,getMediaOptions:()=>f,increaseCallsCount:()=>I,isActiveGroupCallMessage:()=>u,isAuthedByGroupId:()=>_,isGroupCallByPeer:()=>d,isGroupCallByVkId:()=>c,isIAmSpeaking:()=>h,isRequireAuthToJoin:()=>p,isWaitingHallEnabled:()=>m});var r=n(271831),a=n(22412),o=n(464380),i=n(659397),s=(n(878198),n(832856)),l=n(455319);const c=e=>0===e||null===e||(0,r.isChatPeer)(e),d=e=>c((0,l.peerIdToVkId)(e));function u(e){return e&&e.attaches&&e.attaches[0]&&"group_call_in_progress"===e.attaches[0].type}function p(e){return e.conversationOptions.includes(o.ConversationOption.REQUIRE_AUTH_TO_JOIN)}function m(e){return e.conversationOptions.includes(o.ConversationOption.WAITING_HALL)}function g(e){return{peerId:"",canAddMembers:!0,tab:e("calls_new_call_title"),photo:a.DEFAULT_GROUP_CALL_PHOTO}}function _(e){return!!e.groupId}function f({audio:e,video:t,animoji:n}){const r=[];return e&&r.push(o.MediaOption.AUDIO),t&&r.push(o.MediaOption.VIDEO),n&&r.push(o.MediaOption.ANIMOJI),r}function h(e){return!!e.externalId&&!!e.speakers[(0,s.externalIdToString)(e.externalId)]}function S(){var e;return Number(null!=(e=i.localStorage.getItem(a.CALLS_DESKTOP_APP_NOTIFICATION))?e:0)}function I(){var e;const t=Number(null!=(e=i.localStorage.getItem(a.CALLS_DESKTOP_APP_NOTIFICATION))?e:0)+1;i.localStorage.setItem(a.CALLS_DESKTOP_APP_NOTIFICATION,String(t))}const v=({noiseReductionMode:e,enableNoiseReductionMode:t})=>{const n={1:{denoise:!0,denoiseAnn:!0},2:{denoise:!0,denoiseAnn:!1},3:{denoise:!1,denoiseAnn:!1}},r=t&&Boolean(n[e])?n[e]:n[1];return{noiseCancellationModesByType:{[a.NoiseCancellationTypes.NEURAL]:r,[a.NoiseCancellationTypes.SIMPLE]:n[2],[a.NoiseCancellationTypes.NONE]:n[3]}}}},878198:(e,t,n)=>{n.d(t,{anyMatchInArray:()=>Q,binarySearch:()=>q,calculateCallDuration:()=>R,capitalize:()=>W,compose:()=>O,conditionalPausedPromise:()=>k,convertCallerFromLongpoll:()=>I,convertChatFromLongpoll:()=>v,convertClientData:()=>h,convertServerData:()=>S,createImmediate:()=>re,createPayload:()=>C,createTimeout:()=>ne,deepClone:()=>ee,exponentialRetry:()=>N,fetchUserShortName:()=>f,getCallable:()=>z,getParticipantsListLabel:()=>w,getTextForApiErrorByCode:()=>b,getTextForClientError:()=>A,getTextForServerError:()=>P,getVkIdFromLongpoll:()=>E,hasIn:()=>V,isAnyoneWithVideo:()=>T,isArraysEqual:()=>X,isBoolean:()=>J,isEmpty:()=>j,isGroupCallEvent:()=>y,isInReconnect:()=>M,isSameFeatureNotification:()=>oe,last:()=>Z,minmax:()=>Y,noop:()=>$,normalizePreviewData:()=>L,objectFilter:()=>U,objectForEach:()=>G,objectMap:()=>F,objectReduce:()=>H,objectSome:()=>B,shallowEqual:()=>g.shallowEqual,shorten:()=>K,shuffle:()=>te,tokenValidateRetryWrapper:()=>D,unpackState:()=>x,vou:()=>ae});var r=n(434788),a=n(820224),o=n(271831),i=n(495457),s=n(22412),l=n(774351),c=n(659397),d=n(455319),u=n(464380),p=n(832856),m=n(723062),g=n(50533);function _(e){let t=e.shortName,n=e.firstName,a=e.lastName;return t&&n||([n,a]=e.name.split(" "),t=f(n,a,e.name)),(0,r._)({},e,{peerId:(0,d.vkIdToPeerId)(e.id),tab:e.name,shortName:t,firstName:n})}function f(e,t,n){if(e){const n=t?t.length>2?t.substring(0,1)+".":t:"";return n?`${e} ${n}`:e}return null!=n?n:""}function h([e,t]){const n=e&&function(e){var{callInProgress:t=!1}=e,n=(0,a._)(e,["callInProgress"]);return!n.call_in_progress&&t&&(n.call_in_progress=t),n}(e);return[n&&("peerId"in n?n:_(n)),t?t.map(_):[]]}function S({items:e,profiles:t=[]}){const[n]=e,a=function(e){if(e.chat_settings){let t={peerId:(0,d.vkIdToPeerId)(e.peer.id),tab:e.chat_settings.title,name:e.chat_settings.title,canAddMembers:e.chat_settings.acl.can_invite,adminIds:e.chat_settings.admin_ids,ownerId:e.chat_settings.owner_id||-1};return e.chat_settings.photo&&(t.photo=e.chat_settings.photo.photo_200||e.chat_settings.photo.photo_100),t}return{canAddMembers:!0,peerId:(0,d.vkIdToPeerId)(e.peer.id)}}(n),i=function(e){return e.map(d.normalizeUser)}(t);var s;return[(0,r._)({},a,{tab:a.name}),(0,o.isUserPeer)(null!=(s=(0,d.peerIdToVkId)(a.peerId))?s:0)?[(0,r._)({},i&&i.filter((({peerId:e})=>e===a.peerId))[0],a)]:i,n]}function I(e){const t=e.caller_info,n=t.first_name+" "+t.last_name;return{id:t.user_id,peerId:(0,d.vkIdToPeerId)(t.user_id),name:n,tab:n,photo:t.photo_400,firstName:t.first_name,lastName:t.last_name,shortName:f(t.first_name,t.last_name,n),is_nft:!!t.is_nft}}function v(e){return{peerId:(0,d.vkIdToPeerId)(m.Ranges.convertChatIdToChatPeerId(e.chat_id)),tab:e.title,name:e.title,photo:e.photo_400}}function E(e){const t=e.caller_info,n=e.chat_info;return n?m.Ranges.convertChatIdToChatPeerId(n.chat_id):t.user_id}function y(e){return!!e.payload.chat_info}function T(e){return!!(0,p.isParticipantWithVideo)(e.localDevice)||B(e.devices,(e=>!(!e.wasConnected||!(0,p.isParticipantWithVideo)(e))))}function R(e){const t=Date.now(),n=Math.max(0,Math.floor((t-e)/1e3));return 0===n?"00:00":n<=599?"0"+(0,c.formatDuration)(n):(0,c.formatDuration)(n)}function b(e,t,n){switch(+e){case s.SERVER_ERROR_MESSAGES_CALL_JOIN_NOT_ALLOWED:return n("calls_join_error_require_access");case s.SERVER_ERROR_MESSAGES_CALL_NOT_FOUND:return n("calls_join_error_text");case s.SERVER_ERROR_MESSAGES_CALL_INVALID_JOIN_LINK:return n("calls_invalid_join_link");case s.SERVER_ERROR_PRIVACY:return n("calls_privacy_error");case s.SERVER_ERROR_BUSY:return n(t?"calls_chat_busy_error":"calls_busy_error");case s.SERVER_ERROR_FLOOD_CONTROL:return n("calls_flood_error");case s.SERVER_ERROR_REQUIRE_AUTH:return n("calls_join_error_require_auth");case s.SERVER_ERROR_UNKNOWN:case s.SERVER_ERROR_INVALID_REQUEST:case s.SERVER_ERROR_INTERNAL:case s.SERVER_ERROR_OLD_RECEIVER_APP:default:return n("calls_start_error")}}function P(e,t,n){var r,a;const o=0===e.search("EXTERNAL_API_ERROR"),i=e.match(/\d+/g),l=i?Number(null==(r=e.match(/\d+/g))?void 0:r[1]):s.CLIENT_ERROR_UNKNOWN,c=i?Number(null==(a=e.match(/\d+/g))?void 0:a[0]):s.CLIENT_ERROR_UNKNOWN;if(!o||Number.isNaN(l))return c===s.SDK_ERROR_AUTH?n("calls_start_error_auth"):function(e,t,n){switch(!0){case-1!==e.search("error.webrtc.auth.required"):return n("calls_join_error_require_auth");case-1!==e.search("error.webrtc.auth.banned"):case-1!==e.search("error.webrtc.participant.check.privacy"):return n("calls_join_error_banned");case-1!==e.search("error.webrtc.participant.check.killed_call"):return n("calls_join_error_killed_call");case-1!==e.search("not.found.webrtc.conversation"):return n("calls_join_error_not_found_conversation");default:return n("calls_start_error")}}(e,0,n);switch(e){case u.HangupType.CANCELED:return n("calls_hangup_error_canceled");case u.HangupType.REJECTED:return n("calls_hangup_error_rejected");case u.HangupType.REMOVED:return n("calls_hangup_error_removed");case u.HangupType.HUNGUP:return n("calls_hangup_error_hangup");case u.HangupType.MISSED:return n("calls_hangup_error_missed");case u.HangupType.BUSY:return n("calls_hangup_error_busy");case u.HangupType.FAILED:return n("calls_hangup_error_failed");case u.HangupType.NETWORK_ERROR:return n("calls_hangup_error_network_error");case u.HangupType.CALLER_IS_BLOCKED:return n("calls_hangup_error_caller_is_blocked");case u.HangupType.NOT_FRIENDS:return n("calls_hangup_error_not_friends");case u.HangupType.CALLEE_IS_OFFLINE:return n("calls_hangup_error_callee_is_offline");case u.HangupType.UNKNOWN_ERROR:return n("calls_hangup_error_unknown_error");case u.HangupType.UNSUPPORTED:return n("calls_hangup_error_unsupported");case u.HangupType.OLD_VERSION:return n("calls_hangup_error_old_version");case u.HangupType.SERVICE_DISABLED:return n("calls_hangup_error_service_disabled");case u.HangupType.EXTERNAL_API_ERROR:return n("calls_hangup_error_external_api_error");case u.HangupType.SOCKET_CLOSED:return n("calls_hangup_error_socket_closed");case u.HangupType.NOT_FOUND:return n("calls_hangup_error_not_found")}return b(+l,t,n)}function A(e,t,n){return n("calls_sorry_error")}function C(e,t,n=0){const r=(0,i.isGroupCallByVkId)(e),a={is_video:t.includes(u.MediaOption.VIDEO),chat_id:(0,o.isChatPeer)(e)?m.Ranges.convertChatPeerIdToChatId(e):void 0,with_join_link:r,join_by_link:r,community_user_id:n};return JSON.stringify(a)}function M(e){return e.localDevice.status===u.ParticipantStatus.RECONNECT||B(e.devices,(e=>e.status===u.ParticipantStatus.RECONNECT))}const O=(e,...t)=>(...n)=>t.reduce(((e,t)=>t(e)),e)(...n);function N(e,t={attempts:10,timeout:0}){return(...n)=>t.attempts>0?(0,l.pause)(t.timeout,null).then((()=>e(...n))).catch((r=>(!t.timeout&&(t.timeout=1),t.attempts=r.type===s.SdkErrorType.API?0:t.attempts-1,t.timeout=Math.min(2*t.timeout,300),N(e,t)(...n)))):Promise.reject(s.CallErrorType.CANT_REACH_API)}const D=(e,t)=>(...n)=>t(...n).catch((r=>{if(r.error===s.FatalError.AUTH)return e().then((()=>t(...n)));throw r}));function w(e,t,n,r,a,o=0,i=3){const s=e=>(0,c.decodeHTMLEntities)(n(e)||"");if(0===o&&e.length>0&&(o=e.length),o>t.length){const n=o-t.length,l=e.slice(0,i).map(s).join(", ");return a(n,"calls_members_list_label",r("calls_members_list_label",n)).replace("{name}",l)}if(t.length>1){const n=t.length>2?e.slice(0,2).map(s).join(", "):s(e[0]),a=s(e[t.length-1]);return r("calls_and").replace("{before}",n).replace("{after}",a)}return 1===t.length?s(e[0]):""}function x(e){return"current"in e?e.current:e}function L(e,{join_link:t,preview:n,profiles:r,anonyms:a,call_id:o}){var i,l,c,u,p,m;const g=[...a||[],...r||[]].map(d.normalizeUser);return{joinLink:t,callId:o,title:null==(i=n)?void 0:i.title,membersCount:null==(l=n)?void 0:l.members_count,photo_100:null==(u=n)||null==(c=u.photo)?void 0:c.photo_100,photo_200:null==(m=n)||null==(p=m.photo)?void 0:p.photo_200,members:g,conversationData:{peerId:s.EMPTY_PEER_ID,canAddMembers:!0,tab:e("calls_new_call_title"),photo:s.DEFAULT_GROUP_CALL_PHOTO}}}const k=e=>"number"!=typeof e||Number.isNaN(e)?Promise.resolve():(0,l.pause)(e,void 0),V=(e,...t)=>t.includes(e),j=e=>{switch(typeof e){case"boolean":case"string":case"undefined":case"number":return!e;case"function":case"bigint":case"symbol":return!0;case"object":return null!==e&&(Array.isArray(e)?!e.length:!Object.keys(e).length)}},U=(e,t)=>{const n=[];for(const r in e)e.hasOwnProperty(r)&&t(e[r])&&n.push(e[r]);return n},F=(e,t)=>{const n=[];for(const r in e)e.hasOwnProperty(r)&&n.push(t(e[r],r));return n},H=(e,t,n)=>{let r=n;for(const n in e)e.hasOwnProperty(n)&&(r=t(r,e[n],n));return r},G=(e,t)=>{for(const n in e)e.hasOwnProperty(n)&&t(e[n],n)};function B(e,t){for(const n in e)if(e.hasOwnProperty(n)&&t(e[n],n))return!0;return!1}const $=(...e)=>{},W=e=>{var t;return e.length?(null==(t=e.charAt(0))?void 0:t.toLocaleUpperCase())+e.slice(1):""},K=(e,t)=>e.length<=t?e:e.slice(0,Math.max(t-3,0)).trim().concat("..."),z=e=>"function"==typeof e?e():e;function q(e,t){let n=0,r=e.length,a=!1;for(;n<r;){const o=Math.floor((n+r)/2),i=t(e[o],o);i>0?n=o+1:(r=o,a=!i)}return a?n:~n}const J=e=>"boolean"==typeof e,Y=(e,t,n,r=!0)=>r?e>=t&&e<=n:e>t&&e<n,Q=(e,t)=>{if(!e||!t)return!1;const n=Array.isArray(t)?t:[t];if(!e.length&&!n.length)return!0;if(e.length&&!n.length)return!1;const r=new Set(e);return n.every((e=>r.has(e)))},X=(e,t)=>!e&&!t||!(!e||!t)&&(e.length===t.length&&e.every(((e,n)=>e===t[n]))),Z=e=>{if(e.length)return e[e.length-1]},ee=e=>Array.isArray(e)?e.map((e=>ee(e))):e instanceof Date?new Date(e.getTime()):e&&"object"==typeof e?Object.getOwnPropertyNames(e).reduce(((t,n)=>{const r=Object.getOwnPropertyDescriptor(e,n);return r&&Object.defineProperty(t,n,r),t[n]=ee(e[n]),t}),Object.create(Object.getPrototypeOf(e))):e,te=e=>{const t=e.length,n=e.slice();let r=-1;for(;++r<t;){const e=Math.floor(Math.random()*t),a=n[e];n[e]=n[r],n[r]=a}return n},ne=(e,t)=>{const n=setTimeout(e,t);return()=>clearTimeout(n)},re=e=>{setTimeout(e,0)};function ae(e,t){return e?t:void 0}const oe=(e,t)=>Boolean(t&&t===e)},832856:(e,t,n)=>{n.d(t,{PARTICIPANTS_LIST_BUFFER_SIZE:()=>g,canMuteParticipants:()=>N,canPinParticipants:()=>C,convertParticipantStateFromSDK:()=>Z,externalIdToString:()=>$,getActiveDevices:()=>T,getActiveDevicesCount:()=>J,getActiveParticipantsCount:()=>R,getAvailableStreamModes:()=>ie,getCallVisibleParticipant:()=>E,getDefaultExternalId:()=>Y,getDeviceFromStoreById:()=>ae,getFirstMatchedId:()=>z,getMeId:()=>k,getMediaSettingsWithStreamMode:()=>de,getNewStreamModeByDevice:()=>oe,getNonAnonymousConnectParticipantsCount:()=>P,getOrator:()=>B,getParticipantExternalId:()=>S,getParticipantsInfo:()=>b,getPeerIdDeviceInfo:()=>W,getPreviousAvailableStreamMode:()=>se,getRaisedHands:()=>D,getSausageStream:()=>j,getSelectedDevice:()=>Q,getSharingUrlParticipantId:()=>G,getSingleLetter:()=>ue,getStream:()=>V,isAdmin:()=>M,isCallHaveOtherParticipants:()=>X,isCreator:()=>O,isParticipantAnonym:()=>f,isParticipantGroup:()=>h,isParticipantInCall:()=>I,isParticipantUnavailableToCallFromGroup:()=>v,isParticipantWithMovie:()=>F,isParticipantWithVideo:()=>U,isSameExternalId:()=>K,isSharedUrlShownFromDevice:()=>H,isStreamModeAvailable:()=>ce,kickParticipant:()=>w,participantIsAdmin:()=>L,participantIsChatAdmin:()=>x,someDeviceByParticipant:()=>q,stopUrlSharing:()=>re,toggleScreenSharing:()=>te,toggleUrlSharingForParticipant:()=>ne});var r=n(434788),a=n(22412),o=n(495457),i=n(464380),s=n(878198),l=n(971),c=n(438655),d=n(963645),u=n(723062),p=n(227336),m=n(455319);const g={ORATOR:30,GRID:60},_=e=>"object"==typeof e?+e.id:(0,m.isIPeerId)(e)?(0,m.peerIdToVkId)(e):e,f=e=>u.Ranges.isAnonymousCallPeerId(_(e)),h=e=>u.Ranges.isGroupId(_(e)),S=e=>{var t;return(null==(t=e)?void 0:t.peerId)?{id:e.peerId,type:i.ExternalIdType.USER}:null},I=(e,t)=>{if(t===e.me)return!0;const n=e.participants[t];return!!n&&q(n,(e=>!!e.status))},v=(e,t)=>!!e.unableToCallGroupMembersIds&&e.unableToCallGroupMembersIds.indexOf(t)>-1;function E(e,t){var n;const a=(0,o.isGroupCallByPeer)(e.peer)?z(e.adminPinnedParticipant,(0,d.getWatchTogetherPinnedParticipant)(e),e.mediaSharingPinnedParticipant,e.pinnedParticipant,e.orator):e.peer;let i=null;if(null!==a&&(i="object"==typeof a?$(a):a.toString()),i&&e.devices[i])return e.devices[i];let s=null;const l=e.rooms.roomId?e.rooms.roomParticipantIds[(0,c.roomIdToString)(e.rooms.roomId)]:null;var u;const p=null!=(u=null==(n=l)?void 0:n.reduce(((t,n)=>{const r=e.devices[n.idString];return r&&(t[n.idString]=r),t}),{}))?u:{},m=l?p:e.devices;for(const n in m){if(!m.hasOwnProperty(n))continue;const r=m[n];if(!K(r.externalId,e.externalId)&&r.wasConnected&&(s||(s=r),!t||U(r)))return r}return s||(s=(0,r._)({},e.localDevice,{externalId:e.externalId||Y()})),s}let y=[];function T(e){const t=e.devices,n=e.adminPinnedParticipant,a=[],o=[],i=[],s=[],l=[],d=[],u=[],m=[],g=t=>{var r,c,g,_,f;t.status&&((null==(c=t.statusData)||null==(r=c.hand)?void 0:r.state)?a.push(t):K(t.externalId,n)?o.push(t):K(t.externalId,e.externalId)?i.push(t):H(t)?s.push(t):(null==(g=t.mediaSettings)?void 0:g.isScreenSharingEnabled)?l.push(t):(null==(_=t.mediaSettings)?void 0:_.isVideoEnabled)?d.push(t):(null==(f=t.mediaSettings)?void 0:f.isAnimojiEnabled)?u.push(t):m.push(t)),t.screenSharingStream&&p.screenShareNotVisibleStat.measure(t.externalId)};var _;const f=null!=(_=e.rooms.roomParticipantIds[(0,c.roomIdToString)(e.rooms.roomId)])?_:[];for(const e of f)t[e.idString]&&g(t[e.idString]);var h,S;e.externalId&&g((0,r._)({},e.localDevice,{externalId:e.externalId}));const I=[...a.sort(((e,t)=>{var n,r,a,o,i;return(null!=(h=null==(r=e.statusData)||null==(n=r.hand)?void 0:n.ts)?h:0)-(null!=(S=null==(i=t)||null==(o=i.statusData)||null==(a=o.hand)?void 0:a.ts)?S:0)})),...o,...i,...s,...l,...d,...u,...m];if(I.length!==y.length)y=I;else for(let e=0;e<I.length;e++)if(I[e]!==y[e]){y=I;break}return{activeDevices:y}}function R(e,t,n){let r=0;for(const a in e)e.hasOwnProperty(a)&&A(t,e[a],n)&&r++;return r}const b=({excludeAnonymFromCount:e,participants:t,me:n})=>{const r={membersCount:0,creatorPeerId:a.EMPTY_PEER_ID};for(const a in t){var o;t.hasOwnProperty(a)&&(!r.creatorPeerId&&(null==(o=t[a].roles)?void 0:o.includes(i.UserRole.CREATOR))&&(r.creatorPeerId=a),e&&f(+a)||A(n,t[a])&&r.membersCount++)}return r};function P(){const{devices:e,participants:t,me:n}=l.GlobalStore.getCallsState();return(0,s.objectReduce)(e,((e,r)=>{if(r.externalId.id===n)return e;if(r.status!==i.ParticipantStatus.CONNECTED)return e;if(f(r.externalId))return e;const a=t[r.externalId.id];return(M(a)||O(a))&&e.admins++,e.users++,e}),{users:0,admins:0})}function A(e,t,n=(e=>!!e.status)){return t.peerId===e||q(t,n)}function C(e){return M(e)||O(e)}function M(e){var t;return!!(null==(t=e)?void 0:t.roles)&&e.roles.some((e=>e===i.UserRole.ADMIN))}function O(e){var t;return!!(null==(t=e)?void 0:t.roles)&&e.roles.some((e=>e===i.UserRole.CREATOR))}function N(e){return!!e.roles&&(O(e)||M(e))}function D({devices:e,localDevice:t,handState:n,rooms:r}){var a;const o=n?Object.keys(n).length:(0,s.objectReduce)(e,((e,t)=>{var n,a;return t.status&&(null==(a=t.statusData)||null==(n=a.hand)?void 0:n.state)&&t.roomId===r.roomId&&e++,e}),0);return(null==(a=t.statusData.hand)?void 0:a.state)?o+1:o}function w(e,t=!1){const n=S(e);return n?(0,i.removeParticipant)(n,t):Promise.resolve()}function x(e,t){if(!t)return!1;const n=(0,m.peerIdToVkId)(e.peerId);return!!n&&(n===t.ownerId||!!t.adminIds&&t.adminIds.includes(n))}function L(e){return M(e)||O(e)}function k(e){return(0,o.isAuthedByGroupId)(e)?e.groupId:e.me}function V(e,t){var n,r;const{stream:a,screenSharingStream:o,animojiStream:s,movieStream:l,streamMode:c,mediaSettings:d,movieStreamInfo:u}=e,p=!!o&&d.isScreenSharingEnabled,m=!!s&&d.isAnimojiEnabled,g=!!a&&(d.isVideoEnabled||d.isAnimojiEnabled&&!!(null==(n=t)?void 0:n.animojiBackendRender)),_=!!l&&u;if(null==(r=t)?void 0:r.onlyVideo)return g||m?{data:g?a:s,type:i.MediaType.CAMERA}:null;switch(c){case i.MediaType.CAMERA:return g||m?{data:g?a:s,type:c}:null;case i.MediaType.SCREEN:return p?{data:o,type:c}:null;case i.MediaType.STREAM:case i.MediaType.MOVIE:return _?{data:l,type:c}:null;default:return g||m?{data:g?a:s,type:i.MediaType.CAMERA}:null}}function j(e,{isOrator:t,animojiBackendRender:n}){const{stream:r,screenSharingStream:a,animojiStream:o,movieStream:i,streamMode:s,mediaSettings:l,movieStreamInfo:c}=e,d=!(!a||!l.isScreenSharingEnabled),u=!(!o||!l.isAnimojiEnabled),p=!(!r||!(l.isVideoEnabled||l.isAnimojiEnabled&&n)),m=!(!i||!c);return t?V(e,{onlyVideo:p||u,animojiBackendRender:n}):s?m?{data:i,type:s}:d?{data:a,type:s}:p||u?{data:p?r:o,type:s}:null:null}function U(e){var t;return!!(null==(t=e.mediaSettings)?void 0:t.isVideoEnabled)||function(e){var t;return!(!(null==(t=e.mediaSettings)?void 0:t.isAnimojiEnabled)||!e.animojiStream&&!e.stream)}(e)||function(e){var t;return!!(null==(t=e.mediaSettings)?void 0:t.isScreenSharingEnabled)&&!!e.screenSharingStream}(e)}function F(e){return!!e.movieStream&&!!e.movieStreamInfo}function H(e){return!!e.sharedUrl&&e.streamMode===i.MediaType.SHARED_URL}function G(e){var t;if(H(e.localDevice))return e.externalId;return null==(t=Object.values(e.devices).find((e=>H(e))))?void 0:t.externalId}function B(e){const t=z(e.adminPinnedParticipant,(0,d.getWatchTogetherPinnedParticipant)(e),e.mediaSharingPinnedParticipant,e.pinnedParticipant,e.orator);if(t&&!K(e.externalId,t)){const n=e.devices[$(t)],r=e.participants[t.id];if(n&&r)return{device:n,participant:r,externalId:t}}return{device:e.localDevice,participant:e.participants[e.me],externalId:e.externalId}}function $(e){if(!e)throw new Error("externalId is null or undefined");let t=e.id;return"number"==typeof e.deviceIdx&&(t+=":d"+e.deviceIdx),t}const W=(e,t)=>{let n=0,r=null;for(const a in t){if(!t.hasOwnProperty(a))continue;if(n++,n>1)break;const o=t[a];o.externalId.id===e&&(r=o)}return r};function K(e,t){return!(!e||!t)&&(e.deviceIdx===t.deviceIdx&&e.id===t.id)}function z(...e){for(const t of e)if(null!=t)return t;return null}function q(e,t){if(!e)return!1;const{maps:{vkIdToDevices:n},devices:r}=l.GlobalStore.getCallsState(),a=n.get((0,m.peerIdToVkId)(e.peerId));if(!a)return!1;for(const e of a){var o;const n=r[e];if(n&&(null==(o=t)?void 0:o(n)))return!0}return!1}function J(e,t,n){if(n){const e=Math.max(0,n.countBefore),t=Math.max(0,n.countAfter);return 1+e+n.ids.length+t}let r=1;var a;const o=null!=(a=t.roomParticipantIds[(0,c.roomIdToString)(t.roomId)])?a:[];for(const t of o){const n=e[t.idString];n&&n.status&&r++}return r}function Y(e){return{deviceIdx:0,id:null!=e?e:"0",type:i.ExternalIdType.USER}}const Q=e=>{const{device:t}=B(e);return"externalId"in t?t:(0,r._)({},t,{externalId:e.externalId||Y()})},X=()=>{var e;const{devices:t,externalId:n,me:r}=l.GlobalStore.getCallsState(),a=(null==(e=n)?void 0:e.id)||r.toString();return(0,s.objectSome)(t,(e=>e.externalId.id!==a))};function Z(e){let t=(0,s.deepClone)(e);var n,r,o,i,l,c,d,u;t.hand&&(t.hand={state:(null==(r=e)||null==(n=r.hand)?void 0:n.state)===a.SdkHandType.RAISED,ts:null==(i=e)||null==(o=i.hand)?void 0:o.ts});e.drat&&(t.drat={state:(null==(c=e)||null==(l=c.drat)?void 0:l.state)===a.SdkDratType.REQUESTED,ts:null==(u=e)||null==(d=u.drat)?void 0:d.ts});return t}function ee(e,t,n){const r=function(e){return(0,s.objectReduce)(e.mediaSharers,((e,t)=>t?e+1:e),0)}(e),o=!!n||1===r&&!(!e.adminPinnedParticipant&&!e.pinnedParticipant),i=e=>{t({type:a.E_ACTION.TOGGLE_ORATOR_MODE,isOratorMode:e})},l=e=>{t({type:a.E_ACTION.SET_PINNED_PARTICIPANT,pinnedParticipant:e})};o&&!e.isOratorMode&&i(!0),!o&&e.mediaSharingNeedDisableOratorModeAfterStop&&i(!1),t({type:a.E_ACTION.SET_MEDIA_SHARING_PINNED_PARTICIPANT,mediaSharingPinnedParticipant:(0,d.getWatchTogetherPinnedParticipant)(e)?null:n,mediaSharingNeedDisableOratorModeAfterStop:!e.isOratorMode,mediaSharingOldPinnedParticipant:e.pinnedParticipant}),n&&e.pinnedParticipant&&l(null),n||e.pinnedParticipant||!e.mediaSharingOldPinnedParticipant||l(e.mediaSharingOldPinnedParticipant)}function te(e,t,n,r,o){var i,s;if(!(0,c.isInMyRoom)(r))return;if(!n&&G(e))return;ee(e,t,n?r:null);!!(null==(s=null==(i=e.devices[$(r)])?void 0:i.mediaSettings)?void 0:s.isScreenSharingEnabled)!==n&&t({type:a.E_ACTION.SET_MEDIA_SHARER,participantId:r,isMediaSharingEnabled:n}),o&&t({type:a.E_ACTION.CALL_NOTIFICATION,notification:{type:n?a.NotificationType.SCREEN_SHARING_STARTED:a.NotificationType.SCREEN_SHARING_STOPPED,data:r.id,hidden:!n}})}function ne(e,t,n,r){var o;ee(e,t,n?r:null);!!(null==(o=e.devices[$(r)])?void 0:o.sharedUrl)!==n&&t({type:a.E_ACTION.SET_MEDIA_SHARER,participantId:r,isMediaSharingEnabled:n})}function re(e,t,n=!1){return!n&&e({type:a.E_ACTION.SET_LOCAL_DEVICE,data:{sharedUrl:void 0,streamMode:se(t,i.MediaType.SHARED_URL)}}),(0,i.stopUrlSharing)()}function ae(e,t){const n=$(t);return e.getState().devices[n]}function oe(e,t,n){if(!t)return e;const{streamMode:r}=t;switch(e){case i.MediaType.STREAM:case i.MediaType.SHARED_URL:case i.MediaType.MOVIE:return le(e,t,n);case i.MediaType.SCREEN:return r===i.MediaType.MOVIE||r===i.MediaType.STREAM||r===i.MediaType.SHARED_URL?r:le(e,t,n);case i.MediaType.CAMERA:return r===i.MediaType.MOVIE||r===i.MediaType.STREAM||r===i.MediaType.SCREEN||r===i.MediaType.SHARED_URL?r:le(e,t,n);default:return null}}function ie(e){const t=[];return e.sharedUrl&&t.push(i.MediaType.SHARED_URL),e.movieStreamInfo&&e.movieStream&&t.push(e.movieStreamInfo.source),e.mediaSettings.isScreenSharingEnabled&&e.screenSharingStream&&t.push(i.MediaType.SCREEN),(e.mediaSettings.isVideoEnabled&&e.stream||e.mediaSettings.isAnimojiEnabled&&(e.animojiStream||e.stream))&&t.push(i.MediaType.CAMERA),t}function se(e,t){return ie(e).filter((e=>e!==t))[0]||null}function le(e,t,n){return n?e:se(t,e)}function ce(e,t,n=t.mediaSettings){switch(e){case i.MediaType.STREAM:case i.MediaType.MOVIE:return!(!t.movieStream||!t.movieStreamInfo);case i.MediaType.SCREEN:return!(!t.screenSharingStream||!n.isScreenSharingEnabled);case i.MediaType.CAMERA:return!!(t.stream&&n.isVideoEnabled||(t.animojiStream||t.stream)&&n.isAnimojiEnabled);default:return!1}}function de(e,t){const n={mediaSettings:e};return t?(e.isVideoEnabled||e.isAnimojiEnabled||t.streamMode!==i.MediaType.CAMERA||(n.streamMode=oe(i.MediaType.CAMERA,t,!1)),e.isScreenSharingEnabled||t.streamMode!==i.MediaType.SCREEN||(n.streamMode=oe(i.MediaType.SCREEN,t,!1)),t.streamMode||(e.isScreenSharingEnabled&&t.screenSharingStream?n.streamMode=oe(i.MediaType.SCREEN,t,!0):(e.isVideoEnabled&&t.stream||e.isAnimojiEnabled&&(t.stream||t.animojiStream))&&(n.streamMode=oe(i.MediaType.CAMERA,t,!0))),n):n}const ue=e=>e.length?e[0]:""},438655:(e,t,n)=>{n.d(t,{changeParticipantRoom:()=>m,equalsToMyRoom:()=>u,findRelatedRoom:()=>p,isInMyRoom:()=>d,roomIdToString:()=>c});var r=n(22412),a=n(832856),o=n(971),i=n(963645),s=n(732297),l=n(495457);const c=e=>String(e),d=e=>{const t=o.GlobalStore.getCallsStore().getState(),n=t.rooms.roomParticipantIds[c(t.rooms.roomId)];return n&&n.some((t=>(0,a.isSameExternalId)(t,e)))},u=(e,t)=>{const n=(0,i.getRoomId)(e);return!n&&!t||n===t},p=(e,t)=>Object.values(t).find((t=>t.participantIds.some((t=>(0,a.isSameExternalId)(t,e))))),m=(e,t,n,a,o=!1,i,c,d)=>{if(o)e.switchRoom(n,a);else{const r=[],o=p(a,t);o&&r.push({id:o.id,removeParticipantIds:[a]}),n&&r.push({id:n,addParticipantIds:[a]}),e.updateRooms(r)}c&&d&&s.callStats.logEvent({call_event_type:r.CallActionEventType.SESSION_ROOMS_MANUAL_ALLOCATION,session_id:c,device_id:i,peer_id:d,is_group_call:(0,l.isGroupCallByPeer)(d)})}},455319:(e,t,n)=>{n.d(t,{createFriendsCache:()=>f,getExternalIdByUserId:()=>S,getMemberForUserStack:()=>I,getUserName:()=>v,getUserShortName:()=>E,isEmptyPeerId:()=>u,isIPeerId:()=>c,mapExternalIdsToPeerIds:()=>y,mergeGroupToParticipant:()=>h,normalizeGroup:()=>_,normalizeUser:()=>g,peerIdToVkId:()=>d,vkIdToPeerId:()=>p});var r=n(434788),a=n(22412),o=n(878198),i=n(659397),s=n(832856),l=n(464380);const c=e=>"string"==typeof e,d=e=>Number(e),u=e=>e===a.EMPTY_PEER_ID,p=e=>0===e?a.EMPTY_PEER_ID:String(e),m=(e,t)=>t in e?e[t]:void 0,g=e=>{var t,n;const{id:r,photo_50:a,photo_100:l,photo_400:c,photo_200:d}=e,u=m(e,"custom_names_for_calls");let g=m(e,"first_name"),_=m(e,"last_name");const f=m(e,"name"),h=m(e,"screen_name");var S;g=null!=(S=null!=g?g:f)?S:"",_=null!=_?_:"",(0,s.isParticipantGroup)(r)&&(g=(0,i.escape)(g));const I=f||`${g}${g&&_?" ":""}${_}`;let v;h?v=`/${h}`:(0,s.isParticipantAnonym)(r)||(0,s.isParticipantGroup)(r)||(v=`/id${r}`);const E={canCall:m(e,"can_call"),firstName:g,id:r,is_nft:m(e,"is_nft"),lastName:_,link:v,name:I,photo:c||d||l||a,peerId:p(r),sex:m(e,"sex"),shortName:(0,o.fetchUserShortName)(g,_,f)},y=m(e,"animated_avatar");y&&(E.animated_avatar=y);const T=m(e,"online_info");return T&&(E.onlineInfo=T),(null==(n=u)||null==(t=n[0])?void 0:t.name)&&(E.customName=u[0].name),E},_=({id:e,name:t,screen_name:n,photo_400:r,photo_200:a,photo_100:o})=>({id:-e,peerId:p(-e),name:(0,i.escape)(null!=t?t:""),firstName:"",lastName:"",shortName:"",link:n&&`/${n}`,photo:r||a||o,photo_100:o});function f(e){return e.reduce(((e,t)=>(e[t.id]=!0,e)),{})}function h(e,t){let n=(0,r._)({},t);return e.photo&&(n.photo=e.photo),e.name&&(n.name=e.name),e.link&&(n.link=e.link),n}function S(e){let t=l.ExternalIdType.USER;return(0,s.isParticipantGroup)(e)&&(t=l.ExternalIdType.GROUP),{id:e.toString(),type:t}}function I(e){const t=e.name||"";return e.photo?{src:e.photo,alt:t,key:e.peerId}:{id:d(e.peerId),text:t.slice(0,1)}}const v=e=>{var t,n,r;const a=(null==(t=e)?void 0:t.customName)||(null==(n=e)?void 0:n.name)||(null==(r=e)?void 0:r.shortName)||"";return(0,i.decodeHTMLEntities)(a)},E=e=>{var t,n,r;const a=(null==(t=e)?void 0:t.customName)||(null==(n=e)?void 0:n.shortName)||(null==(r=e)?void 0:r.name)||"";return(0,i.decodeHTMLEntities)(a)},y=e=>e.map((e=>e.id))},971:(e,t,n)=>{n.d(t,{GlobalStore:()=>r});class r{static setCallsStore(e){r._callsStore=e}static getCallsStore(){if(!r._callsStore)throw new Error("store was not initiated!");return r._callsStore}static isSet(){return Boolean(r._callsStore)}static getCallsState(){return r.getCallsStore().getState()}}r._callsStore=null},174583:(e,t,n)=>{n.d(t,{getAsrState:()=>r});const r=e=>e.asr},826113:(e,t,n)=>{n.d(t,{getCallData:()=>r,getCallId:()=>a});const r=e=>e.callData,a=e=>e.callData.callId},974:(e,t,n)=>{n.d(t,{getAnonymSecret:()=>_,getCallByName:()=>O,getCallTopology:()=>p,getDevices:()=>d,getFeatureNotification:()=>u,getIsMeAdmin:()=>f,getIsMeAnonym:()=>h,getIsMyScreenShare:()=>v,getIsRestrictedConversation:()=>S,getIsVoiceRoom:()=>M,getLocalVideoResolution:()=>y,getMeGroup:()=>s,getMyDevice:()=>i,getMyExternalId:()=>o,getMyId:()=>m,getMyMediaSettings:()=>l,getNoiseCancellation:()=>E,getNotification:()=>R,getParticipants:()=>c,getPeerId:()=>g,getPinnedParticipant:()=>b,getScreenShare:()=>C,getScreenShareOwner:()=>I,getSpeakers:()=>A,getTooltips:()=>P,getVkIdToDevices:()=>T});var r=n(22412),a=n(832856);const o=e=>e.externalId,i=e=>e.localDevice,s=e=>e.meGroup,l=e=>e.localDevice.mediaSettings,c=e=>e.participants,d=e=>e.devices,u=e=>e.featureNotification,p=e=>e.callData.topology,m=e=>e.me,g=e=>e.peer,_=e=>e.anonymSecret,f=e=>(0,a.participantIsAdmin)(e.localDevice),h=e=>(0,a.isParticipantAnonym)(e.me),S=e=>e.restrictedConversation,I=e=>{var t;return null==(t=e.screenShare)?void 0:t.owner},v=e=>(0,a.isSameExternalId)(o(e),I(e)),E=e=>e.noiseCancellation,y=e=>e.localVideoResolution,T=e=>e.maps.vkIdToDevices,R=e=>e.notification,b=e=>e.pinnedParticipant,P=e=>e.tooltips,A=e=>e.speakers,C=e=>e.screenShare,M=e=>e.callUiMode===r.ECallUiMode.voiceRoom,O=e=>e.callByName},430065:(e,t,n)=>{n.d(t,{getBrowserWarnings:()=>c,getIsAsrFeatureEnabled:()=>a,getIsAsrListFeatureEnabled:()=>o,getIsAsrShown:()=>i,getIsDesktopAppNotification:()=>l,getIsSferum:()=>s,getStateConfig:()=>r});const r=e=>e.config,a=e=>e.config.enableAsr,o=e=>{const{enableAsrListSferum:t,enableAsrList:n,sferum:r}=e.config;return!r&&n||r&&t},i=e=>Boolean(e.asr)&&Boolean(a(e)),s=e=>e.config.sferum,l=e=>e.config.desktopAppNotification,c=e=>e.config.browserWarnings},963645:(e,t,n)=>{n.d(t,{getAnonymSecret:()=>o.getAnonymSecret,getAsrState:()=>r.getAsrState,getBrowserWarnings:()=>i.getBrowserWarnings,getCallByName:()=>o.getCallByName,getCallData:()=>a.getCallData,getCallId:()=>a.getCallId,getCallTopology:()=>o.getCallTopology,getDevices:()=>o.getDevices,getFeatureNotification:()=>o.getFeatureNotification,getIsAsrFeatureEnabled:()=>i.getIsAsrFeatureEnabled,getIsAsrListFeatureEnabled:()=>i.getIsAsrListFeatureEnabled,getIsAsrShown:()=>i.getIsAsrShown,getIsDesktopAppNotification:()=>i.getIsDesktopAppNotification,getIsMeAdmin:()=>o.getIsMeAdmin,getIsMeAnonym:()=>o.getIsMeAnonym,getIsMyScreenShare:()=>o.getIsMyScreenShare,getIsOnboardingBannerOpen:()=>s.getIsOnboardingBannerOpen,getIsRestrictedConversation:()=>o.getIsRestrictedConversation,getIsSferum:()=>i.getIsSferum,getIsVoiceRoom:()=>o.getIsVoiceRoom,getLocalVideoResolution:()=>o.getLocalVideoResolution,getMeGroup:()=>o.getMeGroup,getMyDevice:()=>o.getMyDevice,getMyExternalId:()=>o.getMyExternalId,getMyId:()=>o.getMyId,getMyMediaSettings:()=>o.getMyMediaSettings,getNoiseCancellation:()=>o.getNoiseCancellation,getNotification:()=>o.getNotification,getParticipants:()=>o.getParticipants,getPeerId:()=>o.getPeerId,getPinnedParticipant:()=>o.getPinnedParticipant,getReactionsHistoryState:()=>l.getReactionsHistoryState,getReactionsIcons:()=>l.getReactionsIcons,getRoomId:()=>c.getRoomId,getRooms:()=>c.getRooms,getScreenShare:()=>o.getScreenShare,getScreenShareOwner:()=>o.getScreenShareOwner,getSpeakers:()=>o.getSpeakers,getStateConfig:()=>i.getStateConfig,getTooltips:()=>o.getTooltips,getVkIdToDevices:()=>o.getVkIdToDevices,getWatchTogetherDevice:()=>d.getWatchTogetherDevice,getWatchTogetherInfo:()=>d.getWatchTogetherInfo,getWatchTogetherMovieState:()=>d.getWatchTogetherMovieState,getWatchTogetherOwner:()=>d.getWatchTogetherOwner,getWatchTogetherPinnedParticipant:()=>d.getWatchTogetherPinnedParticipant});var r=n(174583),a=n(826113),o=n(974),i=n(430065),s=n(952260),l=n(399625),c=n(366854),d=n(743679)},952260:(e,t,n)=>{n.d(t,{getIsOnboardingBannerOpen:()=>r});const r=e=>e.onboarding.isOnboardingBannerOpen},399625:(e,t,n)=>{n.d(t,{getReactionsHistoryState:()=>a,getReactionsIcons:()=>r});const r=e=>{var t;return null==(t=e.reactions)?void 0:t.reactions},a=e=>{const t=(e=>{var t;return null==(t=e.reactions)?void 0:t.feedbackHistory})(e),n=Object.values(t||{}),r=n.length,a=[],o={};n.forEach((e=>{const{key:t,peerId:n}=e;o[t]||(o[t]=new Set),a.push(n),o[t].add(n)}));const i=Object.entries(o).sort(((e,t)=>e[1].size>t[1].size?-1:1)).slice(0,3).map((e=>e[0]));return{total:r,reactionsKeysMap:o,userIds:a,popularReactions:i}}},366854:(e,t,n)=>{n.d(t,{getRoomId:()=>r,getRooms:()=>a});const r=e=>e.rooms.roomId,a=e=>e.rooms},743679:(e,t,n)=>{n.d(t,{getWatchTogetherDevice:()=>l,getWatchTogetherInfo:()=>i,getWatchTogetherMovieState:()=>s,getWatchTogetherOwner:()=>o,getWatchTogetherPinnedParticipant:()=>a});var r=n(832856);const a=e=>{var t,n;return null!=(n=null==(t=e.watchTogether)?void 0:t.pinnedParticipant)?n:null},o=e=>{var t,n;return null!=(n=null==(t=e.watchTogether)?void 0:t.owner)?n:null},i=e=>{var t,n;return null!=(n=null==(t=e.watchTogether)?void 0:t.movieInfo)?n:null},s=e=>{var t,n;return null!=(n=null==(t=e.watchTogether)?void 0:t.movieState)?n:null},l=e=>{var t;const n=null==(t=e.watchTogether)?void 0:t.owner;return n?(0,r.isSameExternalId)(n,e.externalId)?e.localDevice:e.devices[(0,r.externalIdToString)(n)]:null}},227336:(e,t,n)=>{n.d(t,{screenShareNotVisibleStat:()=>u,useScreenShareNotVisibleStat:()=>p,useVisibleDeviceScreenShareNotVisibleStat:()=>m});var r=n(667294),a=n(464380),o=n(659397),i=n(732297),s=n(971),l=n(22412),c=n(495457),d=n(832856);const u=new class{init(){const e=s.GlobalStore.getCallsState();this._isEnabled=!!e.config.enableScreenShareNotVisibleStat}destroy(){for(const e of this._timers.values())clearTimeout(e.timer);this._timers.clear()}checkLayoutDiff(e){if(this._isEnabled)for(const t of e){if((0,o.isString)(t.uid))continue;if(t.mediaType!==a.MediaType.SCREEN)continue;const e=(0,d.externalIdToString)(t.uid);"stopStream"in t?this._clearMark(e):this._mark(e)}}measure(e){this._isEnabled&&this._collectStat((0,d.externalIdToString)(e))}_mark(e){this._clearMark(e),this._timers.set(e,{timer:setTimeout(this._collectStat.bind(this,e),3e4),ts:Date.now()})}_clearMark(e){this._getTimerValue(e)}_getTimerValue(e){const t=this._timers.get(e);return t?(clearTimeout(t.timer),this._timers.delete(e),t.ts):null}_collectStat(e){const t=this._getTimerValue(e);if(null===t)return;const n=Date.now()-t;if(n<1e4)return;const r=s.GlobalStore.getCallsState();i.callStats.logEvent({call_event_type:l.CallActionEventType.SCREEN_SHARE_NOT_VISIBLE,is_group_call:(0,c.isGroupCallByPeer)(r.peer),peer_id:r.peer,session_id:r.callData.callId,device_id:r.config.deviceId,event_param:n})}constructor(){this._timers=new Map,this._isEnabled=!1}};function p(e){(0,r.useEffect)((()=>{if(e)return u.init(),()=>u.destroy()}),[e])}function m(e){(0,r.useEffect)((()=>{e&&e.screenSharingStream&&u.measure(e.externalId)}),[e])}},732297:(e,t,n)=>{n.d(t,{callStats:()=>i});var r=n(434788),a=n(832856);const o="type_voip_call_item";const i=new class{setActionStatCollector(e){this.actionStatCollector=e}setEventCommonData(e={}){this.eventCommonData=e}logEvent(e){var t;const n=e.peer_id,i=(0,a.isParticipantGroup)(n)?n:0,s=(0,r._)({},e,{peer_id:null==(t=e.peer_id)?void 0:t.toString(),session_id:e.session_id||"",lib_version:"calls_v2",group_id:i,device_id:e.device_id||""},this.eventCommonData);this.actionStatCollector&&this.actionStatCollector.logEvent({type:o,[o]:s})}constructor(){this.eventCommonData={}}}},427164:(e,t,n)=>{n.d(t,{default:()=>o});var r,a=n(310396);e=n.hmd(e),r="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==n.g?n.g:e;const o=(0,a.default)(r)},310396:(e,t,n)=>{function r(e){var t,n=e.Symbol;return"function"==typeof n?n.observable?t=n.observable:(t=n("observable"),n.observable=t):t="@@observable",t}n.d(t,{default:()=>r})}}]);try{stManager.done("dist/web/chunks/fe894d6c.937dff90.js")}catch(e){}