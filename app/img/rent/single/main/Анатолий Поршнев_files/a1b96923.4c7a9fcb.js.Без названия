"use strict";(self.webpackChunkvkweb=self.webpackChunkvkweb||[]).push([[12163],{789862:(e,t,r)=>{r.d(t,{Icon16LockOutline:()=>i});var i=(0,r(28178).makeIcon)("Icon16LockOutline","lock_outline_16","0 0 16 16",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16" id="lock_outline_16"><path fill="currentColor" fill-rule="evenodd" d="M2 10c0-1.4 0-2.1.273-2.635a2.5 2.5 0 0 1 1.092-1.093c.297-.15.645-.218 1.135-.248V4.5a3.5 3.5 0 1 1 7 0v1.524c.49.03.838.097 1.135.249a2.5 2.5 0 0 1 1.093 1.092C14 7.9 14 8.6 14 10v1c0 1.4 0 2.1-.272 2.635a2.5 2.5 0 0 1-1.093 1.093C12.1 15 11.4 15 10 15H6c-1.4 0-2.1 0-2.635-.272a2.5 2.5 0 0 1-1.092-1.093C2 13.1 2 12.4 2 11zm8-2.5H6c-.725 0-1.178.001-1.52.029-.324.027-.413.07-.434.08a1 1 0 0 0-.437.437c-.01.02-.053.11-.08.434-.028.342-.029.795-.029 1.52v1c0 .725.001 1.178.029 1.52.027.324.07.413.08.434a1 1 0 0 0 .437.437c.02.01.11.053.434.08.342.028.795.029 1.52.029h4c.725 0 1.178-.001 1.52-.03.324-.026.413-.069.434-.079a1 1 0 0 0 .437-.437c.01-.02.053-.11.08-.434.028-.342.029-.795.029-1.52v-1c0-.725-.001-1.178-.03-1.52-.026-.324-.069-.413-.079-.434a1 1 0 0 0-.437-.437c-.02-.01-.11-.053-.434-.08-.342-.028-.795-.029-1.52-.029M10 6H6V4.5a2 2 0 1 1 4 0z" clip-rule="evenodd" /></symbol>',16,16,!1,void 0)},846369:(e,t,r)=>{r.d(t,{Icon16UnlockOutline:()=>i});var i=(0,r(28178).makeIcon)("Icon16UnlockOutline","unlock_outline_16","0 0 16 16",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16" id="unlock_outline_16"><path fill="currentColor" fill-rule="evenodd" d="M2 10c0-1.4 0-2.1.273-2.635a2.5 2.5 0 0 1 1.092-1.093c.297-.15.645-.218 1.135-.248V4.5a3.5 3.5 0 0 1 6.867-.957.75.75 0 1 1-1.443.41A2 2 0 0 0 6 4.5V6h4c1.4 0 2.1 0 2.635.273a2.5 2.5 0 0 1 1.093 1.092C14 7.9 14 8.6 14 10v1c0 1.4 0 2.1-.272 2.635a2.5 2.5 0 0 1-1.093 1.093C12.1 15 11.4 15 10 15H6c-1.4 0-2.1 0-2.635-.272a2.5 2.5 0 0 1-1.092-1.093C2 13.1 2 12.4 2 11zm8-2.5H6c-.725 0-1.178.001-1.52.029-.324.027-.413.07-.434.08a1 1 0 0 0-.437.437c-.01.02-.053.11-.08.434-.028.342-.029.795-.029 1.52v1c0 .725.001 1.178.029 1.52.027.324.07.413.08.434a1 1 0 0 0 .437.437c.02.01.11.053.434.08.342.028.795.029 1.52.029h4c.725 0 1.178-.001 1.52-.03.324-.026.413-.069.434-.079a1 1 0 0 0 .437-.437c.01-.02.053-.11.08-.434.028-.342.029-.795.029-1.52v-1c0-.725-.001-1.178-.03-1.52-.026-.324-.069-.413-.079-.434a1 1 0 0 0-.437-.437c-.02-.01-.11-.053-.434-.08-.342-.028-.795-.029-1.52-.029" clip-rule="evenodd" /></symbol>',16,16,!1,void 0)},36193:(e,t,r)=>{r.d(t,{Icon20Add:()=>i});var i=(0,r(28178).makeIcon)("Icon20Add","add_20","0 0 20 20",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20" id="add_20"><path fill-rule="evenodd" d="M10 3a.75.75 0 0 1 .75.75v5.5h5.5a.75.75 0 0 1 0 1.5h-5.5v5.5a.75.75 0 0 1-1.5 0v-5.5h-5.5a.75.75 0 0 1 0-1.5h5.5v-5.5A.75.75 0 0 1 10 3" clip-rule="evenodd" /></symbol>',20,20,!1,void 0)},445264:(e,t,r)=>{r.d(t,{Icon20CheckAlt:()=>i});var i=(0,r(28178).makeIcon)("Icon20CheckAlt","check_alt_20","0 0 20 20",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20" id="check_alt_20"><path fill-rule="evenodd" d="M16.659 5.344a1.162 1.162 0 0 1 0 1.645L8.82 14.812a1.167 1.167 0 0 1-1.649 0l-3.83-3.823a1.162 1.162 0 0 1 0-1.646 1.167 1.167 0 0 1 1.648 0l3.007 3 7.013-7a1.167 1.167 0 0 1 1.649 0Z" clip-rule="evenodd" /></symbol>',20,20,!1,void 0)},29157:(e,t,r)=>{r.d(t,{Icon20CheckCircleOff:()=>i});var i=(0,r(28178).makeIcon)("Icon20CheckCircleOff","check_circle_off_20","0 0 20 20",'<symbol xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="none" viewBox="0 0 20 20" id="check_circle_off_20"><defs><path id="check_circle_off_20_a" fill="currentColor" fill-rule="evenodd" d="M10 20c5.523 0 10-4.477 10-10S15.523 0 10 0 0 4.477 0 10s4.477 10 10 10m0-1a9 9 0 1 0 0-18 9 9 0 0 0 0 18" clip-rule="evenodd" /></defs><use xlink:href="#check_circle_off_20_a" fill-rule="evenodd" clip-rule="evenodd" /><use xlink:href="#check_circle_off_20_a" fill-rule="evenodd" clip-rule="evenodd" /></symbol>',20,20,!1,void 0)},910301:(e,t,r)=>{r.d(t,{Icon24ClockOutline:()=>i});var i=(0,r(28178).makeIcon)("Icon24ClockOutline","clock_outline_24","0 0 24 24",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24" id="clock_outline_24"><path d="M12.4 8a.9.9 0 1 0-1.8 0v4.5a.9.9 0 0 0 .584.843l4 1.5a.9.9 0 0 0 .632-1.686l-3.416-1.28z" /><path fill-rule="evenodd" d="M12 2.1c-5.468 0-9.9 4.432-9.9 9.9s4.432 9.9 9.9 9.9 9.9-4.432 9.9-9.9-4.432-9.9-9.9-9.9M3.9 12a8.1 8.1 0 1 1 16.2 0 8.1 8.1 0 0 1-16.2 0" clip-rule="evenodd" /></symbol>',24,24,!1,void 0)},641899:(e,t,r)=>{r.d(t,{Icon24FavoriteOutline:()=>i});var i=(0,r(28178).makeIcon)("Icon24FavoriteOutline","favorite_outline_24","0 0 24 24",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24" id="favorite_outline_24"><path fill-rule="evenodd" d="M12.554 4.694a.6.6 0 0 0-1.108 0l-1.614 3.9a.9.9 0 0 1-.774.554l-4.125.266a.6.6 0 0 0-.357 1.05l3.267 2.859a.9.9 0 0 1 .282.888l-.93 3.852a.6.6 0 0 0 .883.66l3.472-2.003a.9.9 0 0 1 .9 0l3.472 2.004a.6.6 0 0 0 .883-.661l-.93-3.852a.9.9 0 0 1 .282-.888l3.267-2.858a.6.6 0 0 0-.357-1.05l-4.125-.267a.9.9 0 0 1-.774-.554zm-2.772-.689c.818-1.976 3.618-1.976 4.436 0l1.4 3.383 3.565.23c2.136.138 3.037 2.792 1.426 4.201l-2.856 2.5.802 3.322c.494 2.05-1.706 3.696-3.533 2.642L12 18.539l-3.022 1.744C7.15 21.337 4.95 19.69 5.445 17.64l.802-3.322-2.856-2.5c-1.611-1.41-.71-4.063 1.426-4.201l3.566-.23z" clip-rule="evenodd" /></symbol>',24,24,!1,void 0)},644854:(e,t,r)=>{r.d(t,{Icon24UnfavoriteOutline:()=>i});var i=(0,r(28178).makeIcon)("Icon24UnfavoriteOutline","unfavorite_outline_24","0 0 24 24",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24" id="unfavorite_outline_24"><path fill-rule="evenodd" d="M9.782 4.005c.818-1.976 3.618-1.976 4.436 0l1.4 3.383 3.565.23c2.136.138 3.037 2.792 1.426 4.201l-1.477 1.292a.9.9 0 0 1-1.185-1.354l1.477-1.292a.6.6 0 0 0-.357-1.05l-4.125-.267a.9.9 0 0 1-.774-.554l-1.614-3.9a.6.6 0 0 0-1.108 0c-.204.492-.68.835-1.227.609-.545-.226-.64-.805-.437-1.298M12 18.539l3.022 1.744c1.456.84 3.149-.035 3.526-1.462l1.416 1.415a.9.9 0 1 0 1.272-1.272l-15.2-15.2a.9.9 0 0 0-1.272 1.272l2.428 2.429-2.375.153C2.68 7.756 1.78 10.41 3.39 11.819l2.856 2.5-.802 3.322c-.495 2.05 1.706 3.696 3.533 2.642zM4.933 9.414a.6.6 0 0 0-.357 1.05l3.267 2.859a.9.9 0 0 1 .282.888l-.93 3.852a.6.6 0 0 0 .883.66l3.472-2.003a.9.9 0 0 1 .9 0l3.472 2.004a.6.6 0 0 0 .883-.661l-.284-1.176a.9.9 0 0 1-.02-.113L8.886 9.159z" clip-rule="evenodd" /></symbol>',24,24,!1,void 0)},376175:(e,t,r)=>{r.d(t,{Icon28AddOutline:()=>i});var i=(0,r(28178).makeIcon)("Icon28AddOutline","add_outline_28","0 0 28 28",'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" id="add_outline_28"><g fill="none" fill-rule="evenodd"><path d="M0 0h28v28H0z" /><path fill="currentColor" fill-rule="nonzero" d="M14 4a1 1 0 0 1 1 1v8h8a1 1 0 0 1 0 2h-8v8a1 1 0 0 1-2 0v-8H5a1 1 0 0 1 0-2h8V5a1 1 0 0 1 1-1" /></g></symbol>',28,28,!1,void 0)},899727:(e,t,r)=>{r.d(t,{default:()=>i});const i={playlistPrivateIcon:"VideoPlaylistsModal-module__playlistPrivateIcon--xMfjH",playlistSubhead:"VideoPlaylistsModal-module__playlistSubhead--oO2Bo",scrollHeight:"VideoPlaylistsModal-module__scrollHeight--NBBTF"}},28219:(e,t,r)=>{r.d(t,{useLazyLoad:()=>n});var i=r(667294),o=r(662273);const n=(e,t,r=window,n)=>{(0,i.useEffect)((()=>{let i;if(r)return e?(i=(0,o.throttle)((()=>{const e=r instanceof Window?Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight):Math.max(r.scrollHeight,r.clientHeight),i=r instanceof Window?document.documentElement.clientHeight:r.clientHeight,o=r instanceof Window?r.scrollY:r.scrollTop,l=i+o,s=Math.max(e-2*i,0);var a;(!n&&l>=s||n&&o<i/2)&&(null==(a=t)||a())}),34),i(),r.addEventListener("scroll",i)):i&&r.removeEventListener("scroll",i),()=>{i&&r.removeEventListener("scroll",i)}}),[e,t,r,n])}},738007:(e,t,r)=>{r.d(t,{getAPIErrorMessage:()=>o,isRequestAbortError:()=>n});var i=r(29271);const o=e=>e.error_text||e.error_msg||i.getLang("global_unknown_error"),n=e=>e instanceof DOMException&&(20===e.code||"AbortError"===e.name)},329282:(e,t,r)=>{r.d(t,{PlaylistCheckbox:()=>g});var i=r(785893),o=r(504190),n=r(846369),l=r(789862),s=r(352755),a=r(281848),c=r(622284),d=r(369251),u=r(629932),v=r(29271),m=r(259255),p=r(899727);const f={all:(0,i.jsx)(c.TextTooltip,{placement:"top",appearance:"black",offsetSkidding:-56,offsetDistance:4,text:v.getLang("video_playlist_available_to_all_tooltip"),children:(0,i.jsx)(n.Icon16UnlockOutline,{className:p.default.playlistPrivateIcon})}),only_me:(0,i.jsx)(c.TextTooltip,{placement:"top",appearance:"black",offsetSkidding:-56,offsetDistance:4,text:v.getLang("video_playlist_private_tooltip"),children:(0,i.jsx)(l.Icon16LockOutline,{className:p.default.playlistPrivateIcon})})},g=({playlistId:e,videoId:t,videoPlaylistsModalService:r})=>{var n,l;const c=(0,s.useEntitiesStore)(r.$entitiesPlaylists,e),{itemId:v}=(0,a.splitRawId)(e),p=(0,m.useVideoInPlaylist)(r.$entitiesVideoBinding,t,v),g=(0,o.useEvent)(r.toggleBindingEvent);return c?(0,i.jsx)(d.Checkbox,{checked:p,onChange:()=>g({album_id:v,video_id:t}),titleAfter:(null==(l=c)||null==(n=l.privacy)?void 0:n.category)&&f[c.privacy.category],children:(0,i.jsx)(u.TextClamp,{lines:1,children:c.title})}):null}},335996:(e,t,r)=>{r.d(t,{showPlaylistsModal:()=>V});var i=r(434788),o=r(785893),n=r(504190),l=r(667294),s=r(376175),a=r(86894),c=r(816511),d=r(400856),u=r(685371),v=r(369251),m=r(461629),p=r(545637),f=r(342787),g=r(126116),S=r(832550),b=r(29271),y=r(292063),_=r(28219),E=r(359639),w=r(362246),I=r(329282),k=r(899727);const h=({video:e,ownerId:t,onClose:r,refreshCoordinates:i,videoPlaylistsModalService:E})=>{var h;const V=(0,n.useEvent)(E.initModalEvent),A=(0,n.useStore)(E.$videosAlbumsLoading),x=(0,n.useStore)(E.$videosAlbumsIds),F=(0,n.useEvent)(E.toggleBindingEvent),$=(0,n.useEvent)(E.saveChangesEvent),P=(0,n.useEvent)(E.fetchMorePlaylists),C=(0,n.useEvent)(E.resetBindingsEvent),B=(0,n.useStore)(E.$wasToggled);(0,l.useEffect)((()=>{i(),C()}),[]),(0,l.useEffect)((()=>{V({ownerId:t,videoId:e.id,videoOwnerId:e.owner_id})}),[]);const R=(0,y.useVideoInPlaylist)(E.$entitiesVideoBinding,e.id,y.MY_VIDEO_ALBUM_ID);return(0,_.useLazyLoad)(!0,P),(0,o.jsxs)(c.ModalBox,{children:[(0,o.jsx)(d.ModalHeader,{closeAriaLabel:b.getLang("box_cancel"),onClose:r,children:b.getLang("video_playlist_modal_header")}),(0,o.jsxs)(u.ModalBody,{insetLevel:1,children:[!A&&(0,o.jsx)(v.Checkbox,{checked:R,onChange:()=>{F({video_id:e.id,album_id:y.MY_VIDEO_ALBUM_ID})},children:b.getLang("video_add_video_to_added_videos_section")}),!!x&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(a.Spacing,{size:8}),(0,o.jsx)(m.Separator,{}),(0,o.jsx)(a.Spacing,{size:4}),(0,o.jsx)(p.Div,{mode:"vertical",spacing:8,children:(0,o.jsx)(a.Footnote,{className:k.default.playlistSubhead,weight:"3",children:b.getLang("video_playlists")})})]}),(A||!x||!(null==(h=x)?void 0:h.length))&&(0,o.jsx)("div",{className:k.default.scrollHeight,children:(0,o.jsx)(a.Spinner,{})}),!!x&&!A&&(0,o.jsx)(f.ModalScrollView,{height:140,maxHeight:140,children:x.map((t=>(0,o.jsx)(I.PlaylistCheckbox,{playlistId:t,videoId:e.id,videoPlaylistsModalService:E},t)))}),(0,o.jsx)(a.CellButton,{onClick:i=>{r(),(0,w.createPlaylistPopup)(i,t,e.id,e.owner_id,w.CreatePlaylistRequestOrigin.VIDEO_PLAYLISTS_MODAL)},before:(0,o.jsx)(s.Icon28AddOutline,{}),children:b.getLang("video_add_video_to_new_playlist")})]}),(0,o.jsx)(g.ModalFooter,{actionButtons:[(0,o.jsx)(S.Button,{mode:"secondary",size:"m",onClick:r,children:b.getLang("box_cancel")},1),(0,o.jsx)(S.Button,{mode:"primary",size:"m",onClick:()=>{$(),r()},disabled:!B,children:b.getLang("Save")},2)]})]})},V=({onDestroy:e,ownerId:t,video:r,videoPlaylistsModalService:n})=>{(0,E.showMessageBoxModal)((e=>(0,o.jsx)(h,(0,i._)({ownerId:t,video:r,videoPlaylistsModalService:n},e))),{onDestroy:e,width:420})}},651495:(e,t,r)=>{r.d(t,{createVideoPlaylistsModalService:()=>v});var i=r(785893),o=r(555888),n=r(759336),l=r(838740),s=r(29271),a=r(798116),c=r(390433),d=r(499610),u=r(292063);const v=e=>{const t=e.createEvent(),r=(0,a.restore)(t,null),v=e.createEvent(),m=(0,a.restore)(v,null),p=e.createEvent(),f=(0,a.restore)(p,null),g=e.createStore(!1),S=e.createEvent(),b=(0,o.createEntitiesVideoAlbumService)({domain:e}),y=(0,n.createListsVideosAlbumsService)({domain:e,entitiesVideoAlbumService:b}),{$listIds:_,$loading:E}=y.selectStores(r.map((e=>e||""))),w=(0,l.createVideoGetAlbumsByVideoFx)({domain:e}),I=(0,l.createVideoAddToAlbumFx)({domain:e}),k=(0,l.createVideoRemoveFromAlbumFx)({domain:e}),h=e.createEvent(),V=e.createEvent(),A=e.createEvent(),{$entitiesVideoBinding:x,addBindingsEvent:F,toggleBindingEvent:$,resetBindingsEvent:P}=(0,u.createVideoBindingsService)(e);return(0,a.sample)({clock:S,fn:({videoId:e})=>e,target:v}),(0,a.sample)({clock:S,fn:({ownerId:e})=>e,target:t}),(0,a.sample)({clock:S,fn:({videoOwnerId:e})=>e,target:p}),(0,a.sample)({clock:S,fn:()=>!1,target:g}),(0,a.sample)({clock:$,fn:()=>!0,target:g}),(0,a.sample)({clock:S,fn:({ownerId:e})=>({query:{owner_id:e,extended:1},controller:new AbortController,entityKey:e}),target:y.fetchVideosAlbumsFx}),(0,a.sample)({clock:S,fn:({ownerId:e,videoId:t,videoOwnerId:r})=>({query:{video_id:t,owner_id:r,target_id:e},controller:new AbortController}),target:w}),(0,a.sample)({clock:w.done,fn:({params:e,result:t})=>({video_id:e.query.video_id,album_ids:t}),target:F}),(0,a.sample)({clock:h,source:{bindings:x,videoId:m},filter:({videoId:e})=>Boolean(e),fn:({bindings:e,videoId:t})=>{const r=[],i=[],o=null!=t?t:0;return Object.keys(e[o]).forEach((t=>{const n=Number(t);if(isNaN(n)||!(n in e[o]))return;e[o][n]?r.push(n):i.push(n)})),{toAdd:r.join(","),toRemove:i.join(",")}},target:V}),(0,a.sample)({clock:h,fn:()=>{(0,c.showSnackbar)({text:s.getLang("video_changes_saved"),before:{content:(0,i.jsx)(d.Icon28ListCheckOutline,{})},timeout:u.SNACKBAR_TIMEOUT}).catch()}}),(0,a.sample)({clock:V,source:{videoId:m,videoOwnerId:f,targetId:r},filter:(e,{toAdd:t})=>Boolean(t),fn:({videoId:e,videoOwnerId:t,targetId:r},{toAdd:i})=>({query:{target_id:null!=r?r:0,owner_id:null!=t?t:0,video_id:null!=e?e:0,album_ids:i},controller:new AbortController}),target:I}),(0,a.sample)({clock:V,source:{videoId:m,videoOwnerId:f,targetId:r},filter:(e,{toRemove:t})=>Boolean(t),fn:({videoId:e,videoOwnerId:t,targetId:r},{toRemove:i})=>({query:{target_id:null!=r?r:0,owner_id:null!=t?t:0,video_id:null!=e?e:0,album_ids:i},controller:new AbortController}),target:k}),(0,a.sample)({clock:A,source:r,filter:e=>Boolean(e),fn:e=>({entityKey:null!=e?e:0}),target:y.fetchMoreVideosAlbumsEvent}),{$entitiesVideoBinding:x,$videosAlbumsIds:_,$entitiesPlaylists:b.$entitiesVideoAlbums,$videosAlbumsLoading:E,toggleBindingEvent:$,resetBindingsEvent:P,initModalEvent:S,saveChangesEvent:h,fetchMorePlaylists:A,removeFromAlbumDoneEvent:k.done,$wasToggled:g}}},94240:(e,t,r)=>{r.d(t,{createVideoPlaylistsModalService:()=>o.createVideoPlaylistsModalService,showPlaylistsModal:()=>i.showPlaylistsModal});var i=r(335996),o=r(651495)},973527:(e,t,r)=>{r.d(t,{createAbortControllersService:()=>l});var i=r(434788),o=r(798116);const n=e=>Array.isArray(e)?e:[e],l=e=>{const t=e.createStore({}),r=e.createEvent(),l=e.createEvent(),s=e.createEvent();return(0,o.sample)({clock:l,source:t,fn:(e,t)=>n(t).reduce(((e,t)=>(e[t]=null,e)),(0,i._)({},e)),target:t}),(0,o.sample)({clock:r,source:t,fn:(e,t)=>(n(t).forEach((t=>{var r;return null==(r=e[t])?void 0:r.abort()})),t),target:l}),(0,o.sample)({clock:s,fn:e=>Object.keys(e),target:r}),(0,o.sample)({clock:s,source:t,fn:(e,t)=>(0,i._)({},e,t),target:t}),{$controllers:t,abortRequestEvent:r,clearControllerEvent:l,setControllerEvent:s}}},444907:(e,t,r)=>{r.d(t,{createAuthorUserService:()=>n});var i=r(798116),o=r(106203);const n=({domain:e,entitiesUsersService:t})=>{const[r,n]=(0,o.createAbortControllerField)(e),l=e.createEvent(),s=e.createStore(""),a=(0,o.combineEntitiesId)(t.$entitiesUsers,s),c=(0,o.combineEntitiesId)(t.$entitiesUsersErrors,s),d=(0,o.combineEntitiesId)(t.$entitiesUsersLoading,s);return(0,i.sample)({clock:l,fn:e=>String(e),target:s}),(0,i.sample)({clock:l,source:r,fn:e=>{var t;return null==(t=e)||t.abort(),new AbortController},target:r}),(0,i.sample)({clock:l,source:r,fn:(e,t)=>({controller:e,query:{fields:"screen_name,photo_50,photo_100,photo_200",user_ids:String(t)}}),target:t.getUsersFx}),{$userData:a,$userError:c,$userLoading:d,getUserEvent:l,abortUserRequestEvent:n}}},574761:(e,t,r)=>{r.d(t,{createCatalogService:()=>c});var i=r(434788),o=r(798116),n=r(202724),l=r(991793),s=r(428846),a=r(106203);const c=({domain:e,entitiesCatalogSectionsService:t,entitiesGroupsService:r,entitiesUsersService:c,entitiesVideoAlbumsService:d,entitiesVideoService:u,entitiesPlaceholdersService:v})=>{const{$entitiesCatalogVideo:m,$entitiesCatalogVideoErrors:p,$entitiesCatalogVideoLoading:f,catalogGetVideoFx:g,updateSectionEvent:S}=(0,n.createEntitiesCatalogVideoService)({domain:e,entitiesCatalogSectionsService:t,entitiesGroupsService:r,entitiesUsersService:c,entitiesVideoAlbumsService:d,entitiesVideoService:u,entitiesPlaceholdersService:v}),b=(0,l.createCurrentSectionService)({domain:e,entitiesCatalogSectionsService:t}),{$replaceBlocksError:y,$loadingBlockId:_,abortReplacementRequestEvent:E,replaceBlocksEvent:w}=(0,s.createBlocksReplacementService)({domain:e,currentSectionService:b,entitiesCatalogSectionsService:t,updateSectionEvent:S}),{$currentSection:I,$currentSectionId:k,$currentSectionError:h,$currentSectionPending:V,abortSectionRequestEvent:A,changeCurrentSectionIdEvent:x,refetchCurrentSectionEvent:F,setCurrentSectionIdEvent:$}=b,P=e.createEvent(),C=e.createEvent(),B=e.createEvent(),R=(0,o.restore)(B,""),L=e.createEvent(),[q,U]=(0,a.createAbortControllerField)(e);(0,o.sample)({clock:L,target:[U,A,E]}),(0,o.sample)({clock:B,target:R});const O=(0,o.sample)({clock:B,fn:e=>({controller:e?new AbortController:null,url:e})});(0,o.sample)({clock:O,fn:({controller:e})=>e,target:U}),(0,o.sample)({clock:O,fn:()=>null,target:[A,E]}),(0,o.sample)({clock:O,filter:({controller:e,url:t})=>Boolean(t&&e),fn:({controller:e,url:t})=>({controller:e,query:{need_blocks:1,owner_id:0,url:t}}),target:g}),(0,o.sample)({clock:[g.done,g.fail],fn:()=>null,target:q}),(0,o.sample)({clock:g.done,fn:e=>{var t;return(null==(t=e.result.catalog)?void 0:t.default_section)||""},target:$});const D=(0,o.combine)({currentSectionId:k,entities:m,url:R},(({currentSectionId:e,entities:t,url:r})=>{const o=null!==r&&t[r];return o?(0,i._)({},o,{default_section:e,sections:[]}):null}));var j;const M=(0,o.combine)({entities:m,url:R},(({entities:e,url:t})=>null!=(j=e[t])?j:null)),G=(0,o.combine)({catalogEntities:f,currentSectionPending:V,url:R},(({catalogEntities:e,currentSectionPending:t,url:r})=>t||e[r]||null)),T=(0,o.combine)({catalogEntities:f,url:R},(({catalogEntities:e,url:t})=>e[t]||!1)),N=(0,o.combine)({catalogEntities:p,currentSectionError:h,replaceBlocksError:y,url:R},(({catalogEntities:e,currentSectionError:t,replaceBlocksError:r,url:i})=>{const o=(0,a.isAbortApiError)(e[i])?null:e[i],n=(0,a.isAbortApiError)(t||null)?null:t;return((0,a.isAbortApiError)(r)?null:r)||n||o||null})),K=(0,o.combine)({currentSectionId:k,deletedAlbums:d.$entitiesVideoDeletedAlbums,sections:t.$entitiesCatalogSections},(({currentSectionId:e,deletedAlbums:t,sections:r})=>{var o;const n=e&&r[e];if(!n)return[];const l=null==(o=n.blocks)?void 0:o.map((e=>{var r;return(0,i._)({},e,{albums_ids:null==(r=e.albums_ids)?void 0:r.filter((e=>!t[e]))})}));return[(0,i._)({},n,{blocks:l})]})),H=(0,o.combine)({catalog:D,sections:t.$entitiesCatalogSections},(({sections:e,catalog:t})=>{var r,i,o;const n=null==(i=t)||null==(r=i.buttons)?void 0:r[0];return(null==(o=n)?void 0:o.section_id)&&e[n.section_id]||null}));var z,W;return(0,o.sample)({clock:P,source:M,filter:e=>{var t;return Boolean(null==(t=e)?void 0:t.sections)},fn:(e,t)=>{var r,i,o;return null!=(z=null==(o=e)||null==(i=o.sections)||null==(r=i.find((e=>e.url===t)))?void 0:r.id)?z:""},target:x}),(0,o.sample)({clock:C,source:H,filter:e=>{var t,r;return Boolean(null==(r=e)||null==(t=r.subsections)?void 0:t.length)},fn:(e,t)=>{var r,i,o;return null!=(W=null==(o=e)||null==(i=o.subsections)||null==(r=i.find((e=>e.url===t)))?void 0:r.id)?W:""},target:x}),{$catalog:M,$catalogGetVideoPending:T,$currentSection:I,$currentSectionId:k,$currentSectionError:h,$currentSectionPending:V,$pageStructureSection:H,$data:D,$error:N,$loadingBlockId:_,$pending:G,$sections:K,abortRequestEvent:L,changeCurrentSectionIdEvent:x,changeCurrentSectionUrlEvent:P,changeCurrentSubsectionUrlEvent:C,changeUrlEvent:B,refetchCurrentSectionEvent:F,replaceBlocksEvent:w,updateSectionEvent:S}}},991793:(e,t,r)=>{r.d(t,{createCurrentSectionService:()=>l});var i=r(820224),o=r(798116),n=r(106203);const l=({domain:e,entitiesCatalogSectionsService:t})=>{const r=e.createEvent(),l=e.createEvent(),s=e.createEvent(),a=(0,o.restore)(s,""),c=e.createStore(!1),[d,u]=(0,n.createAbortControllerField)(e),{$entitiesCatalogSections:v,$entitiesSectionsErrors:m,$entitiesSectionsLoading:p,catalogGetSectionFx:f,setCatalogGetSectionsEvent:g}=t,S=(0,o.attach)({effect:f,mapParams:e=>{var{silent:t}=e;return(0,i._)(e,["silent"])}});var b;const y=(0,o.combine)({entities:v,currentSectionId:a},(({entities:e,currentSectionId:t})=>null!=(b=e[t])?b:null)),_=(0,o.combine)({entities:p,currentSectionId:a,silentPending:c},(({entities:e,currentSectionId:t,silentPending:r})=>Boolean(!r&&e[t])));var E;const w=(0,o.combine)({entities:m,currentSectionId:a},(({entities:e,currentSectionId:t})=>null!=(E=e[t])?E:null)),I=(0,o.sample)({clock:l,source:a,filter:(e,t)=>e!==t,fn:(e,t)=>t}),k=(0,o.sample)({clock:I,fn:e=>({controller:e?new AbortController:null,id:e})});return(0,o.sample)({clock:s,fn:e=>e,target:a}),(0,o.sample)({clock:r,source:{currentSectionId:a,currentSection:y},filter:({currentSectionId:e,currentSection:t},{filter:r}={})=>!!e&&(!t||!r||r(t)),fn:({currentSectionId:e},{silent:t}={})=>({controller:new AbortController,id:e,silent:t}),target:k}),(0,o.sample)({clock:k,fn:({id:e})=>e,target:s}),(0,o.sample)({clock:k,fn:({controller:e})=>e,target:u}),(0,o.sample)({clock:k,source:v,filter:(e,{id:t,silent:r})=>{var i;return Boolean(!r&&(null==(i=e[t])?void 0:i.blocks))},fn:(e,{id:t})=>{const{id:r,title:i,url:o}=e[t];return[{id:r,title:i,url:o}]},target:g}),(0,o.sample)({clock:k,source:v,filter:(e,{controller:t,id:r,silent:i})=>{var o;return Boolean((i||!(null==(o=e[r])?void 0:o.blocks))&&t)},fn:(e,{controller:t,id:r,silent:i})=>({controller:t,query:{section_id:r},silent:i}),target:S}),(0,o.sample)({clock:S.done.filterMap((({params:e,result:t})=>e.silent&&t.section?[t.section]:void 0)),target:g}),(0,o.sample)({clock:S,filter:({silent:e})=>Boolean(e),fn:()=>!0,target:c}),(0,o.sample)({clock:S.finally,filter:({params:e})=>Boolean(e.silent),fn:()=>!1,target:c}),(0,o.sample)({clock:[S.done,S.fail],filter:e=>!(0,n.isAbortError)(e),fn:()=>null,target:d}),{$currentSection:y,$currentSectionId:a,$currentSectionError:w,$currentSectionPending:_,abortSectionRequestEvent:u,changeCurrentSectionIdEvent:l,refetchCurrentSectionEvent:r,setCurrentSectionIdEvent:s}}},766888:(e,t,r)=>{r.d(t,{createExtendedService:()=>n});var i=r(798116);const o=e=>Object.values(e).filter((e=>Boolean(e))),n=({entitiesGroupsService:e,entitiesUsersService:t,entitiesVideoAlbumsService:r,entitiesVideoService:n,entitiesPlaceholdersService:l})=>{const{$entitiesGroups:s}=e,{$entitiesUsers:a}=t,{$entitiesVideo:c}=n,{$entitiesVideoAlbums:d}=r,{$entitiesPlaceholders:u}=l;return{$data:(0,i.combine)({albums:d,groups:s,placeholders:u,profiles:a,videos:c},(({albums:e,groups:t,placeholders:r,profiles:i,videos:n})=>({albums:o(e),groups:o(t),placeholders:o(r),profiles:o(i),videos:o(n)})))}}},428492:(e,t,r)=>{r.d(t,{createFaveService:()=>s});var i=r(434788),o=r(798116),n=r(22736),l=r(108705);const s=({domain:e,entitiesVideoService:t,onAddFave:r,onRemoveFave:s})=>{const{$entitiesVideo:a,patchVideosEvent:c}=t,{faveAddVideoFx:d,faveRemoveVideoFx:u}=(0,n.createEntitiesFaveVideoService)({domain:e}),v=e.createStore({}),m=e.createEvent(),p=e.createEffect((({controller:e,currentFav:t,query:r})=>{const i={controller:e,query:r};return t?u(i):d(i)}));return(0,o.sample)({clock:m,source:a,fn:(e,{id:t,ownerId:r})=>{var i;const o=(0,l.joinRawId)({ownerId:r,itemId:t}),n=Boolean(null==(i=e[o])?void 0:i.is_favorite);return{controller:new AbortController,currentFav:n,fullId:o,query:{id:t,owner_id:r}}},target:p}),(0,o.sample)({clock:p,source:v,fn:(e,{controller:t,fullId:r})=>{var o;return null==(o=e[r])||o.abort(),(0,i._)({},e,{[r]:t})},target:v}),(0,o.sample)({clock:p,fn:({currentFav:e,query:t})=>[(0,i._)({},t,{is_favorite:!e})],target:c}),(0,o.sample)({clock:[p.done,p.fail],filter:e=>"error"in e||!e.result,fn:({params:e})=>[(0,i._)({},e.query,{is_favorite:e.currentFav})],target:c}),(0,o.sample)({clock:[p.done,p.fail],source:v,fn:(e,{params:t})=>{const r=(0,i._)({},e);return delete r[t.fullId],r},target:v}),(0,o.sample)({clock:d.done,target:r}),(0,o.sample)({clock:u.done,fn:e=>({rollbackCallback:()=>{const{query:t}=e.params;m({id:t.id,ownerId:t.owner_id})}}),target:s}),{toggleFaveVideoEvent:m}}},922207:(e,t,r)=>{r.d(t,{createGroupOwnerService:()=>l});var i=r(798116),o=r(418067),n=r(659397);const l=({domain:e})=>{const t=(0,o.createUtilsResolveScreenNameFx)({domain:e}),r=e.createStore(null),l=e.createStore(null),s=e.createEvent(),a=e.createEvent();return(0,i.sample)({clock:s,source:l,fn:(e,t)=>{var r;null==(r=e)||r.abort();return{controller:new AbortController,query:{screen_name:t}}},target:t}),(0,i.sample)({clock:t,fn:({controller:e})=>e||null,target:l}),(0,i.sample)({clock:a,source:l,fn:e=>{var t;return null==(t=e)||t.abort(),null},target:r}),(0,i.sample)({clock:[t.doneData],filter:e=>{var t;return(0,n.isNumber)(null==(t=e)?void 0:t.object_id)},fn:({object_id:e})=>e,target:r}),(0,i.sample)({clock:[t.done,t.fail],fn:()=>null,target:l}),{resolveGroupOwnerByScreenNameEvent:s,resetGroupOwnerStore:a,$groupOwnerId:r}}},284546:(e,t,r)=>{r.d(t,{createOwnerService:()=>l});var i=r(798116),o=r(723062),n=r(106203);const l=({domain:e,entitiesGroupsService:t,entitiesUsersService:r})=>{const l=e.createEvent(),s=e.createStore(null);return(0,i.sample)({clock:l,fn:({ownerId:e})=>e,target:s}),(0,i.sample)({clock:l,filter:({ownerId:e})=>o.Ranges.isGroupId(e),fn:({controller:e,ownerId:t})=>({controller:e,query:{groupIds:[o.Ranges.convertOwnerIdToGroupId(t)]}}),target:t.groupsGetByIdFx}),(0,i.sample)({clock:l,filter:({ownerId:e})=>o.Ranges.isUserId(e),fn:({controller:e,ownerId:t})=>({controller:e,query:{fields:"screen_name,photo_50",user_ids:String(t)}}),target:r.getUsersFx}),{$ownerData:(0,n.$selectUserOrGroupStoreById)(r.$entitiesUsers,t.$entitiesGroups,s),$ownerError:(0,n.$selectUserOrGroupStoreById)(r.$entitiesUsersErrors,t.$entitiesGroupsErrors,s),$ownerLoading:(0,n.$selectUserOrGroupStoreById)(r.$entitiesUsersLoading,t.$entitiesGroupsLoading,s),getOwnerEvent:l}}},751690:(e,t,r)=>{r.d(t,{createPinService:()=>c});var i=r(434788),o=r(798116),n=r(99763),l=r(838740),s=r(281848),a=r(916207);const c=({domain:e,catalogService:t,entitiesVideoService:r,groupOwnerService:c,onPin:d,onUnpin:u})=>{const{$entitiesVideo:v,patchVideosEvent:m}=r,p=(0,l.createVideoPinVideoFx)({domain:e}),f=(0,l.createVideoUnpinVideoFx)({domain:e}),g=e.createStore({}),S=e.createStore(null),{$catalog:b,$currentSection:y,refetchCurrentSectionEvent:_}=t,E=e.createEvent(),w=e.createEffect((({controller:e,isPinned:t,query:r})=>{const i={controller:e,query:r};return t?f(i):p(i)}));return(0,o.sample)({clock:(0,n.once)(E),source:v,fn:e=>{const t=Object.values(e).findIndex((e=>{var t;return null==(t=e)?void 0:t.is_pinned})),r=Object.values(e)[t];if(!r)return null;const{id:i,owner_id:o}=r;return i&&o?(0,a.getVideoCardKey)(o,i):null},target:S}),(0,o.sample)({clock:E,source:{videos:v,groupOwnerId:c.$groupOwnerId},fn:({videos:e,groupOwnerId:t},{videoId:r,ownerId:i})=>{var o;const n=(0,a.getVideoCardKey)(i,r),l=Boolean(null==(o=e[n])?void 0:o.is_pinned);return{controller:new AbortController,isPinned:l,fullId:n,query:{video_id:r,owner_id:i,group_id:t}}},target:w}),(0,o.sample)({clock:w,source:g,fn:(e,{controller:t,fullId:r})=>{var o;return null==(o=e[r])||o.abort(),(0,i._)({},e,{[r]:t})},target:g}),(0,o.sample)({clock:w,fn:({isPinned:e,query:{video_id:t,owner_id:r}})=>[{owner_id:r,id:t,is_pinned:!e}],target:m}),(0,o.sample)({clock:w.done,filter:e=>!("error"in e),fn:({params:{isPinned:e,query:{video_id:t,owner_id:r}}})=>e?null:(0,a.getVideoCardKey)(r,t),target:S}),(0,o.sample)({clock:w,source:S,filter:(e,{isPinned:t,query:{video_id:r,owner_id:i}})=>Boolean(e)&&!t&&(0,a.getVideoCardKey)(i,r)!==e,fn:e=>{const{ownerId:t,itemId:r}=(0,s.splitRawId)(e);return[{owner_id:t,id:r,is_pinned:!1}]},target:m}),(0,o.sample)({clock:p.done,fn:d}),(0,o.sample)({clock:f.done,fn:u}),(0,o.sample)({clock:[p.done,f.done],source:{$catalog:b,$currentSection:y},filter:({$catalog:e,$currentSection:t})=>{var r,i,o;return(null==(i=e)||null==(r=i.sections[0])?void 0:r.id)===(null==(o=t)?void 0:o.id)},fn:()=>({silent:!0}),target:_}),{toggleVideoPinEvent:E}}},926695:(e,t,r)=>{r.d(t,{createPlaylistVideoPrivacyService:()=>l});var i=r(434788),o=r(778748),n=r(12359);const l=(e,t)=>{const r=(0,o.getEffectorServiceDomain)(e),l=(0,n.createPrivacyService)(r,t);return(0,i._)({},l)}},428846:(e,t,r)=>{r.d(t,{createBlocksReplacementService:()=>c});var i=r(434788),o=r(820224),n=r(798116),l=r(870918),s=r(212147),a=r(106203);const c=({domain:e,entitiesCatalogSectionsService:t,currentSectionService:r,updateSectionEvent:c})=>{const d=e.createStore(null),u=e.createStore(!1),v=e.createStore(null),m=e.createStore(null),p=e.createEvent(),f=(0,l.createCatalogReplaceBlocksFx)({domain:e}),[g,S]=(0,a.createAbortControllerField)(e),{$currentSection:b,changeCurrentSectionIdEvent:y}=r;(0,n.sample)({clock:y,fn:()=>null,target:S});const _=(0,n.sample)({clock:p,fn:e=>({controller:e?new AbortController:null,id:e})});(0,n.sample)({clock:_,fn:({controller:e})=>e,target:S}),(0,n.sample)({clock:_,source:v,filter:(e,{id:t})=>e!==t,fn:(e,{controller:t,id:r})=>({controller:t,query:{replacement_ids:r}}),target:f}),(0,n.sample)({clock:_,fn:({id:e})=>e,target:v}),(0,n.sample)({clock:f,fn:()=>!0,target:u}),(0,n.sample)({clock:[f,y],fn:()=>null,target:d}),(0,n.sample)({clock:f.fail,filter:({error:e})=>!(0,s.isNetworkError)(e)||"AbortError"!==e.error.name,fn:({error:e})=>e,target:d});const E=(0,n.sample)({clock:f.doneData,source:b,filter:(e,{replacements:t})=>Boolean(e&&t),fn:(e,t)=>{var r,{replacements:n}=t,l=(0,o._)(t,["replacements"]);const s=(0,i._)({},e,{next_from:n.new_next_from}),a=(0,i._)({},l,{section:s});return(null==(r=s.blocks)?void 0:r.length)?(s.blocks=n.replacements.reduce(((e,{from_block_ids:t,to_blocks:r})=>{var i;return null==(i=t)||i.forEach(((t,i)=>{var o,n;const l=null==(o=r)?void 0:o[i];if(!l)return;const a=null==(n=s.blocks)?void 0:n.findIndex((({id:e})=>e===t));void 0!==a&&(e[a]=l)})),e}),[...s.blocks]),a):a}});return(0,n.sample)({clock:E,fn:({section:e})=>{const{id:t,title:r,url:i}=e;return[{id:t,title:r,url:i}]},target:t.setCatalogGetSectionsEvent}),(0,n.sample)({clock:E,target:c}),(0,n.sample)({clock:[f.fail,E],fn:()=>!1,target:u}),(0,n.sample)({clock:[f.fail,f.done],filter:e=>!(0,a.isAbortError)(e),fn:()=>null,target:g}),(0,n.sample)({clock:f,fn:({query:e})=>{var t,r;return(null==(r=e)||null==(t=r.replacement_ids)?void 0:t.split("/")[0])||null},target:m}),(0,n.sample)({clock:[f.fail,f.done],fn:()=>null,target:m}),{$currentReplacementId:v,$replaceBlocksError:d,$replaceBlocksPending:u,$loadingBlockId:m,abortReplacementRequestEvent:S,replaceBlocksEvent:p}}},706513:(e,t,r)=>{r.d(t,{createVideoDeletingService:()=>l});var i=r(434788),o=r(798116),n=r(108705);const l=({domain:e,entitiesVideoService:t})=>{const{$entitiesVideo:r,patchVideosEvent:l,videoDeleteFx:s,videoRestoreFx:a}=t,c=e.createStore({}),d=e.createEvent(),u=e.createEffect((({controller:e,deleted:t,query:r})=>{const i={controller:e,query:{video_id:r.id,owner_id:r.owner_id}};return t?a(i):s(i)}));return(0,o.sample)({clock:d,source:r,fn:(e,{id:t,ownerId:r})=>{var i;const o=(0,n.joinRawId)({ownerId:r,itemId:t}),l=Boolean(null==(i=e[o])?void 0:i.localDeleted);return{controller:new AbortController,deleted:l,fullId:o,query:{id:t,owner_id:r}}},target:u}),(0,o.sample)({clock:u,source:c,fn:(e,{controller:t,fullId:r})=>{var o;return null==(o=e[r])||o.abort(),(0,i._)({},e,{[r]:t})},target:c}),(0,o.sample)({clock:u,fn:({deleted:e,query:t})=>[(0,i._)({},t,{localDeleted:!e})],target:l}),(0,o.sample)({clock:[u.done,u.fail],filter:e=>"error"in e||!e.result,fn:({params:{deleted:e,query:t}})=>[(0,i._)({},t,{localDeleted:e})],target:l}),(0,o.sample)({clock:[u.done,u.fail],source:c,fn:(e,{params:t})=>{const r=(0,i._)({},e);return delete r[t.fullId],r},target:c}),{toggleDeleteVideoEvent:d}}},999319:(e,t,r)=>{r.d(t,{registerPlaylistUpdateEventListener:()=>i.registerPlaylistUpdateEventListener});var i=r(522019)},522019:(e,t,r)=>{r.d(t,{registerPlaylistUpdateEventListener:()=>o});var i=r(362246);const o=e=>{const t=({detail:t})=>{e.patchVideoAlbumsEvent([{id:t.albumId,owner_id:t.ownerId,title:t.title}]),e.getVideoAlbumByIdFx({query:{owner_id:t.ownerId,album_id:t.albumId}})};return window.addEventListener(i.CreatePlaylistFormEvents.UPDATE,t),()=>window.removeEventListener(i.CreatePlaylistFormEvents.UPDATE,t)}},870990:(e,t,r)=>{r.d(t,{authorUserService:()=>H,catalogService:()=>U,entitiesGroupsService:()=>x,entitiesUsersService:()=>F,entitiesVideoAlbumsService:()=>$,entitiesVideoService:()=>C,extendedService:()=>B,faveService:()=>R,groupOwnerService:()=>q,ownerService:()=>D,pinService:()=>L,playlistDeletingService:()=>G,playlistService:()=>j,playlistSubscriptionService:()=>M,playlistVideoPrivacyService:()=>W,playlistVideoRemovingService:()=>K,playlistVideoReorderService:()=>z,videoDeletingService:()=>N,videoPlaylistsModalService:()=>T});var i=r(434788),o=r(798116),n=r(481954),l=r(330943),s=r(336547),a=r(555888),c=r(862872),d=r(796615),u=r(258967),v=r(367431),m=r(94240),p=r(444907),f=r(574761),g=r(766888),S=r(428492),b=r(284546),y=r(926695),_=r(706513),E=r(999319),w=r(751690),I=r(922207),k=r(2199),h=r(106203);const V=(0,v.makeSharedState)("static/js/modules/web/VideoShowcase/store/index.ts",(()=>{const e=(0,o.createDomain)("VideoShowcase/VideoCatalog");return(0,i._)({domain:e},(e=>{const t=(0,n.createEntitiesCatalogSectionsService)({domain:e}),r=(0,l.createEntitiesGroupsService)({domain:e}),i=(0,s.createEntitiesUsersService)({domain:e}),o=(0,a.createEntitiesVideoAlbumService)({domain:e}),v=(0,c.createEntitiesPlaceholdersService)({domain:e}),V=(0,d.createEntitiesVideoService)({domain:e,entitiesGroupsService:r,entitiesUsersService:i}),A=(0,g.createExtendedService)({entitiesGroupsService:r,entitiesUsersService:i,entitiesVideoAlbumsService:o,entitiesVideoService:V,entitiesPlaceholdersService:v}),x=(0,S.createFaveService)({domain:e,entitiesVideoService:V,onAddFave:h.showAddedFaveSnackbarFx,onRemoveFave:h.showRemovedFaveSnackbarFx}),F=(0,_.createVideoDeletingService)({domain:e,entitiesVideoService:V}),$=(0,f.createCatalogService)({domain:e,entitiesCatalogSectionsService:t,entitiesGroupsService:r,entitiesUsersService:i,entitiesVideoAlbumsService:o,entitiesVideoService:V,entitiesPlaceholdersService:v}),P=(0,u.createListsVideosService)({domain:e,entitiesVideoService:V}),C=(0,b.createOwnerService)({domain:e,entitiesGroupsService:r,entitiesUsersService:i}),B=(0,k.createPlaylistService)({domain:e,entitiesVideoAlbumsService:o,listsVideosService:P,ownerService:C}),R=(0,k.createPlaylistSubscriptionService)({domain:e,entitiesVideoAlbumsService:o,playlistService:B,onSubscribe:h.showPlaylistSubscribeSnackbar,onUnsubscribe:h.showPlaylistUnsubscribeSnackbar}),L=(0,k.createPlaylistDeletingService)({entitiesVideoAlbumsService:o,onDeleted:e=>{(0,h.sendPlaylistDeletedEvents)(),(0,h.showPlaylistDeletedSnackbar)(e)}}),q=(0,m.createVideoPlaylistsModalService)(e),U=(0,k.createPlaylistVideoRemovingService)({domain:e,entitiesVideoAlbumsService:o,entitiesVideoService:V,playlistService:B,videoPlaylistsModalService:q,onVideoRemove:h.showPlaylistVideoRemoveSnackbar}),O=(0,p.createAuthorUserService)({domain:e,entitiesUsersService:i}),D=(0,k.createPlaylistVideoReorderService)({domain:e,playlistService:B}),j=(0,y.createPlaylistVideoPrivacyService)({domain:e},C.$ownerData),M=(0,I.createGroupOwnerService)({domain:e}),G=(0,w.createPinService)({domain:e,catalogService:$,entitiesVideoService:V,groupOwnerService:M,onPin:h.showVideoPinnedSnackbar,onUnpin:h.showVideoUnpinnedSnackbar});return(0,E.registerPlaylistUpdateEventListener)(o),{entitiesCatalogSectionsService:t,entitiesGroupsService:r,entitiesUsersService:i,entitiesVideoAlbumsService:o,entitiesPlaceholdersService:v,entitiesVideoService:V,extendedService:A,faveService:x,catalogService:$,listsVideosService:P,ownerService:C,playlistService:B,groupOwnerService:M,playlistSubscriptionService:R,playlistDeletingService:L,videoPlaylistsModalService:q,videoDeletingService:F,playlistVideoRemovingService:U,authorUserService:O,playlistVideoReorderService:D,playlistVideoPrivacyService:j,pinService:G}})(e))}),{version:1}),{entitiesCatalogSectionsService:A,entitiesGroupsService:x,entitiesUsersService:F,entitiesVideoAlbumsService:$,entitiesPlaceholdersService:P,entitiesVideoService:C,extendedService:B,faveService:R,pinService:L,groupOwnerService:q,catalogService:U,listsVideosService:O,ownerService:D,playlistService:j,playlistSubscriptionService:M,playlistDeletingService:G,videoPlaylistsModalService:T,videoDeletingService:N,playlistVideoRemovingService:K,authorUserService:H,playlistVideoReorderService:z,playlistVideoPrivacyService:W}=V()},785034:(e,t,r)=>{r.d(t,{createPlaylistDeletingService:()=>o});var i=r(798116);const o=({entitiesVideoAlbumsService:e,onDeleted:t})=>{const{$entitiesVideoDeletedAlbums:r,$entitiesVideoDeletedAlbumsErrors:o,$entitiesVideoDeletedAlbumsPending:n,deleteVideoAlbumByIdFx:l}=e;return(0,i.sample)({clock:l.done,source:e.$entitiesVideoAlbums,fn:(e,{params:r})=>{const i=e[r.id];i&&t(i)}}),{$entitiesVideoDeletedAlbums:r,$entitiesVideoDeletedAlbumsErrors:o,$entitiesVideoDeletedAlbumsPending:n,deleteVideoAlbumByIdFx:l}}},876662:(e,t,r)=>{r.d(t,{createPlaylistService:()=>c});var i=r(434788),o=r(820224),n=r(798116),l=r(281848),s=r(108705),a=r(106203);const c=({domain:e,entitiesVideoAlbumsService:t,listsVideosService:r,ownerService:c})=>{const[d,u]=(0,a.createAbortControllerField)(e),v=e.createEvent(),m=e.createEvent(),p=e.createEvent(),f=e.createEvent(),g=e.createEvent(),S=e.createStore("").reset(v),b=e.createStore("").reset(v),y=(0,a.combineEntitiesId)(t.$entitiesVideoAlbums,b),_=(0,a.combineEntitiesId)(t.$entitiesVideoAlbumsErrors,b),E=(0,a.combineEntitiesId)(t.$entitiesVideoAlbumsLoading,b),{getOwnerEvent:w}=c,I=(0,o._)(c,["getOwnerEvent"]);(0,n.sample)({clock:p,source:E,filter:e=>!e,fn:(e,t)=>t,target:f}),(0,n.sample)({clock:m,source:{playlistId:b,playlistLoading:E},filter:({playlistId:e,playlistLoading:t})=>Boolean(e&&!t),fn:({playlistId:e})=>{const{itemId:t,ownerId:r}=(0,l.splitRawId)(e);return{ownerId:r,playlistId:t}},target:f}),(0,n.sample)({clock:f,source:d,fn:e=>{var t;return null==(t=e)||t.abort(),new AbortController},target:d}),(0,n.sample)({clock:f,source:d,fn:(e,{ownerId:t})=>({controller:e,ownerId:t}),target:w}),(0,n.sample)({clock:f,fn:()=>{},target:r.resetVideosEvent}),(0,n.sample)({clock:f,fn:({ownerId:e,playlistId:t})=>(0,s.joinRawId)({itemId:t,ownerId:e}),target:b}),(0,n.sample)({clock:f,fn:({ownerId:e})=>String(e),target:S}),(0,n.sample)({clock:f,source:d,fn:(e,{ownerId:t,playlistId:r})=>({controller:e,query:{album_id:r,owner_id:t}}),target:t.getVideoAlbumByIdFx}),(0,n.sample)({clock:f,source:d,fn:(e,{ownerId:t,playlistId:r})=>({controller:e,entityKey:(0,s.joinRawId)({itemId:r,ownerId:t}),query:{album_id:r,count:25,extended:1,owner_id:t,fields:"verified,photo_50"}}),target:r.fetchVideosFx}),(0,n.sample)({clock:g,source:b,fn:e=>({entityKey:e}),target:r.fetchMoreVideosEvent});const k=r.selectStores(b.map(String));return(0,i._)({},I,{$playlistId:b,$playlistData:y,$playlistError:_,$playlistLoading:E,$videosCount:k.$count,$videosError:k.$error,$videosFullyLoaded:k.$fullyLoaded,$videosIds:k.$listIds,$videosLoading:k.$loading,abortRequestEvent:u,resetPlaylistEvent:v,getPlaylistEvent:p,fetchMoreVideosEvent:g,refetchPlaylistEvent:m})}},238621:(e,t,r)=>{r.d(t,{createPlaylistSubscriptionService:()=>l});var i=r(798116),o=r(973527),n=r(106203);const l=({domain:e,entitiesVideoAlbumsService:t,playlistService:r,onSubscribe:l,onUnsubscribe:s})=>{const{$playlistId:a}=r,c=(0,o.createAbortControllersService)(e),d=(0,n.createPlaylistSubscriptionEffect)({$playlistId:a,abortControllersService:c,targetFx:(0,n.createCorrectingPlaylistEffect)({correction:1,effectFx:t.subscribeToVideoAlbumFx,entitiesVideoAlbumsService:t}),onDone:l}),u=(0,n.createPlaylistSubscriptionEffect)({$playlistId:a,abortControllersService:c,targetFx:(0,n.createCorrectingPlaylistEffect)({correction:-1,effectFx:t.unsubscribeFromVideoAlbumFx,entitiesVideoAlbumsService:t}),onDone:s}),v=e.createEvent();var m;const p=(0,i.sample)({source:{controllers:c.$controllers,playlistId:a},fn:({controllers:e,playlistId:t})=>null!=(m=e[t])?m:null});return(0,i.sample)({clock:v,source:a,fn:e=>e,target:c.abortRequestEvent}),{$abortController:p,abortRequestEvent:v,subscribeFx:d,unsubscribeFx:u}}},178050:(e,t,r)=>{r.d(t,{createPlaylistVideoRemovingService:()=>l});var i=r(434788),o=r(798116),n=r(108705);const l=({domain:e,entitiesVideoAlbumsService:t,entitiesVideoService:r,playlistService:l,videoPlaylistsModalService:s,onVideoRemove:a})=>{const{$playlistData:c,$playlistId:d,getPlaylistEvent:u,refetchPlaylistEvent:v}=l,m=e.createEvent(),p=(0,o.restore)(m,{}),f=e.createStore({}),g=e.createEvent();(0,o.sample)({clock:g,source:{playlistData:c,removedVideosIds:p},filter:({playlistData:e},{vkId:t})=>{var r;return void 0!==t&&t===(null==(r=e)?void 0:r.owner_id)},fn:({removedVideosIds:e},{videoId:t})=>(0,i._)({},e,{[t]:!0}),target:p}),(0,o.sample)({clock:g,source:c,filter:(e,{vkId:t})=>{var r;return void 0!==t&&t!==(null==(r=e)?void 0:r.owner_id)},fn:(e,{videoId:t})=>({id:t}),target:r.videoGetByIdFx});const S=e.createEvent(),b=t.addVideoToAlbumFx,y=t.removeVideoFromAlbumFx,_=e.createEffect((({controller:e,currentIsRemoved:t,query:r})=>{const i={controller:e,query:r.params};return t?y(i):b(i)})),E=(e,t)=>(0,i._)({},e,{[t]:!e[t]});(0,o.sample)({clock:[u,v],fn:()=>({}),target:p}),(0,o.sample)({clock:S,source:p,fn:(e,{params:t})=>{const r=(0,n.joinRawId)({ownerId:t.owner_id,itemId:t.video_id});return E(e,r)},target:p}),(0,o.sample)({clock:S,source:p,fn:(e,t)=>{const r=(0,n.joinRawId)({ownerId:t.params.owner_id,itemId:t.params.video_id});return{controller:new AbortController,currentIsRemoved:!!e[r],query:t}},target:_}),(0,o.sample)({clock:_,source:f,fn:(e,{controller:t,query:r})=>{var o;const n=r.params.video_id;return null==(o=e[n])||o.abort(),(0,i._)({},e,{[n]:t})},target:f}),(0,o.sample)({clock:[_.done,_.fail],source:p,filter:(e,t)=>{var r,i,o;return("error"in t||!t.result)&&!(null==(o=t.params)||null==(i=o.controller)||null==(r=i.signal)?void 0:r.aborted)},fn:(e,{params:t})=>{const r=t.query.params,i=(0,n.joinRawId)({ownerId:r.owner_id,itemId:r.video_id});return E(e,i)},target:m}),(0,o.sample)({clock:[_.done,_.fail],source:f,fn:(e,{params:t})=>{var r,o,n;if(null==(n=t)||null==(o=n.controller)||null==(r=o.signal)?void 0:r.aborted)return e;const l=t.query.params.video_id,s=(0,i._)({},e);return delete s[l],s},target:f}),(0,o.sample)({clock:y.done,source:c,fn:(e,{params:t})=>{e&&a(e,(()=>{S({params:t.query})}))}}),(0,o.sample)({clock:s.removeFromAlbumDoneEvent,source:{playlistId:d,removedVideosIds:p},filter:({playlistId:e,removedVideosIds:t},{params:r})=>{if(t[(0,n.joinRawId)({itemId:r.query.video_id,ownerId:r.query.owner_id})])return!1;const{album_id:i,album_ids:o="",target_id:l}=r.query;if(void 0===l)return!1;const s=o.split(",");return i&&s.push(i),s.some((t=>(0,n.joinRawId)({itemId:Number(t),ownerId:l})===e))},fn:({removedVideosIds:e},{params:t})=>(0,i._)({},e,{[(0,n.joinRawId)({itemId:t.query.video_id,ownerId:t.query.owner_id})]:!0}),target:m});return{$removedVideosCount:(0,o.sample)({clock:p,fn:e=>Object.values(e).filter(Boolean).length}),$removedVideosIds:p,removeVideoForUserEvent:g,toggleVideoRemovedEvent:S}}},331837:(e,t,r)=>{r.d(t,{createPlaylistVideoReorderService:()=>l});var i=r(798116),o=r(838740),n=r(281848);const l=({domain:e,playlistService:t})=>{const r=(0,o.createVideoReorderVideosFx)({domain:e}),l=e.createEvent();return(0,i.sample)({clock:l,source:t.$playlistId,fn:(e,t)=>{const{ownerId:r,videoId:i,beforeVideoId:o,beforeOwnerId:l,afterVideoId:s,afterOwnerId:a}=t,{ownerId:c,itemId:d}=(0,n.splitRawId)(e),u={target_id:c,album_id:d,owner_id:r,video_id:i};return void 0!==o&&(u.before_video_id=o,u.before_owner_id=l),void 0!==s&&(u.after_video_id=s,u.after_owner_id=a),{query:u}},target:r}),{reorderVideosEvent:l}}},2199:(e,t,r)=>{r.d(t,{createPlaylistDeletingService:()=>o.createPlaylistDeletingService,createPlaylistService:()=>i.createPlaylistService,createPlaylistSubscriptionService:()=>n.createPlaylistSubscriptionService,createPlaylistVideoRemovingService:()=>l.createPlaylistVideoRemovingService,createPlaylistVideoReorderService:()=>s.createPlaylistVideoReorderService});var i=r(876662),o=r(785034),n=r(238621),l=r(178050),s=r(331837)},433702:(e,t,r)=>{r.d(t,{combineEntitiesId:()=>o});var i=r(798116);function o(e,t,r){return(0,i.combine)({entities:e,id:t},(({entities:e,id:t})=>t&&e[t]||r||null))}},757888:(e,t,r)=>{r.d(t,{createAbortControllerField:()=>o});var i=r(798116);const o=e=>{const t=e.createStore(null),r=e.createEvent();return(0,i.sample)({clock:r,source:t,fn:(e,t=null)=>{var r;return!1===(null==(r=e)?void 0:r.signal.aborted)&&e.abort(),t},target:t}),[t,r]}},264390:(e,t,r)=>{r.d(t,{createCorrectingPlaylistEffect:()=>n});var i=r(798116),o=r(108705);const n=({correction:e,effectFx:t,entitiesVideoAlbumsService:r})=>{const n=(0,i.attach)({effect:t});return(0,i.sample)({clock:n.done,source:r.$entitiesVideoAlbums,filter:(e,{params:t})=>"number"==typeof t.query.album_id,fn:(t,{params:r})=>{var i;var n;const l=null!=(n=null==(i=t[(0,o.joinRawId)({itemId:r.query.album_id,ownerId:r.query.owner_id})])?void 0:i.followers_count)?n:0;return[{id:r.query.album_id,owner_id:r.query.owner_id,followers_count:Math.max(0,l+e)}]},target:r.patchVideoAlbumsEvent}),n}},495082:(e,t,r)=>{r.d(t,{createPlaylistSubscriptionEffect:()=>l});var i=r(798116),o=r(281848),n=r(18094);const l=({$playlistId:e,abortControllersService:t,targetFx:r,onDone:l,onEventFired:s})=>{const{clearControllerEvent:a,setControllerEvent:c}=t,d=(0,i.attach)({effect:r,source:e,mapParams:(e,t)=>{const{itemId:r,ownerId:i}=(0,o.splitRawId)(t);return{controller:e,query:{owner_id:i,album_id:r}}}});return(0,i.sample)({clock:d,source:e,fn:(e,t)=>{var r;return null==(r=s)||r(),{[e]:t}},target:c}),(0,i.sample)({clock:[d.done,d.fail],source:e,filter:(e,t)=>!(0,n.isAbortError)(t),fn:e=>e,target:a}),(0,i.sample)({clock:d.done,fn:()=>{var e;null==(e=l)||e()}}),(0,i.attach)({effect:d,mapParams:()=>new AbortController})}},106203:(e,t,r)=>{r.d(t,{$selectUserOrGroupStoreById:()=>a.$selectUserOrGroupStoreById,combineEntitiesId:()=>i.combineEntitiesId,createAbortControllerField:()=>o.createAbortControllerField,createCorrectingPlaylistEffect:()=>n.createCorrectingPlaylistEffect,createPlaylistSubscriptionEffect:()=>l.createPlaylistSubscriptionEffect,isAbortApiError:()=>s.isAbortApiError,isAbortError:()=>s.isAbortError,sendPlaylistDeletedEvents:()=>c.sendPlaylistDeletedEvents,showAddedFaveSnackbarFx:()=>d.showAddedFaveSnackbarFx,showPlaylistDeletedSnackbar:()=>u.showPlaylistDeletedSnackbar,showPlaylistSubscribeSnackbar:()=>v.showPlaylistSubscribeSnackbar,showPlaylistUnsubscribeSnackbar:()=>m.showPlaylistUnsubscribeSnackbar,showPlaylistVideoRemoveSnackbar:()=>p.showPlaylistVideoRemoveSnackbar,showRemovedFaveSnackbarFx:()=>d.showRemovedFaveSnackbarFx,showVideoPinnedSnackbar:()=>f.showVideoPinnedSnackbar,showVideoUnpinnedSnackbar:()=>g.showVideoUnpinnedSnackbar});var i=r(433702),o=r(757888),n=r(264390),l=r(495082),s=r(18094),a=r(332280),c=r(579040),d=r(816431),u=r(333001),v=r(549187),m=r(245874),p=r(36878),f=r(675582),g=r(83328)},18094:(e,t,r)=>{r.d(t,{isAbortApiError:()=>n,isAbortError:()=>l});var i=r(738007),o=r(212147);const n=e=>e&&(0,o.isNetworkError)(e)&&(0,i.isRequestAbortError)(e.error),l=e=>"error"in e&&n(e.error)},830285:(e,t,r)=>{r.d(t,{selectEntityById:()=>o});var i=r(723062);const o=(e,t,r)=>{if(null===r)return null;const o=Number(r);return isNaN(o)?null:i.Ranges.isUserId(o)?null!=(n=e[r])?n:null:i.Ranges.isGroupId(o)&&null!=(l=t[i.Ranges.convertOwnerIdToGroupId(o)])?l:null;var n,l}},332280:(e,t,r)=>{r.d(t,{$selectUserOrGroupStoreById:()=>n});var i=r(798116),o=r(830285);const n=(e,t,r)=>(0,i.combine)(e,t,r,o.selectEntityById)},579040:(e,t,r)=>{r.d(t,{sendPlaylistDeletedEvents:()=>o});var i=r(362246);const o=()=>{window.dispatchEvent(new CustomEvent(i.CreatePlaylistFormEvents.DELETE))}},816431:(e,t,r)=>{r.d(t,{showAddedFaveSnackbarFx:()=>m,showRemovedFaveSnackbarFx:()=>p});var i=r(785893),o=r(29271),n=r(390433),l=r(798116),s=r(839470),a=r(331533),c=r(910301),d=r(641899),u=r(644854),v=r(292063);const m=(0,l.createEffect)((()=>{const e=(0,s.partConfigEnabled)("video_bookmarks_renaming_to_watch_later")?{text:o.getLang("video_added_to_watch_later"),before:{content:(0,i.jsx)(c.Icon24ClockOutline,{})},action:window.location.href.includes(v.BOOKMARKS_URL)?void 0:{label:o.getLang("global_open_section"),onClick:()=>window.location.href=v.BOOKMARKS_URL}}:{text:(0,i.jsx)(a.InnerHTML,{children:(0,o.langLink)(v.BOOKMARKS_URL,o.getLang("fave_video_added"))}),before:{content:(0,i.jsx)(d.Icon24FavoriteOutline,{})}};(0,n.showSnackbar)(e)})),p=(0,l.createEffect)((e=>{const t=(0,s.partConfigEnabled)("video_bookmarks_renaming_to_watch_later")?{text:o.getLang("video_deleted_from_my_watch_later"),before:{content:(0,i.jsx)(c.Icon24ClockOutline,{})},action:e.rollbackCallback?{label:o.getLang("global_cancel"),onClick:(t,r)=>{e.rollbackCallback&&e.rollbackCallback(),(0,n.hideSnackbar)(r)}}:void 0}:{text:o.getLang("video_deleted_from_my_bookmarks"),before:{content:(0,i.jsx)(u.Icon24UnfavoriteOutline,{})}};(0,n.showSnackbar)(t)}))},333001:(e,t,r)=>{r.d(t,{showPlaylistDeletedSnackbar:()=>n});var i=r(29271),o=r(390433);const n=e=>{const t=e?`«${e.title}»`:"",r=(0,i.langReplace)(i.getLang("video_playlist_name_deleted"),{name:t});(0,o.showSnackbar)({text:r})}},549187:(e,t,r)=>{r.d(t,{showPlaylistSubscribeSnackbar:()=>s});var i=r(785893),o=r(390433),n=r(29271),l=r(445264);const s=()=>(0,o.showSnackbar)({text:n.getLang("video_you_subscribed_to_playlist"),before:{content:(0,i.jsx)(l.Icon20CheckAlt,{})}})},245874:(e,t,r)=>{r.d(t,{showPlaylistUnsubscribeSnackbar:()=>s});var i=r(785893),o=r(390433),n=r(29271),l=r(445264);const s=()=>(0,o.showSnackbar)({text:n.getLang("video_you_unsubscribed_from_playlist"),before:{content:(0,i.jsx)(l.Icon20CheckAlt,{})}})},36878:(e,t,r)=>{r.d(t,{showPlaylistVideoRemoveSnackbar:()=>a});var i=r(11010),o=r(785893),n=r(29271),l=r(390433),s=r(499610);const a=(e,t)=>{var r;const a=(null==(r=e)?void 0:r.title)?` «${e.title}»`:"",c=`${n.getLang("video_deleted_from_playlist")}${a}`,d=(0,l.showSnackbar)({text:c,before:{content:(0,o.jsx)(s.Icon28ListCheckOutline,{})},action:{label:n.getLang("global_cancel"),onClick:(0,i._)((function*(){t(),(0,l.hideSnackbar)(yield d)}))}})}},675582:(e,t,r)=>{r.d(t,{showVideoPinnedSnackbar:()=>n});var i=r(390433),o=r(29271);const n=()=>(0,i.showSnackbar)({text:o.getLang("video_pin_video_snackbar"),type:"ok"})},83328:(e,t,r)=>{r.d(t,{showVideoUnpinnedSnackbar:()=>n});var i=r(390433),o=r(29271);const n=()=>(0,i.showSnackbar)({text:o.getLang("video_unpin_video_snackbar"),type:"ok"})},147774:(e,t,r)=>{r.d(t,{ensureEventPropagationStopping:()=>i});const i=(e,t)=>(e.stopPropagation(),t(e))},825601:(e,t,r)=>{r.d(t,{getOwnerPlaylistsUrl:()=>n});var i=r(839470),o=r(765069);const n=(e,t)=>{var r;const n=(0,o.getOwnerUrl)(e,t);return(null==(r=e)?void 0:r.id)?e.id===window.vk.id||(0,i.partConfigEnabled)("video_community_catalog")?[n,"playlists"].join("/"):[n,new URLSearchParams({section:"playlists"}).toString()].join("?"):n}},139971:(e,t,r)=>{r.d(t,{getShowcaseUrl:()=>i});const i=()=>"/video"},43930:(e,t,r)=>{r.d(t,{getVerifiedBadge:()=>a});var i=r(785893),o=r(258807),n=r(654198),l=r(723062),s=r(508249);const a=e=>{if(!e)return;const t=(e=>{var t,r,i,o;return(0,n.isOwnerUser)(e)&&((null==(t=e)?void 0:t.is_esia_verified)||(null==(r=e)?void 0:r.is_sber_verified)||(null==(i=e)?void 0:i.is_tinkoff_verified))?{icon:"esia",ownerId:e.id}:(null==(o=e)?void 0:o.verified)?{icon:"default",ownerId:(0,n.isOwnerUser)(e)?e.id:l.Ranges.convertGroupIdToOwnerId(e.id)}:null})(e);return t?(0,i.jsx)(o.VerifiedLabel,{iconHref:"/verify",onMouseOver:e=>(0,s.pageVerifiedTip)(e.currentTarget,{oid:t.ownerId,forceNewTab:!0}),icon:t.icon}):void 0}},604200:(e,t,r)=>{r.d(t,{getVideoCardKey:()=>o});var i=r(108705);const o=(e,t)=>(0,i.joinRawId)({ownerId:e,itemId:t})},916207:(e,t,r)=>{r.d(t,{copyPlaylistUrl:()=>u.copyPlaylistUrl,ensureEventPropagationStopping:()=>c.ensureEventPropagationStopping,getFullAlbumId:()=>u.getFullAlbumId,getOwnerPlaylistsUrl:()=>i.getOwnerPlaylistsUrl,getShowcaseUrl:()=>o.getShowcaseUrl,getVerifiedBadge:()=>d.getVerifiedBadge,getVideoCardKey:()=>v.getVideoCardKey,isAccessDenied:()=>n.isAccessDenied,isIdInvalid:()=>s.isIdInvalid,isMyVideoAlbum:()=>u.isMyVideoAlbum,isServiceAlbumId:()=>u.isServiceAlbumId,isSystemPlaylist:()=>a.isSystemPlaylist,isVideosEnabled:()=>l.isVideosEnabled,mapAlbumsWithInclusionsToPlaylists:()=>u.mapAlbumsWithInclusionsToPlaylists,showPlaylistActionSnackbar:()=>u.showPlaylistActionSnackbar});var i=r(825601),o=r(139971),n=r(696934),l=r(870068),s=r(130789),a=r(847678),c=r(147774),d=r(43930),u=r(972634),v=r(604200)},696934:(e,t,r)=>{r.d(t,{isAccessDenied:()=>i});const i=e=>{var t,r;return"api_error"===(null==(t=e)?void 0:t.type)&&204===Number(null==(r=e.error)?void 0:r.error_code)}},130789:(e,t,r)=>{r.d(t,{isIdInvalid:()=>i});const i=e=>{var t,r;return"api_error"===(null==(t=e)?void 0:t.type)&&100===Number(null==(r=e.error)?void 0:r.error_code)}},847678:(e,t,r)=>{r.d(t,{isSystemPlaylist:()=>i});const i=e=>{var t;return 1===(null==(t=e)?void 0:t.is_system)}},870068:(e,t,r)=>{r.d(t,{isVideosEnabled:()=>i});const i=e=>{var t,r;return"api_error"===(null==(t=e)?void 0:t.type)&&15===Number(null==(r=e.error)?void 0:r.error_code)}},972634:(e,t,r)=>{r.d(t,{copyPlaylistUrl:()=>y,getFullAlbumId:()=>f,isMyVideoAlbum:()=>m,isServiceAlbumId:()=>p,mapAlbumsWithInclusionsToPlaylists:()=>S,showPlaylistActionSnackbar:()=>b});var i=r(434788),o=r(785893),n=r(108705),l=r(292063),s=r(29271),a=r(390433),c=r(499610),d=r(445264),u=r(659397),v=r(404145);const m=e=>e===l.MY_VIDEO_ALBUM_ID,p=e=>e&&e<=0,f=({albumId:e,ownerId:t})=>e&&t?(0,n.joinRawId)({ownerId:t,itemId:e}):"",g=(e,t=!1)=>{var r,i;return{id:e.id,title:e.title,isPrivate:"only_me"===(null==(i=e)||null==(r=i.privacy)?void 0:r.category),containsVideo:t}},S=({albumsByVideo:e,albums:t,ownerId:r})=>{const o={};return e.forEach((e=>{const i=f({albumId:e,ownerId:r}),n=t[i];n&&(o[i]=g(n,!0),delete t[i])})),(0,i._)({},o,(n=t,Object.keys(n).reduce(((e,t)=>{const r=n[t];return r&&(e[t]=g(r)),e}),{})));var n},b=({playlistId:e,ownerId:t,playlistTitle:r,added:i})=>{const n=m(e);if(!r&&!n)return;const d=n?window.Video._getMyAddedVideosPath():(0,l.getPlaylistURL)(t,e);let v;v=i?n?s.getLang("video_added_to_section"):s.getLang("video_added_to_playlist"):n?s.getLang("video_deleted_from_section"):s.getLang("video_deleted_from_playlist");const p=n?s.getLang("video_catalog_showcase_section_my_video_added_title"):(0,u.decodeHTMLEntities)(r||"");(0,a.showSnackbar)({text:v,before:{content:(0,o.jsx)(c.Icon28ListCheckOutline,{})},action:{label:p,onClick:()=>window.location.href=d},timeout:l.SNACKBAR_TIMEOUT}).catch()},y=({owner_id:e,id:t})=>{(0,u.copyTextToClipboard)(`https://${(0,v.getHostName)()}${(0,l.getPlaylistURL)(e,t)}`),(0,a.showSnackbar)({text:s.getLang("video_playlist_url_copied"),before:{content:(0,o.jsx)(d.Icon20CheckAlt,{})}})}},535727:(e,t,r)=>{r.d(t,{usePatchChildrenRef:()=>l});var i=r(667294),o=r(488543);const n=e=>"string"==typeof e.type,l=e=>{var t;const r=(0,i.isValidElement)(e)&&(n(e)?e.ref:e.props.getRootRef),l=(0,o.useExternRef)(r);return(0,i.useEffect)((()=>{l.current||console.error("Кажется, в children передан компонент, который не поддерживает свойство getRootRef. Мы не можем получить ссылку на корневой dom-элемент этого компонента")}),[null==(t=e)?void 0:t.type,l]),[l,(0,i.isValidElement)(e)?(0,i.cloneElement)(e,{[n(e)?"ref":"getRootRef"]:l}):e]}},771611:(e,t,r)=>{r.d(t,{createFriendsAddFx:()=>a,createFriendsAddListFx:()=>m,createFriendsDeleteBulkFx:()=>d,createFriendsDeleteFx:()=>c,createFriendsDeleteListFx:()=>p,createFriendsDeleteSubscriberFx:()=>S,createFriendsEditListFx:()=>f,createFriendsGetCountersFx:()=>_,createFriendsGetFollowersFx:()=>b,createFriendsGetFriendsDeletionSuggestionsFx:()=>l,createFriendsGetFx:()=>n,createFriendsGetListsFx:()=>o,createFriendsGetOnlineFx:()=>v,createFriendsGetRecommendationsFx:()=>s,createFriendsGetRequestsFx:()=>u,createFriendsRequestsToSubscribersFx:()=>y,createFriendsSearchFx:()=>g});var i=r(972051);const o=e=>(0,i.createApiEffect)("friends.getLists",e),n=e=>(0,i.createApiEffect)("friends.get",e),l=e=>(0,i.createApiEffect)("friends.getFriendsDeletionSuggestions",e),s=e=>(0,i.createApiEffect)("friends.getRecommendations",e),a=e=>(0,i.createApiEffect)("friends.add",e),c=e=>(0,i.createApiEffect)("friends.delete",e),d=e=>(0,i.createApiEffect)("friends.deleteBulk",e),u=e=>(0,i.createApiEffect)("friends.getRequests",e),v=e=>(0,i.createApiEffect)("friends.getOnline",e),m=e=>(0,i.createApiEffect)("friends.addList",e),p=e=>(0,i.createApiEffect)("friends.deleteList",e),f=e=>(0,i.createApiEffect)("friends.editList",e),g=e=>(0,i.createApiEffect)("friends.search",e),S=e=>(0,i.createApiEffect)("friends.deleteSubscriber",e),b=e=>(0,i.createApiEffect)("friends.getFollowers",e),y=e=>(0,i.createApiEffect)("friends.requestsToSubscribers",e),_=e=>(0,i.createApiEffect)("friends.getCounters",e)},142246:(e,t,r)=>{r.d(t,{createUsersGetFx:()=>o,createUsersSearchFx:()=>n});var i=r(972051);const o=e=>(0,i.createApiEffect)("users.get",e),n=e=>(0,i.createApiEffect)("users.search",e)},418067:(e,t,r)=>{r.d(t,{createUtilsResolveScreenNameFx:()=>o});var i=r(972051);const o=e=>(0,i.createApiEffect)("utils.resolveScreenName",e)},352755:(e,t,r)=>{r.d(t,{useEntitiesStore:()=>o,useNotNullEntitiesStore:()=>n});var i=r(504190);const o=(e,t)=>(0,i.useStoreMap)({store:e,keys:[t],fn:(e,[t])=>e[t],defaultValue:null}),n=(e,t)=>(0,i.useStoreMap)({store:e,keys:[t],fn:(e,[t])=>{const r=e[t];if(null==r)throw new Error("Empty value entity store");return r}})},481954:(e,t,r)=>{r.d(t,{createEntitiesCatalogSectionsService:()=>a});var i=r(434788),o=r(798116),n=r(453934),l=r(870918),s=r(584117);const a=({domain:e})=>{const t=(0,l.createCatalogGetSectionFx)({domain:e}),r=e.createEvent(),a=e.createEvent(),c=e.createStore({}),d=e.createStore([]).reset(r),u=e.createStore({}),v=e.createStore({});var m,p;return(0,o.sample)({clock:a,source:c,fn:(e,t)=>(0,s.mapToEntity)(e,t),target:c}),(0,o.sample)({clock:r,source:c,fn:(e,t)=>{var r;return(0,s.mapToEntity)(e,null!=(m=null==(r=t.catalog)?void 0:r.sections)?m:[])},target:c}),(0,o.sample)({clock:r,source:d,fn:(e,t)=>{var r;return[...e,...null!=(p=null==(r=t.catalog)?void 0:r.sections.map((({id:e})=>e)))?p:[]]},target:d}),u.on(t,((e,t)=>{const r=t.query.section_id;return r?(0,i._)({},e,{[r]:!0}):e})),u.on(t.finally,((e,t)=>{const r=t.params.query.section_id;return r?(0,i._)({},e,{[r]:!1}):e})),v.on(t,((e,t)=>(0,n.produce)(e,(e=>{const r=t.query.section_id;r&&(e[r]=null)})))),v.on(t.fail,((e,t)=>{const r=t.params.query.section_id;return r?(0,i._)({},e,{[r]:t.error}):e})),{initCatalog:r,$entitiesCatalogSections:c,$entitiesCatalogSectionIds:d,$entitiesSectionsErrors:v,$entitiesSectionsLoading:u,catalogGetSectionFx:t,setCatalogGetSectionsEvent:a}}},202724:(e,t,r)=>{r.d(t,{createEntitiesCatalogVideoService:()=>v});var i,o,n=r(434788),l=r(798116),s=r(870918),a=r(916182),c=r(456145),d=r(876397);const u=({query:e})=>null!=(o=null!=(i=e.url)?i:e.owner_id)?o:"",v=({domain:e,entitiesCatalogSectionsService:t,entitiesGroupsService:r,entitiesUsersService:i,entitiesVideoAlbumsService:o,entitiesVideoService:v,entitiesPlaceholdersService:m})=>{const p=(0,s.createCatalogGetVideoFx)({domain:e}),f=(0,a.errors)({effect:p,getKey:u,store:e.createStore({})}),g=(0,c.pendings)({effect:p,getKey:u,store:e.createStore({})}),S=e.createEvent(),b=e.createStore({}),{$entitiesCatalogSections:y,catalogGetSectionFx:_,initCatalog:E,setCatalogGetSectionsEvent:w}=t;(0,l.sample)({clock:p.doneData,target:E}),(0,l.sample)({clock:p.done,source:b,fn:(e,{params:t,result:r})=>(0,n._)({},e,{[u(t)]:r.catalog}),target:b}),(0,l.sample)({clock:[_.doneData,S],source:y,filter:(e,{section:t})=>{var r;return Boolean(null==(r=t)?void 0:r.id)},fn:(e,{section:t})=>{if(!t)return[];const r=e[t.id];if(!r)return[t];return[(0,n._)({},t,{actions:r.actions&&t.actions?[...r.actions,...t.actions]:t.actions,blocks:(0,d.mergeCatalogVideoSectionBlocks)(r.blocks,t.blocks)})]},target:w});const I=(0,l.sample)({clock:[p.doneData,_.doneData,S]});return(0,l.sample)({clock:I,filter:({albums:e})=>{var t;return Boolean(null==(t=e)?void 0:t.length)},fn:({albums:e=[]})=>e,target:o.setVideoAlbumsEvent}),(0,l.sample)({clock:I,filter:({groups:e})=>{var t;return Boolean(null==(t=e)?void 0:t.length)},fn:({groups:e=[]})=>e,target:r.setGroupsEvent}),(0,l.sample)({clock:I,filter:({profiles:e})=>{var t;return Boolean(null==(t=e)?void 0:t.length)},fn:({profiles:e=[]})=>e,target:i.setUsersEvent}),(0,l.sample)({clock:I,filter:({videos:e})=>{var t;return Boolean(null==(t=e)?void 0:t.length)},fn:({videos:e=[]})=>e,target:v.setVideosEvent}),(0,l.sample)({clock:I,filter:({placeholders:e})=>{var t;return Boolean(null==(t=e)?void 0:t.length)},fn:({placeholders:e=[]})=>e,target:m.setPlaceholdersEvent}),{$entitiesCatalogVideo:b,$entitiesCatalogVideoErrors:f,$entitiesCatalogVideoLoading:g,catalogGetVideoFx:p,updateSectionEvent:S}}},862872:(e,t,r)=>{r.d(t,{createEntitiesPlaceholdersService:()=>n});var i=r(798116),o=r(584117);const n=({domain:e})=>{const t=e.createStore({}),r=e.createEvent();return(0,i.sample)({clock:r,source:t,fn:(e,t)=>(0,o.mapToEntity)(e,t),target:t}),{$entitiesPlaceholders:t,setPlaceholdersEvent:r}}},876397:(e,t,r)=>{r.d(t,{mergeCatalogVideoSectionBlocks:()=>o});var i=r(434788);const o=(e,t)=>t?e?t.reduce(((e,t)=>{const r=e.findIndex((({id:e})=>e===t.id)),o=e[r];if(o)if(o.videos_ids){if(t.videos_ids){const n=[...o.videos_ids,...t.videos_ids];e[r]=(0,i._)({},o,{videos_ids:n})}}else{const{videos_ids:n}=t;e[r]=(0,i._)({},o,{videos_ids:n})}else e.push(t);return e}),[...e]):null!=t?t:[]:null!=e?e:[]},22736:(e,t,r)=>{r.d(t,{createEntitiesFaveVideoService:()=>u});var i=r(434788),o=r(798116),n=r(108705),l=r(380901),s=r(916182),a=r(456145);const c=({query:e})=>(0,n.joinRawId)({ownerId:e.owner_id,itemId:e.id}),d=(e,{query:t},r)=>(0,i._)({},e,{[(0,n.joinRawId)({ownerId:t.owner_id,itemId:t.id})]:r}),u=({domain:e})=>{const t=(0,l.createFaveAddVideoFx)({domain:e}),r=(0,l.createFaveRemoveVideoFx)({domain:e}),n=(0,s.errors)({effect:t,getKey:c,store:e.createStore({})}),u=(0,a.pendings)({effect:t,getKey:c,store:e.createStore({})}),v=(0,s.errors)({effect:r,getKey:c,store:e.createStore({})}),m=(0,a.pendings)({effect:r,getKey:c,store:e.createStore({})}),p=e.createStore({}),f=e.createEvent();return p.on(f,((e,{id:t,value:r})=>(0,i._)({},e,{[t]:r}))),(0,o.sample)({clock:t.done,source:p,filter:(e,{result:t})=>Boolean(t),fn:(e,{params:t})=>d(e,t,!0),target:p}),(0,o.sample)({clock:r.done,source:p,filter:(e,{result:t})=>Boolean(t),fn:(e,{params:t})=>d(e,t,!1),target:p}),{$entitiesFaveAddVideoErrors:n,$entitiesFaveAddVideoLoading:u,$entitiesFaveRemoveVideoErrors:v,$entitiesFaveRemoveVideoLoading:m,$entitiesFaveVideo:p,faveAddVideoFx:t,faveRemoveVideoFx:r,setFaveVideoByIdEvent:f}}},12359:(e,t,r)=>{r.d(t,{OTHER_FRIENDS_LIMIT_COUNT:()=>d,createPrivacyService:()=>u});var i=r(11010),o=r(434788),n=r(820224),l=r(798116),s=r(771611),a=r(142246);const c="photo_50",d=3,u=(e,t)=>{const r=e.createEvent("reset");e.onCreateStore((e=>{e.reset(r)}));const u=(0,s.createFriendsSearchFx)({domain:e}),v=(0,a.createUsersGetFx)({domain:e}),m=(0,s.createFriendsGetListsFx)({domain:e}),p=(0,s.createFriendsGetFx)({domain:e}),f=e.createStore(null),g=e.createStore(null),S=e.createStore(null),b=e.createStore(null),y=e.createStore([]),_=e.createStore(null),E=e.createEvent(),w=e.createEvent(),I=e.createEvent(),k=e.createEvent(),h=e.createEvent(),V=e.createEvent(),A=e.createEvent(),x=(0,l.attach)({effect:u,mapParams:e=>{var{user_id:t,q:r,fields:i}=e,l=(0,n._)(e,["user_id","q","fields"]);const s={user_id:t,q:r,fields:i};return(0,o._)({query:s},l)}}),F=(0,l.attach)({effect:u,mapParams:e=>{var{user_id:t,q:r,fields:i}=e,l=(0,n._)(e,["user_id","q","fields"]);const s={user_id:t,q:r,fields:i};return(0,o._)({query:s},l)}}),$=(0,l.attach)({effect:u,mapParams:({params:e,options:t})=>{const{user_id:r,q:i,offset:o,count:n,fields:l}=e;return{query:{user_id:r,q:i,offset:o,count:n,fields:l},options:t}}}),P=(0,l.attach)({effect:v,mapParams:e=>{var{user_ids:t}=e,r=(0,n._)(e,["user_ids"]);const i={user_ids:t};return(0,o._)({query:i},r)}}),C=(0,l.createEffect)((0,i._)((function*(e){var{user_id:t}=e,r=(0,n._)(e,["user_id"]);const i=(0,o._)({user_id:t},r,{return_system:1}),{items:l}=yield m({query:i});return yield Promise.all(l.map((({id:e,name:r})=>p({query:{user_id:t,list_id:e,fields:c,count:d}}).then((({items:t,count:i})=>({id:e,name:r,count:i,friends:t}))))))})));return y.reset(A),_.reset(A),(0,l.sample)({clock:w,source:t,fn:(e,t)=>{var r;return{user_id:null==(r=e)?void 0:r.id,q:t,fields:c}},target:x}),(0,l.sample)({clock:x.doneData,source:t,fn:(e,t)=>t.items.filter((({id:t})=>{var r;return t!==(null==(r=e)?void 0:r.id)})),target:f}),(0,l.sample)({clock:I,source:t,fn:(e,t)=>{var r;return{user_id:null==(r=e)?void 0:r.id,q:t,fields:c}},target:F}),(0,l.sample)({clock:F.doneData,source:t,fn:(e,t)=>t.items.filter((({id:t})=>{var r;return t!==(null==(r=e)?void 0:r.id)})),target:g}),(0,l.sample)({clock:V,source:{owner:t,someFriends:y,friendsTotalCount:_},filter:({someFriends:e,friendsTotalCount:t})=>null===t||e.length<t,fn:({owner:e,someFriends:t},{query:r,signal:i})=>{var o;return{params:{user_id:null==(o=e)?void 0:o.id,q:r,offset:t.length,count:50,fields:c},options:{signal:i}}},target:$}),y.on($.doneData,((e,t)=>e.concat(t.items))),_.on($.doneData,((e,t)=>t.count)),(0,l.sample)({clock:k,fn:e=>({user_ids:e.join(",")}),target:P}),S.on(P.doneData,((e,t)=>t)),S.on(h,((e,t)=>{const r=new Set;return Array.from([...e||[],...t].filter((e=>!r.has(e.id)&&(r.add(e.id),!0)),r))})),(0,l.sample)({clock:E,source:t,fn:e=>{var t;return{user_id:(null==(t=e)?void 0:t.id)||0}},target:C}),b.on(C.doneData,((e,t)=>t)),{$searchExcludedFriends:f,$searchAllowedFriends:g,$privacyFriends:S,$friendLists:b,$someFriends:y,$someFriendsTotalCount:_,getFriendLists:E,searchExcludedFriends:w,searchAllowedFriends:I,getUsersByIds:k,setPrivacyFriends:h,searchSomeFriends:V,searchSomeFriendsReset:A,resetStores:r,searchExcludedFriendsFx:x,searchAllowedFriendsFx:F,searchSomeFriendsFx:$,getUsersFx:P,getFriendListsFx:C}}},336547:(e,t,r)=>{r.d(t,{createEntitiesUsersService:()=>s});var i=r(798116),o=r(386037),n=r(584117),l=r(142246);const s=e=>{const t=(0,l.createUsersGetFx)(e),{domain:r}=e,s=r.createStore({}),a=r.createStore({}),c=r.createStore({}),d=r.createEvent();return c.on(t,((e,{query:t})=>(0,o.updateEntitiesBy)(e,t.user_ids,!0))),c.on(t.finally,((e,{params:t})=>(0,o.updateEntitiesBy)(e,t.query.user_ids,!1))),a.on(t,((e,{query:t})=>(0,o.updateEntitiesBy)(e,t.user_ids,null))),a.on(t.fail,((e,{error:t,params:r})=>(0,o.updateEntitiesBy)(e,r.query.user_ids,t))),(0,i.sample)({clock:t.done,filter:({result:e})=>Boolean(e),fn:({result:e})=>e,target:d}),(0,i.sample)({clock:d,source:s,fn:(e,t)=>(0,n.mapToEntity)(e,t),target:s}),{$entitiesUsers:s,$entitiesUsersErrors:a,$entitiesUsersLoading:c,getUsersFx:t,setUsersEvent:d}}},555888:(e,t,r)=>{r.d(t,{createEntitiesVideoAlbumService:()=>g});var i=r(434788),o=r(820224),n=r(798116),l=r(108705),s=r(281848),a=r(66957),c=r(838740),d=r(255344),u=r(386037),v=r(528676),m=r(727320),p=r(723062);const f=({album_id:e,owner_id:t=0})=>(0,l.joinRawId)({ownerId:t,itemId:e}),g=e=>{const t=(0,c.createVideoDeleteAlbumFx)(e),r=(0,c.createVideoEditAlbumFx)(e),g=(0,c.createVideoAddAlbumFx)(e),S=(0,c.createVideoGetAlbumByIdFx)(e),b=(0,c.createVideoGetAlbumsExtendedFx)(e),y=(0,c.createVideoAddToAlbumFx)(e),_=(0,c.createVideoRemoveFromAlbumFx)(e),{domain:E}=e,w=E.createStore({}),I=E.createStore({}),k=E.createStore({}),h=E.createStore({}),V=E.createStore({}),A=E.createStore({}),x=E.createStore({}),F=E.createStore({}),$=E.createEvent(),P=E.createEvent(),C=(0,n.attach)({effect:t,mapParams:e=>{var{id:t}=e,r=(0,o._)(e,["id"]);const{itemId:n,ownerId:l}=(0,s.splitRawId)(t),a=p.Ranges.isGroupId(l)?{album_id:n,group_id:p.Ranges.convertOwnerIdToGroupId(l)}:{album_id:n,owner_id:l};return(0,i._)({},r,{query:a})}}),B=(0,n.attach)({effect:r,mapParams:e=>{var{ownerId:t,itemId:r,title:n,privacy:l}=e,s=(0,o._)(e,["ownerId","itemId","title","privacy"]);const a={album_id:r,title:n};return l&&(a.privacy=(0,d.stringifyBasePrivacy)(l)),p.Ranges.isGroupId(t)&&(a.group_id=p.Ranges.convertOwnerIdToGroupId(t)),(0,i._)({},s,{query:a})}}),R=(0,n.attach)({effect:g,mapParams:e=>{var{ownerId:t,title:r,privacy:n}=e,l=(0,o._)(e,["ownerId","title","privacy"]);const s={title:r};return n&&(s.privacy=(0,d.stringifyBasePrivacy)(n)),p.Ranges.isGroupId(t)&&(s.group_id=p.Ranges.convertOwnerIdToGroupId(t)),(0,i._)({},l,{query:s})}}),L=(0,v.createVideoAlbumSubscriptionEffect)((0,c.createVideoSubscribeToAlbum)(e),$,!0),q=(0,v.createVideoAlbumSubscriptionEffect)((0,c.createVideoUnsubscribeFromAlbum)(e),$,!1);return(0,m.registerEntitiesSetSample)(P,w),k.on(S,((e,{query:t})=>(0,u.updateEntitiesBy)(e,f(t),!0))),k.on(S.finally,((e,{params:t})=>(0,u.updateEntitiesBy)(e,f(t.query),!1))),I.on(S,((e,{query:t})=>(0,u.updateEntitiesBy)(e,f(t),null))),I.on(S.fail,((e,{error:t,params:r})=>(0,u.updateEntitiesBy)(e,f(r.query),t))),w.on(S.done,((e,{params:t,result:r})=>(0,u.updateEntitiesBy)(e,f(t.query),r))),A.on(C,((e,{id:t})=>(0,u.updateEntitiesBy)(e,t,!0))),A.on(C.finally,((e,{params:t})=>(0,u.updateEntitiesBy)(e,t.id,!1))),V.on(C,((e,{id:t})=>(0,u.updateEntitiesBy)(e,t,null))),V.on(C.fail,((e,{error:t,params:r})=>(0,u.updateEntitiesBy)(e,r.id,t))),h.on(C.done,((e,{params:t,result:r})=>r?(0,u.updateEntitiesBy)(e,t.id,!0):e)),F.on(B,((e,{ownerId:t,itemId:r})=>(0,u.updateEntitiesBy)(e,(0,l.joinRawId)({itemId:r,ownerId:t}),!0))),F.on(B.finally,((e,{params:t})=>(0,u.updateEntitiesBy)(e,(0,l.joinRawId)({itemId:t.itemId,ownerId:t.ownerId}),!1))),x.on(B,((e,{ownerId:t,itemId:r})=>(0,u.updateEntitiesBy)(e,(0,l.joinRawId)({itemId:r,ownerId:t}),null))),x.on(B.fail,((e,{error:t,params:r})=>(0,u.updateEntitiesBy)(e,(0,l.joinRawId)({itemId:r.itemId,ownerId:r.ownerId}),t))),(0,n.sample)({clock:B.done,fn:({params:e})=>[{owner_id:e.ownerId,id:e.itemId,title:e.title,privacy:e.privacy}],target:$}),(0,n.sample)({clock:$,source:w,fn:(e,t)=>t.reduce(((t,r)=>{const o=(0,l.joinRawId)({ownerId:r.owner_id,itemId:r.id}),n=(0,i._)({},e[o],r);return(0,a.isVideoVideoAlbumFull)(n)&&t.push(n),t}),[]),target:P}),{$entitiesVideoAlbums:w,$entitiesVideoAlbumsErrors:I,$entitiesVideoAlbumsLoading:k,$entitiesVideoDeletedAlbums:h,$entitiesVideoDeletedAlbumsErrors:V,$entitiesVideoDeletedAlbumsPending:A,$entitiesVideoEditedAlbumsErrors:x,$entitiesVideoEditedAlbumsPending:F,patchVideoAlbumsEvent:$,setVideoAlbumsEvent:P,editVideoAlbumByIdFx:B,createVideoAlbumFx:R,deleteVideoAlbumByIdFx:C,getVideoAlbumByIdFx:S,subscribeToVideoAlbumFx:L,unsubscribeFromVideoAlbumFx:q,getVideoAlbumsFx:b,addVideoToAlbumFx:y,removeVideoFromAlbumFx:_}}},796615:(e,t,r)=>{r.d(t,{createEntitiesVideoService:()=>d});var i=r(434788),o=r(820224),n=r(798116),l=r(108705),s=r(838740),a=r(386037),c=r(727320);const d=({domain:e,entitiesGroupsService:t,entitiesUsersService:r})=>{var d,u;const v=(0,s.createVideoGetFx)({domain:e}),m=(0,s.createVideoGetVideoDiscoverFx)({domain:e}),p=(0,s.createVideoDeleteFx)({domain:e}),f=(0,s.createVideoRestoreFx)({domain:e}),g=e.createStore({}),S=e.createStore({}),b=e.createStore({}),y=e.createEvent(),_=e.createEvent();b.on(v,((e,{query:t})=>(0,a.updateEntitiesBy)(e,t.videos,!0))),b.on(v.finally,((e,{params:t})=>(0,a.updateEntitiesBy)(e,t.query.videos,!1))),S.on(v,((e,{query:t})=>(0,a.updateEntitiesBy)(e,t.videos,void 0))),S.on(v.fail,((e,{error:t,params:r})=>(0,a.updateEntitiesBy)(e,r.query.videos,t)));const E=(0,n.attach)({effect:v,mapParams:e=>{var{id:t,extended:r}=e,n=(0,o._)(e,["id","extended"]);return(0,i._)({},n,{query:{count:1,extended:r,videos:t}})}});var w,I,k;((0,n.sample)({clock:[v.done,m.done],filter:({result:e})=>Boolean(e.items),fn:({result:e})=>e.items,target:y}),null==(d=t)?void 0:d.setGroupsEvent)&&(0,n.sample)({clock:[v.done,m.done],filter:({result:e})=>{var t;return Boolean(null==(t=e.groups)?void 0:t.length)},fn:({result:e})=>null!=(I=e.groups)?I:[],target:null==(w=t)?void 0:w.setGroupsEvent});(null==(u=r)?void 0:u.setUsersEvent)&&(0,n.sample)({clock:[v.done,m.done],filter:({result:e})=>{var t;return Boolean(null==(t=e.profiles)?void 0:t.length)},fn:({result:e})=>null!=(k=e.profiles)?k:[],target:r.setUsersEvent});return(0,n.sample)({clock:_,source:g,fn:(e,t)=>t.map((t=>{const r=(0,l.joinRawId)({ownerId:t.owner_id,itemId:t.id});return(0,i._)({},e[r],t)})),target:y}),(0,c.registerEntitiesSetSample)(y,g),{$entitiesVideo:g,$entitiesVideoLoading:b,$entitiesVideoErrors:S,patchVideosEvent:_,setVideosEvent:y,videoGetFx:v,videoGetByIdFx:E,videoGetVideoDiscoverFx:m,videoDeleteFx:p,videoRestoreFx:f}}},759336:(e,t,r)=>{r.d(t,{createListsVideosAlbumsService:()=>s});var i=r(108705),o=r(838740),n=r(584646);const l=({id:e,owner_id:t})=>void 0===e||void 0===t?"":(0,i.joinRawId)({itemId:e,ownerId:t}),s=({domain:e,entitiesVideoAlbumService:t})=>{const r=(0,o.createVideoGetAlbumsExtendedFx)({domain:e}),i=e.createEffect(r),s=(0,n.createFactoryLists)({$entitiesItems:t.$entitiesVideoAlbums,domain:e,fetchFx:i,getItemKey:l,getList:({items:e})=>e,getListCount:({count:e})=>e,getListKey:({entityKey:e})=>e,getEntityKey:l});return{resetVideosAlbumsEvent:s.resetEvent,fetchMoreVideosAlbumsEvent:s.fetchMoreEvent,fetchVideosAlbumsFx:s.fetchFx,$videosAlbumsFullyLoaded:s.$entitiesFullyLoaded,$videosAlbumsLoading:s.$entitiesLoading,$videosAlbumsIds:s.$entitiesListIds,$videosAlbumsCount:s.$entitiesCount,$videosAlbumsError:s.$entitiesError,selectStores:s.selectStores}}},258967:(e,t,r)=>{r.d(t,{createListsVideosService:()=>l});var i=r(108705),o=r(584646);const n=({id:e,owner_id:t})=>void 0===e||void 0===t?"":(0,i.joinRawId)({itemId:e,ownerId:t}),l=({domain:e,entitiesVideoService:t})=>{const r=e.createEffect(t.videoGetFx),i=(0,o.createFactoryLists)({$entitiesItems:t.$entitiesVideo,domain:e,fetchFx:r,getItemKey:n,getList:({items:e})=>e,getListCount:({count:e})=>e,getListKey:({entityKey:e})=>e,getEntityKey:n});return{resetVideosEvent:i.resetEvent,fetchMoreVideosEvent:i.fetchMoreEvent,fetchVideosFx:i.fetchFx,$videosFullyLoaded:i.$entitiesFullyLoaded,$videosLoading:i.$entitiesLoading,$videosIds:i.$entitiesListIds,$videosCount:i.$entitiesCount,$videosError:i.$entitiesError,selectStores:i.selectStores}}},528676:(e,t,r)=>{r.d(t,{createVideoAlbumSubscriptionEffect:()=>n});var i=r(820224),o=r(798116);const n=(e,t,r)=>{const n=(0,o.createEffect)((t=>{var{optimistic:r}=t,o=(0,i._)(t,["optimistic"]);return e(o)}));return(0,o.sample)({clock:n,filter:({optimistic:e=!1,query:t})=>e&&void 0!==t.album_id,fn:({query:e})=>[{owner_id:e.owner_id,id:Number(e.album_id),is_subscribed:r}],target:t}),(0,o.sample)({clock:n.fail,filter:({params:e})=>Boolean(e.optimistic)&&void 0!==e.query.album_id,fn:({params:e})=>[{owner_id:e.query.owner_id,id:Number(e.query.album_id),is_subscribed:!r}],target:t}),(0,o.sample)({clock:n.done,filter:({params:e})=>!e.optimistic&&void 0!==e.query.album_id,fn:({params:e})=>[{owner_id:e.query.owner_id,id:Number(e.query.album_id),is_subscribed:r}],target:t}),n}},727320:(e,t,r)=>{r.d(t,{registerEntitiesSetSample:()=>l});var i=r(798116),o=r(108705),n=r(584117);const l=(e,t)=>{(0,i.sample)({clock:e,source:t,fn:(e,t)=>{const r=t.filter((e=>void 0!==e.owner_id&&void 0!==e.id));return r.length?(0,n.mapToEntity)(e,r,(e=>(0,o.joinRawId)({ownerId:e.owner_id,itemId:e.id}))):e},target:t})}},255344:(e,t,r)=>{function i(e){var t,r,i,o,n,l,s,a;const c=null==(r=e.lists)||null==(t=r.allowed)?void 0:t.map((e=>`list${e}`)).join(","),d=null==(o=e.lists)||null==(i=o.excluded)?void 0:i.map((e=>`-list${e}`)).join(","),u=null==(l=e.owners)||null==(n=l.allowed)?void 0:n.join(","),v=null==(a=e.owners)||null==(s=a.excluded)?void 0:s.map((e=>-e)).join(",");return[e.category,c,d,u,v].filter(Boolean).join(",")}r.d(t,{stringifyBasePrivacy:()=>i})},386037:(e,t,r)=>{r.d(t,{updateEntitiesBy:()=>o});var i=r(434788);const o=(e,t,r)=>{var o,n;const l=Array.isArray(t)?t:null==(o=t)?void 0:o.split(",");if(!(null==(n=l)?void 0:n.length))return e;if(void 0!==r){const t=Object.fromEntries(new Map(l.map((e=>[e,r]))));return(0,i._)({},e,t)}return l.reduce(((e,t)=>(delete e[t],e)),(0,i._)({},e))}},66957:(e,t,r)=>{r.d(t,{isVideoVideoAlbumFull:()=>i});const i=e=>"object"==typeof e&&null!==e&&"id"in e&&"owner_id"in e&&"title"in e&&"count"in e},281848:(e,t,r)=>{r.d(t,{splitRawId:()=>i});const i=e=>{const[t,r,i]=e.split("_");return{ownerId:Number(t),itemId:Number(r),externalId:void 0!==i?i:null}}},99763:(e,t,r)=>{r.d(t,{once:()=>o});var i=r(798116);function o(e){var t=(0,i.createStore)(!0,{name:"$canTrigger",sid:"hqg5e0"}),r=(0,i.sample)({and:[{clock:e,filter:t}],or:{name:"trigger",sid:"-cvmmt0"}});return t.on(r,(()=>!1)),(0,i.sample)({and:[{clock:r}],or:{sid:"-pw95tp"}})}}}]);try{stManager.done("dist/web/chunks/a1b96923.4c7a9fcb.js")}catch(e){}